{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"themes/landscape/source/fancybox/blank.gif","path":"fancybox/blank.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/style.styl","path":"css/style.styl","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/js/script.js","path":"js/script.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":0,"renderable":1},{"_id":"themes/landscape/source/css/images/banner.jpg","path":"css/images/banner.jpg","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":0,"renderable":1},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/hello-world.md","hash":"acad91ace80b80295b11a9b7ad4c29a2dcfdd8fb","modified":1672153225439},{"_id":"source/_posts/test.md","hash":"751f52599535d5be21c8c7dbcdc72eaca92cbc34","modified":1672161877195},{"_id":"themes/landscape/.npmignore","hash":"58d26d4b5f2f94c2d02a4e4a448088e4a2527c77","modified":1672133639529},{"_id":"themes/landscape/LICENSE","hash":"c480fce396b23997ee23cc535518ffaaf7f458f8","modified":1672133639557},{"_id":"themes/landscape/Gruntfile.js","hash":"71adaeaac1f3cc56e36c49d549b8d8a72235c9b9","modified":1672133639704},{"_id":"themes/landscape/README.md","hash":"37fae88639ef60d63bd0de22314d7cc4c5d94b07","modified":1672133639735},{"_id":"themes/landscape/_config.yml","hash":"79ac6b9ed6a4de5a21ea53fc3f5a3de92e2475ff","modified":1672133639793},{"_id":"themes/landscape/package.json","hash":"544f21a0b2c7034998b36ae94dba6e3e0f39f228","modified":1672133639727},{"_id":"themes/landscape/layout/archive.ejs","hash":"2703b07cc8ac64ae46d1d263f4653013c7e1666b","modified":1672133639586},{"_id":"themes/landscape/layout/category.ejs","hash":"765426a9c8236828dc34759e604cc2c52292835a","modified":1672133639593},{"_id":"themes/landscape/layout/layout.ejs","hash":"f155824ca6130080bb057fa3e868a743c69c4cf5","modified":1672133639621},{"_id":"themes/landscape/layout/page.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1672133639633},{"_id":"themes/landscape/layout/index.ejs","hash":"aa1b4456907bdb43e629be3931547e2d29ac58c8","modified":1672133639620},{"_id":"themes/landscape/languages/de.yml","hash":"3ebf0775abbee928c8d7bda943c191d166ded0d3","modified":1672133639794},{"_id":"themes/landscape/scripts/fancybox.js","hash":"aa411cd072399df1ddc8e2181a3204678a5177d9","modified":1672133639701},{"_id":"themes/landscape/languages/es.yml","hash":"76edb1171b86532ef12cfd15f5f2c1ac3949f061","modified":1672133639798},{"_id":"themes/landscape/languages/default.yml","hash":"3083f319b352d21d80fc5e20113ddf27889c9d11","modified":1672133639795},{"_id":"themes/landscape/languages/fr.yml","hash":"415e1c580ced8e4ce20b3b0aeedc3610341c76fb","modified":1672133639799},{"_id":"themes/landscape/languages/no.yml","hash":"965a171e70347215ec726952e63f5b47930931ef","modified":1672133639803},{"_id":"themes/landscape/layout/tag.ejs","hash":"eaa7b4ccb2ca7befb90142e4e68995fb1ea68b2e","modified":1672133639659},{"_id":"themes/landscape/layout/post.ejs","hash":"7d80e4e36b14d30a7cd2ac1f61376d9ebf264e8b","modified":1672133639638},{"_id":"themes/landscape/languages/ja.yml","hash":"a73e1b9c80fd6e930e2628b393bfe3fb716a21a9","modified":1672133639799},{"_id":"themes/landscape/languages/ko.yml","hash":"881d6a0a101706e0452af81c580218e0bfddd9cf","modified":1672133639801},{"_id":"themes/landscape/languages/nl.yml","hash":"12ed59faba1fc4e8cdd1d42ab55ef518dde8039c","modified":1672133639802},{"_id":"themes/landscape/languages/pt.yml","hash":"57d07b75d434fbfc33b0ddb543021cb5f53318a8","modified":1672133639804},{"_id":"themes/landscape/languages/ru.yml","hash":"4fda301bbd8b39f2c714e2c934eccc4b27c0a2b0","modified":1672133639805},{"_id":"themes/landscape/languages/zh-CN.yml","hash":"ca40697097ab0b3672a80b455d3f4081292d1eed","modified":1672133639806},{"_id":"themes/landscape/languages/zh-TW.yml","hash":"53ce3000c5f767759c7d2c4efcaa9049788599c3","modified":1672133639809},{"_id":"themes/landscape/layout/_partial/archive.ejs","hash":"950ddd91db8718153b329b96dc14439ab8463ba5","modified":1672133639580},{"_id":"themes/landscape/layout/_partial/archive-post.ejs","hash":"c7a71425a946d05414c069ec91811b5c09a92c47","modified":1672133639579},{"_id":"themes/landscape/layout/_partial/after-footer.ejs","hash":"d0d753d39038284d52b10e5075979cc97db9cd20","modified":1672133639577},{"_id":"themes/landscape/layout/_partial/article.ejs","hash":"c4c835615d96a950d51fa2c3b5d64d0596534fed","modified":1672133639588},{"_id":"themes/landscape/layout/_partial/gauges-analytics.ejs","hash":"aad6312ac197d6c5aaf2104ac863d7eba46b772a","modified":1672133639608},{"_id":"themes/landscape/layout/_partial/google-analytics.ejs","hash":"f921e7f9223d7c95165e0f835f353b2938e40c45","modified":1672133639610},{"_id":"themes/landscape/layout/_partial/footer.ejs","hash":"93518893cf91287e797ebac543c560e2a63b8d0e","modified":1672133639604},{"_id":"themes/landscape/layout/_partial/header.ejs","hash":"7e749050be126eadbc42decfbea75124ae430413","modified":1672133639618},{"_id":"themes/landscape/layout/_widget/category.ejs","hash":"dd1e5af3c6af3f5d6c85dfd5ca1766faed6a0b05","modified":1672133639591},{"_id":"themes/landscape/layout/_partial/mobile-nav.ejs","hash":"e952a532dfc583930a666b9d4479c32d4a84b44e","modified":1672133639623},{"_id":"themes/landscape/layout/_partial/head.ejs","hash":"5abf77aec957d9445fc71a8310252f0013c84578","modified":1672133639616},{"_id":"themes/landscape/layout/_partial/sidebar.ejs","hash":"930da35cc2d447a92e5ee8f835735e6fd2232469","modified":1672133639643},{"_id":"themes/landscape/layout/_widget/archive.ejs","hash":"beb4a86fcc82a9bdda9289b59db5a1988918bec3","modified":1672133639584},{"_id":"themes/landscape/layout/_widget/tagcloud.ejs","hash":"b4a2079101643f63993dcdb32925c9b071763b46","modified":1672133639660},{"_id":"themes/landscape/layout/_widget/tag.ejs","hash":"2de380865df9ab5f577f7d3bcadf44261eb5faae","modified":1672133639655},{"_id":"themes/landscape/layout/_widget/recent_posts.ejs","hash":"0d4f064733f8b9e45c0ce131fe4a689d570c883a","modified":1672133639641},{"_id":"themes/landscape/source/css/_extend.styl","hash":"222fbe6d222531d61c1ef0f868c90f747b1c2ced","modified":1672133639750},{"_id":"themes/landscape/source/css/_variables.styl","hash":"628e307579ea46b5928424313993f17b8d729e92","modified":1672133639752},{"_id":"themes/landscape/source/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1672133639668},{"_id":"themes/landscape/source/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1672133639670},{"_id":"themes/landscape/source/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1672133639745},{"_id":"themes/landscape/source/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1672133639744},{"_id":"themes/landscape/source/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1672133639748},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1672133639574},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1672133639718},{"_id":"themes/landscape/source/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1672133639721},{"_id":"themes/landscape/source/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1672133639723},{"_id":"themes/landscape/layout/_partial/post/gallery.ejs","hash":"3d9d81a3c693ff2378ef06ddb6810254e509de5b","modified":1672133639606},{"_id":"themes/landscape/source/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1672133639672},{"_id":"themes/landscape/source/css/style.styl","hash":"a70d9c44dac348d742702f6ba87e5bb3084d65db","modified":1672133639775},{"_id":"themes/landscape/layout/_partial/post/date.ejs","hash":"6197802873157656e3077c5099a7dda3d3b01c29","modified":1672133639599},{"_id":"themes/landscape/layout/_partial/post/nav.ejs","hash":"16a904de7bceccbb36b4267565f2215704db2880","modified":1672133639624},{"_id":"themes/landscape/layout/_partial/post/category.ejs","hash":"c6bcd0e04271ffca81da25bcff5adf3d46f02fc0","modified":1672133639590},{"_id":"themes/landscape/layout/_partial/post/title.ejs","hash":"2f275739b6f1193c123646a5a31f37d48644c667","modified":1672133639662},{"_id":"themes/landscape/layout/_partial/post/tag.ejs","hash":"2fcb0bf9c8847a644167a27824c9bb19ac74dd14","modified":1672133639649},{"_id":"themes/landscape/source/css/_partial/archive.styl","hash":"db15f5677dc68f1730e82190bab69c24611ca292","modified":1672133639758},{"_id":"themes/landscape/source/css/_partial/article.styl","hash":"10685f8787a79f79c9a26c2f943253450c498e3e","modified":1672133639759},{"_id":"themes/landscape/source/css/_partial/footer.styl","hash":"e35a060b8512031048919709a8e7b1ec0e40bc1b","modified":1672133639761},{"_id":"themes/landscape/source/css/_partial/mobile.styl","hash":"a399cf9e1e1cec3e4269066e2948d7ae5854d745","modified":1672133639771},{"_id":"themes/landscape/source/css/_partial/comment.styl","hash":"79d280d8d203abb3bd933ca9b8e38c78ec684987","modified":1672133639760},{"_id":"themes/landscape/source/css/_partial/header.styl","hash":"85ab11e082f4dd86dde72bed653d57ec5381f30c","modified":1672133639764},{"_id":"themes/landscape/source/css/_partial/highlight.styl","hash":"bf4e7be1968dad495b04e83c95eac14c4d0ad7c0","modified":1672133639765},{"_id":"themes/landscape/source/css/_util/grid.styl","hash":"0bf55ee5d09f193e249083602ac5fcdb1e571aed","modified":1672133639763},{"_id":"themes/landscape/source/css/_partial/sidebar-aside.styl","hash":"890349df5145abf46ce7712010c89237900b3713","modified":1672133639772},{"_id":"themes/landscape/source/css/_util/mixin.styl","hash":"44f32767d9fd3c1c08a60d91f181ee53c8f0dbb3","modified":1672133639767},{"_id":"themes/landscape/source/css/_partial/sidebar-bottom.styl","hash":"8fd4f30d319542babfd31f087ddbac550f000a8a","modified":1672133639773},{"_id":"themes/landscape/source/css/_partial/sidebar.styl","hash":"404ec059dc674a48b9ab89cd83f258dec4dcb24d","modified":1672133639773},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1672133639667},{"_id":"themes/landscape/source/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1672133639742},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1672133639790},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1672133639569},{"_id":"themes/landscape/source/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1672133639743},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1672133639712},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1672133639571},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1672133639714},{"_id":"themes/landscape/source/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1672133639715},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1672133639788},{"_id":"themes/landscape/source/css/fonts/fontawesome-webfont.svg","hash":"46fcc0194d75a0ddac0a038aee41b23456784814","modified":1672133639784},{"_id":"themes/landscape/source/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1672133639688},{"_id":"public/2022/12/27/test/index.html","hash":"61fff53d493d846178f139d148345c30fc822947","modified":1672133935851},{"_id":"public/2022/12/27/hello-world/index.html","hash":"871845466ed8aab41750d6676a6c8ce2a54e0b75","modified":1672133935851},{"_id":"public/index.html","hash":"cf37d49e0fa60209c75acde6660a6f99887c2d86","modified":1672133935851},{"_id":"public/archives/index.html","hash":"b853d81d119b476a6b9810ccc5a0c54287ddbef2","modified":1672133935851},{"_id":"public/archives/2022/index.html","hash":"449911d6b5a101c4a2b35cfa9324ff74068d359a","modified":1672133935851},{"_id":"public/archives/2022/12/index.html","hash":"cc4622a86fac7db770a8f676afa413db0b09d0ec","modified":1672133935851},{"_id":"public/fancybox/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1672133935851},{"_id":"public/fancybox/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1672133935851},{"_id":"public/fancybox/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1672133935851},{"_id":"public/fancybox/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1672133935851},{"_id":"public/fancybox/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1672133935851},{"_id":"public/css/fonts/fontawesome-webfont.eot","hash":"7619748fe34c64fb157a57f6d4ef3678f63a8f5e","modified":1672133935851},{"_id":"public/css/fonts/FontAwesome.otf","hash":"b5b4f9be85f91f10799e87a083da1d050f842734","modified":1672133935851},{"_id":"public/fancybox/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1672133935851},{"_id":"public/css/fonts/fontawesome-webfont.woff","hash":"04c3bf56d87a0828935bd6b4aee859995f321693","modified":1672133935851},{"_id":"public/fancybox/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1672133935851},{"_id":"public/css/fonts/fontawesome-webfont.ttf","hash":"7f09c97f333917034ad08fa7295e916c9f72fd3f","modified":1672133935851},{"_id":"public/fancybox/jquery.fancybox.css","hash":"aaa582fb9eb4b7092dc69fcb2d5b1c20cca58ab6","modified":1672133935851},{"_id":"public/js/script.js","hash":"2876e0b19ce557fca38d7c6f49ca55922ab666a1","modified":1672133935851},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1672133935851},{"_id":"public/fancybox/helpers/jquery.fancybox-buttons.js","hash":"dc3645529a4bf72983a39fa34c1eb9146e082019","modified":1672133935851},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1672133935851},{"_id":"public/fancybox/helpers/jquery.fancybox-media.js","hash":"294420f9ff20f4e3584d212b0c262a00a96ecdb3","modified":1672133935851},{"_id":"public/fancybox/helpers/jquery.fancybox-thumbs.js","hash":"47da1ae5401c24b5c17cc18e2730780f5c1a7a0c","modified":1672133935851},{"_id":"public/css/style.css","hash":"3986ef4b1f56bf0ac3bc45aab261e0278794c3f1","modified":1672133935851},{"_id":"public/fancybox/jquery.fancybox.js","hash":"d08b03a42d5c4ba456ef8ba33116fdbb7a9cabed","modified":1672133935851},{"_id":"public/fancybox/jquery.fancybox.pack.js","hash":"9e0d51ca1dbe66f6c0c7aefd552dc8122e694a6e","modified":1672133935851},{"_id":"public/css/images/banner.jpg","hash":"f44aa591089fcb3ec79770a1e102fd3289a7c6a6","modified":1672133935851},{"_id":"public/css/fonts/fontawesome-webfont.svg","hash":"46fcc0194d75a0ddac0a038aee41b23456784814","modified":1672133935851},{"_id":"source/css/first.styl","hash":"7908ad339a5ee2c92bdd691620909e6fafe43d81","modified":1672154109549},{"_id":"source/js/app.js","hash":"dd70aaabfe1fc7d126ae8c6b00e7506e4dd569ce","modified":1672154109550},{"_id":"source/css/Readme.md","hash":"8046a2fb69589fb01b19eec6ba903b93dacc5852","modified":1672154109511},{"_id":"source/css/style.styl","hash":"1c7f0dcf5e01c26de6ebcb91c3e1a14b457135c2","modified":1672154109549},{"_id":"source/_posts/new.md","hash":"af9201ac44d8767c8483fd62969d9cf7683ccf22","modified":1672165390584},{"_id":"source/css/_defines/AutoPrefixCSS.styl","hash":"18fe976fb9241ef379ebcccc0b7a9cc599f65c51","modified":1672154109512},{"_id":"source/css/_defines/color.styl","hash":"a5b9ef5385f3931eafb42a58715498b230103cc3","modified":1672154109513},{"_id":"source/css/_defines/Readme.md","hash":"75c2fa01e58095a98d463e6b9bab1f0c04e38692","modified":1672154109512},{"_id":"source/css/_defines/effect.styl","hash":"96b8e1b97146946469dd965e7d04cf90b22eb497","modified":1672154109513},{"_id":"source/js/plugins/aplayer.js","hash":"caa3621d74f24a00357e4d4ce3c90436c799d4e0","modified":1672154109551},{"_id":"source/css/_defines/fonts.styl","hash":"9601ac0c9ecfb65288fa64eae67b2a6b6e56d8dd","modified":1672154109514},{"_id":"source/css/_defines/layout.styl","hash":"192d0a3b07f95e01a3952c5c88967068e0682cca","modified":1672154109515},{"_id":"source/css/_defines/func.styl","hash":"d5b08a9b533c8cde12e34f9f6df1bd4a994c46d2","modified":1672154109514},{"_id":"source/js/plugins/parallax.js","hash":"ac6b9b60ff4a739649882723f653896a73a89ec5","modified":1672154109551},{"_id":"source/js/plugins/rightMenus.js","hash":"45f1d78b180b5ef7355afc748bb65406bc16faef","modified":1672154109552},{"_id":"source/css/_style/index.styl","hash":"b02f576a0e909e01180e3996c3965e06a681f21b","modified":1672154109548},{"_id":"source/css/_first/base_first.styl","hash":"9fb2a5aa7412d420e441f204b6dbd50a016584cf","modified":1672154109515},{"_id":"source/css/_first/cover_first.styl","hash":"881210244593d7125337d4f810d49b9699420b43","modified":1672154109516},{"_id":"source/css/_first/dark_first.styl","hash":"f7ee92842e4fa71c5b709a1cb75af3dcc06d381b","modified":1672154109517},{"_id":"source/css/_first/navbar_first.styl","hash":"cb85492e8ae8878fc99e52b14610a9122336a2be","modified":1672154109517},{"_id":"source/css/_first/fontfamily_first.styl","hash":"cce88d81a8e21cce65b7fd586765e8819388d31d","modified":1672154109517},{"_id":"source/js/search/algolia.js","hash":"97591a9f07c6d235cb8df01bbd699bfec67c321e","modified":1672154109554},{"_id":"source/css/_first/search_first.styl","hash":"4eedde6a3806741a450de0aeffa5a100d9c2d408","modified":1672154109518},{"_id":"source/js/search/meilisearch.js","hash":"833816876a74646bfdd395c05985c8b64c0856a2","modified":1672154109555},{"_id":"source/js/search/hexo.js","hash":"7b31017cd1582001526e94a8169c0eb8ca813d8a","modified":1672154109555},{"_id":"source/css/_style/_base/base.styl","hash":"af90d8a3cee62ef41bb141602472362c6ac1ae07","modified":1672154109519},{"_id":"source/css/_style/_base/fontfamily_async.styl","hash":"7b6f2da48a225b3d836d7b2e5dfa90fa18dc3174","modified":1672154109519},{"_id":"source/css/_style/_layout/archive.styl","hash":"93a0846f1d65d66950403aba90ed5a8b5c8a9884","modified":1672154109520},{"_id":"source/css/_style/_layout/article.styl","hash":"1cbdb1cf338e1a8fc4b79a9b73ca0e349bbee55d","modified":1672154109521},{"_id":"source/css/_style/_layout/friends-simpleuser.styl","hash":"3d8e963fd1c24668fc1df078c619c4126f6a8a93","modified":1672154109522},{"_id":"source/css/_style/_layout/footer.styl","hash":"5146a149d97dfaa88ae4bf819b60bab2f8d92a53","modified":1672154109521},{"_id":"source/css/_style/_layout/friends-traditional.styl","hash":"c5a3d30071b3208bd6af2b11df94e729b0537ea2","modified":1672154109522},{"_id":"source/css/_style/_layout/img.styl","hash":"7f733971a7862fc5764a953ae4f8e17c171ff1b6","modified":1672154109523},{"_id":"source/css/_style/_layout/loading.styl","hash":"c6757684fa37ced88e181b91c873644d1bde591d","modified":1672154109523},{"_id":"source/css/_style/_layout/main.styl","hash":"a004709832cdfcbe2e8069f9872db8d38e1b79a8","modified":1672154109524},{"_id":"source/css/_style/_layout/md.styl","hash":"3e43f6ddcbf010feaa1a686b212f0d7e42f51e78","modified":1672154109524},{"_id":"source/css/_style/_layout/pagination.styl","hash":"d727004c3bbe16ace26bfcd45dd7b2f1202acec4","modified":1672154109524},{"_id":"source/css/_style/_layout/posts.styl","hash":"df0c63cce7e7e2e7415d6efd0710cac37573389d","modified":1672154109525},{"_id":"source/css/_style/_layout/search.styl","hash":"8c9ac10425e46036187c3944a5c363c42ac3db18","modified":1672154109525},{"_id":"source/css/_style/_layout/sidebar.styl","hash":"810feced0a40373d012f47a04d62ef85cb5cdb63","modified":1672154109526},{"_id":"source/css/_style/_layout/snackbar.styl","hash":"c3137362a2615159565477cab19afb1fc2d22cbf","modified":1672154109526},{"_id":"source/css/_style/_layout/toc.styl","hash":"c22db26a72dff5d7c73171f22a66231550d93e09","modified":1672154109527},{"_id":"source/css/_style/_layout/video.styl","hash":"94bdeb9f28ba503a7a3fbd1148bc349983c17818","modified":1672154109527},{"_id":"source/css/_style/_plugins/aplayer.styl","hash":"5babeff5defa56e7d8db229ae4605f19bef9cd61","modified":1672154109535},{"_id":"source/css/_style/_plugins/cursor.styl","hash":"ba39aaa74ff3c20a6d13c2856a0ccbd0c111f8e5","modified":1672154109535},{"_id":"source/css/_style/_plugins/fontcolor.styl","hash":"de8c4f209c118c4b391223d46c2d662332cadaa1","modified":1672154109536},{"_id":"source/css/_style/_plugins/gitalk.styl","hash":"17938fd65f7996c71e382934553af9fdee6a0e18","modified":1672154109536},{"_id":"source/js/plugins/tags/contributors.js","hash":"4444e7432c578b6be13748bbfa28516e6028ed77","modified":1672154109552},{"_id":"source/css/_style/_plugins/mathjax.styl","hash":"95b0c51b678bc3ecc607bcf52d97b9634931ccba","modified":1672154109537},{"_id":"source/css/_style/_plugins/index.styl","hash":"580b6d532b39c984fab96d1f095696ae08f27611","modified":1672154109537},{"_id":"source/css/_style/_plugins/message.styl","hash":"32eaf66de2f82e4c364b9244c5eef6380ec00bb4","modified":1672154109538},{"_id":"source/css/_style/_tag-plugins/Readme.md","hash":"4840c72bf8ff1cdf2e16c8bc10a2410246946090","modified":1672154109538},{"_id":"source/js/plugins/tags/friends.js","hash":"f28cf713502147843a04cd210e0201f46c352e11","modified":1672154109553},{"_id":"source/js/plugins/tags/sites.js","hash":"e2848f5e15f46149743f59adf21ddf875f367e47","modified":1672154109553},{"_id":"source/css/_style/_tag-plugins/btns.styl","hash":"525919d04929c2c849f3aae587ecc6a004b05e86","modified":1672154109539},{"_id":"source/css/_style/_tag-plugins/checkbox.styl","hash":"ae7ae8a3377525396a9163d32ca76c11647d877d","modified":1672154109539},{"_id":"source/css/_style/_tag-plugins/dropmenu.styl","hash":"469d3458db6531b1283768bbae30f283110d1726","modified":1672154109540},{"_id":"source/css/_style/_tag-plugins/folding.styl","hash":"40fe5c009ad79325b1ad8c88b6d146682035348c","modified":1672154109541},{"_id":"source/css/_style/_tag-plugins/frame.styl","hash":"0f6230d77f22f0969d15d092b3d973c08d2219cc","modified":1672154109541},{"_id":"source/css/_style/_tag-plugins/fancybox.styl","hash":"671f43ec7ee5b98227ce60e4b564eee5281f92ea","modified":1672154109540},{"_id":"source/css/_style/_tag-plugins/friends.styl","hash":"b76cf16571ac2099a39fe35a238e4d735b4115e1","modified":1672154109542},{"_id":"source/css/_style/_tag-plugins/ghcard.styl","hash":"3a6fd480b244c76ac670b418e461c0f77bd9f4d4","modified":1672154109542},{"_id":"source/css/_style/_tag-plugins/media.styl","hash":"03c9942ed8560b923ac3535e7e80396d4a92df04","modified":1672154109544},{"_id":"source/css/_style/_tag-plugins/note.styl","hash":"959a9fe09cf9d0c29de76d05d6123c337a259ab5","modified":1672154109544},{"_id":"source/css/_style/_tag-plugins/image.styl","hash":"842f58a4c464d5ec59038cc923dbce1dd432362b","modified":1672154109543},{"_id":"source/css/_style/_tag-plugins/link.styl","hash":"870a0d50082116adffe385d7695e28795542aa23","modified":1672154109543},{"_id":"source/css/_style/_tag-plugins/sites.styl","hash":"f20f37b20ca803db2981e8931d70f0dd78bca30e","modified":1672154109544},{"_id":"source/css/_style/_tag-plugins/swiper.styl","hash":"819385594f1825e26074ade900835a3f4031fe42","modified":1672154109545},{"_id":"source/css/_style/_tag-plugins/table.styl","hash":"84abe90bc0b505d35d8e702337fcbe5da6ee1217","modified":1672154109546},{"_id":"source/css/_style/_tag-plugins/tabs.styl","hash":"5cb4366b6ed139c952b846357e9d077b5c1b9c66","modified":1672154109546},{"_id":"source/css/_style/_tag-plugins/span.styl","hash":"cdda513cbc9d95e9311a0a52c06ae7d1d250a769","modified":1672154109545},{"_id":"source/css/_style/_tag-plugins/tag.json","hash":"a453d6ed0ed5de78364a8356703d250bb9cf43d6","modified":1672154109547},{"_id":"source/css/_style/_plugins/_rightmenu/reading.styl","hash":"18cefb0667407e9dd15fde96c5577fc7ba0ecaf3","modified":1672154109534},{"_id":"source/css/_style/_tag-plugins/timeline.styl","hash":"14b86f0ad0098e679d66dae7d997802c77a27141","modified":1672154109548},{"_id":"source/css/_style/_tag-plugins/text.styl","hash":"7231d9c0e1e05a3ab7094d6ff4d1c37d97a1e8af","modified":1672154109547},{"_id":"source/css/_style/_plugins/_rightmenu/rightmenu.styl","hash":"3c55aa5549e505d87652e418dae345259add247b","modified":1672154109534},{"_id":"source/css/_style/_plugins/_dark/dark_async.styl","hash":"643453859ba9509ee1bf2487035f08e4dbfb2b48","modified":1672154109528},{"_id":"source/css/_style/_plugins/_highlight/index.styl","hash":"c62f0c706c08ec7a830f7ede2d04996ccc721e90","modified":1672154109531},{"_id":"source/css/_style/_plugins/_dark/dark_plugins.styl","hash":"ab7ec1655032c2ba25d0ee61856ebedd7b393f38","modified":1672154109529},{"_id":"source/css/_style/_plugins/_highlight/highlightjs/language.styl","hash":"aa98bc49ba55119529c47175eaa3e87f44eae26c","modified":1672154109531},{"_id":"source/css/_style/_plugins/_highlight/highlightjs/color.styl","hash":"7ba7e4aeacc31b12c5fc57317d902b3742aa6c38","modified":1672154109530},{"_id":"source/css/_style/_plugins/_highlight/prismjs/clipboard.styl","hash":"6dcea4963642a693869411ad40df703a716790d6","modified":1672154109532},{"_id":"source/css/_style/_plugins/_highlight/highlightjs/clipboard.styl","hash":"f2b95f90b15ad610b6f2668316233bb2e4a65cf0","modified":1672154109530},{"_id":"source/css/_style/_plugins/_highlight/highlightjs/index.styl","hash":"661f36ee05c75465a046fcdca091f406c96cb37d","modified":1672154109531},{"_id":"source/css/_style/_plugins/_highlight/prismjs/language.styl","hash":"7773ed6757f1cc1f4ce4d8c991d721a5d49a8a92","modified":1672154109533},{"_id":"source/css/_style/_plugins/_highlight/prismjs/index.styl","hash":"273196519db0ac4e223458e002e2ad0536213ba5","modified":1672154109533}],"Category":[],"Data":[],"Page":[{"_content":"#safearea {\n  display: none\n}\n\nif hexo-config('content_visibility')\n  // https://web.dev/content-visibility/\n  // https://www.caniuse.com/?search=content-visibility\n  /*\n    * Workaround for Chrome bug, part 1\n    * Chunk rendering for all but the first article.\n    * /layout/_partial/scripts/content-visibility-scroll-fix.ejs\n  */\n  .post-story + .post-story{\n    content-visibility: auto;\n    contain-intrinsic-size: 10px 500px;\n  }\n\n@import '_defines/*'\n\n// Project\n@import '_first/*'\n\n// Custom Files\nfor $injects_first in hexo-config('injects.first')\n  @import $injects_first;","source":"css/first.styl","raw":"#safearea {\n  display: none\n}\n\nif hexo-config('content_visibility')\n  // https://web.dev/content-visibility/\n  // https://www.caniuse.com/?search=content-visibility\n  /*\n    * Workaround for Chrome bug, part 1\n    * Chunk rendering for all but the first article.\n    * /layout/_partial/scripts/content-visibility-scroll-fix.ejs\n  */\n  .post-story + .post-story{\n    content-visibility: auto;\n    contain-intrinsic-size: 10px 500px;\n  }\n\n@import '_defines/*'\n\n// Project\n@import '_first/*'\n\n// Custom Files\nfor $injects_first in hexo-config('injects.first')\n  @import $injects_first;","date":"2022-12-27T15:15:09.549Z","updated":"2022-12-27T15:15:09.549Z","path":"css/first.css","layout":"false","title":"","comments":1,"_id":"clc6k3sf000006cu97ckugzts"},{"_content":"# 样式文件说明\n\n## 样式拆分说明\n\n方案是对 https://blog.skk.moe/post/improve-fcp-for-my-blog/ 的开源实现\n\n### first.styl\n\n首屏样式, 内含 首屏基础样式、 cover、 navbar、 首屏search、首屏暗黑模式、首屏字体 等样式, 首屏样式采用硬编码的方式写在HTML中.\n\n内联硬编码自动化方案 see：scripts/helpers/first-style/index.js\n\n### style.styl\n\n异步加载样式, 除首屏样式外的其他样式, 最终生成 /css/style.css 异步加载.\n\n## 暗黑模式样式说明\n\n暗黑模式样式被拆分为首屏暗黑模式样式和异步暗黑模式样式，其中在 source/css/ 文件夹下：\n\n_first/dark_first.styl ： 包含 首屏暗黑模式样式 的 暗黑模式 CSS 变量 和 强制覆盖样式\n\n_style/_plugins/_dark ： 异步暗黑模式样式文件夹\n\n_style/_plugins/_dark/dark_async.styl ： 包含 异步暗黑模式样式 的 暗黑模式 CSS 变量\n\n_style/_plugins/_dark/dark_plugins.styl ： 包含 异步暗黑模式样式 的 强制覆盖样式\n\n","source":"css/Readme.md","raw":"# 样式文件说明\n\n## 样式拆分说明\n\n方案是对 https://blog.skk.moe/post/improve-fcp-for-my-blog/ 的开源实现\n\n### first.styl\n\n首屏样式, 内含 首屏基础样式、 cover、 navbar、 首屏search、首屏暗黑模式、首屏字体 等样式, 首屏样式采用硬编码的方式写在HTML中.\n\n内联硬编码自动化方案 see：scripts/helpers/first-style/index.js\n\n### style.styl\n\n异步加载样式, 除首屏样式外的其他样式, 最终生成 /css/style.css 异步加载.\n\n## 暗黑模式样式说明\n\n暗黑模式样式被拆分为首屏暗黑模式样式和异步暗黑模式样式，其中在 source/css/ 文件夹下：\n\n_first/dark_first.styl ： 包含 首屏暗黑模式样式 的 暗黑模式 CSS 变量 和 强制覆盖样式\n\n_style/_plugins/_dark ： 异步暗黑模式样式文件夹\n\n_style/_plugins/_dark/dark_async.styl ： 包含 异步暗黑模式样式 的 暗黑模式 CSS 变量\n\n_style/_plugins/_dark/dark_plugins.styl ： 包含 异步暗黑模式样式 的 强制覆盖样式\n\n","date":"2022-12-27T17:00:08.464Z","updated":"2022-12-27T15:15:09.511Z","path":"css/Readme.html","title":"","comments":1,"layout":"page","_id":"clc6k3sf200016cu94gcf0lsn"},{"_content":"/**\n * 右键音乐\n * */\nconst RightMenuAplayer = (() => {\n  let playStatus; // 播放器状态\n  const APlayer = {}; // 右键音乐所控制的播放器\n  const fn = {};\n\n  fn.checkAPlayer = () => {\n    if (playStatus === undefined || APlayer.player === undefined) {\n      fn.setAPlayerObject();\n    } else if (APlayer.observer === undefined) {\n      fn.setAPlayerObserver();\n    }\n  }\n\n  // 设置全局播放器所对应的 aplyer 对象\n  fn.setAPlayerObject = () => {\n    let meting = document.querySelectorAll('.footer meting-js');\n    if (meting.length == 0) {\n      meting = document.querySelectorAll('meting-js');\n    }\n    APlayer.player = undefined;\n    meting.forEach((item, index) => {\n      if (item.meta.id == volantis.GLOBAL_CONFIG.plugins.aplayer.id && item.aplayer && APlayer.player === undefined) {\n        APlayer.player = item.aplayer;\n        fn.setAPlayerObserver();\n        fn.updateTitle();\n      }\n    });\n  }\n\n  // 事件监听\n  fn.setAPlayerObserver = () => {\n    try {\n      APlayer.player.on('play', function (e) {\n        fn.updateAPlayerControllerStatus(e);\n        APlayer.status = 'play';\n      });\n      APlayer.player.on('pause', function (e) {\n        fn.updateAPlayerControllerStatus(e);\n        APlayer.status = 'pause';\n      });\n      APlayer.player.on('volumechange', function (e) {\n        fn.onUpdateAPlayerVolume(e);\n      });\n      APlayer.player.on('loadstart', function (e) {\n        fn.updateTitle(e);\n      });\n\n      // 监听音量手势\n      APlayer.volumeBarWrap = document.getElementsByClassName('nav volume')[0].children[0];\n      APlayer.volumeBar = APlayer.volumeBarWrap.children[0];\n\n      const thumbMove = (e) => {\n        fn.updateAPlayerVolume(e);\n      };\n\n      const thumbUp = (e) => {\n        APlayer.volumeBarWrap.classList.remove('aplayer-volume-bar-wrap-active');\n        document.removeEventListener('mouseup', thumbUp);\n        document.removeEventListener('mousemove', thumbMove);\n        fn.updateAPlayerVolume(e);\n      };\n\n      APlayer.volumeBarWrap.addEventListener('mousedown', (event) => {\n        event.stopPropagation();\n        APlayer.volumeBarWrap.classList.add('aplayer-volume-bar-wrap-active');\n        document.addEventListener('mousemove', thumbMove);\n        document.addEventListener('mouseup', thumbUp);\n      });\n\n      APlayer.volumeBarWrap.addEventListener('click', (event) => {\n        event.stopPropagation();\n      });\n\n      fn.updateAPlayerControllerStatus();\n      fn.onUpdateAPlayerVolume();\n      APlayer.observer = true;\n    } catch (error) {\n      console.log(error);\n      APlayer.observer = undefined;\n    }\n  }\n\n  fn.updateAPlayerVolume = (e) => {\n    let percentage = ((e.clientX || e.changedTouches[0].clientX) -\n      APlayer.volumeBar.getBoundingClientRect().left) / APlayer.volumeBar.clientWidth;\n    percentage = Math.max(percentage, 0);\n    percentage = Math.min(percentage, 1);\n    APlayer.player.volume(percentage);\n  }\n\n  fn.onUpdateAPlayerVolume = () => {\n    try {\n      APlayer.volumeBar.children[0].style.width = APlayer.player.audio.volume * 100 + '%';\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 更新控制器状态\n  fn.updateAPlayerControllerStatus = () => {\n    try {\n      if (APlayer.player.audio.paused) {\n        playStatus = 'pause';\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.add('fa-play');\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.remove('fa-pause');\n      } else {\n        playStatus = 'play';\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.remove('fa-play');\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.add('fa-pause');\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 播放/暂停\n  fn.aplayerToggle = () => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.toggle();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 上一曲\n  fn.aplayerBackward = () => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.skipBack();\n      APlayer.player.play();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 下一曲\n  fn.aplayerForward = () => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.skipForward();\n      APlayer.player.play();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 调节音量\n  fn.aplayerVolume = (percent) => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.volume(percent);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 更新音乐标题\n  fn.updateTitle = () => {\n    fn.checkAPlayer();\n    try {\n      const index = APlayer.player.list.index;\n      const obj = APlayer.player.list.audios[index];\n      document.getElementsByClassName('nav music-title')[0].innerHTML = obj.title;\n    } catch (error) {\n      //console.log(error);\n    }\n  }\n\n  return {\n    checkAPlayer: fn.checkAPlayer,\n    aplayerBackward: fn.aplayerBackward,\n    aplayerToggle: fn.aplayerToggle,\n    aplayerForward: fn.aplayerForward,\n    APlayer: APlayer\n  }\n})()\n\nObject.freeze(RightMenuAplayer);\n\nvolantis.requestAnimationFrame(() => {\n  RightMenuAplayer.checkAPlayer();\n});\n","source":"js/plugins/aplayer.js","raw":"/**\n * 右键音乐\n * */\nconst RightMenuAplayer = (() => {\n  let playStatus; // 播放器状态\n  const APlayer = {}; // 右键音乐所控制的播放器\n  const fn = {};\n\n  fn.checkAPlayer = () => {\n    if (playStatus === undefined || APlayer.player === undefined) {\n      fn.setAPlayerObject();\n    } else if (APlayer.observer === undefined) {\n      fn.setAPlayerObserver();\n    }\n  }\n\n  // 设置全局播放器所对应的 aplyer 对象\n  fn.setAPlayerObject = () => {\n    let meting = document.querySelectorAll('.footer meting-js');\n    if (meting.length == 0) {\n      meting = document.querySelectorAll('meting-js');\n    }\n    APlayer.player = undefined;\n    meting.forEach((item, index) => {\n      if (item.meta.id == volantis.GLOBAL_CONFIG.plugins.aplayer.id && item.aplayer && APlayer.player === undefined) {\n        APlayer.player = item.aplayer;\n        fn.setAPlayerObserver();\n        fn.updateTitle();\n      }\n    });\n  }\n\n  // 事件监听\n  fn.setAPlayerObserver = () => {\n    try {\n      APlayer.player.on('play', function (e) {\n        fn.updateAPlayerControllerStatus(e);\n        APlayer.status = 'play';\n      });\n      APlayer.player.on('pause', function (e) {\n        fn.updateAPlayerControllerStatus(e);\n        APlayer.status = 'pause';\n      });\n      APlayer.player.on('volumechange', function (e) {\n        fn.onUpdateAPlayerVolume(e);\n      });\n      APlayer.player.on('loadstart', function (e) {\n        fn.updateTitle(e);\n      });\n\n      // 监听音量手势\n      APlayer.volumeBarWrap = document.getElementsByClassName('nav volume')[0].children[0];\n      APlayer.volumeBar = APlayer.volumeBarWrap.children[0];\n\n      const thumbMove = (e) => {\n        fn.updateAPlayerVolume(e);\n      };\n\n      const thumbUp = (e) => {\n        APlayer.volumeBarWrap.classList.remove('aplayer-volume-bar-wrap-active');\n        document.removeEventListener('mouseup', thumbUp);\n        document.removeEventListener('mousemove', thumbMove);\n        fn.updateAPlayerVolume(e);\n      };\n\n      APlayer.volumeBarWrap.addEventListener('mousedown', (event) => {\n        event.stopPropagation();\n        APlayer.volumeBarWrap.classList.add('aplayer-volume-bar-wrap-active');\n        document.addEventListener('mousemove', thumbMove);\n        document.addEventListener('mouseup', thumbUp);\n      });\n\n      APlayer.volumeBarWrap.addEventListener('click', (event) => {\n        event.stopPropagation();\n      });\n\n      fn.updateAPlayerControllerStatus();\n      fn.onUpdateAPlayerVolume();\n      APlayer.observer = true;\n    } catch (error) {\n      console.log(error);\n      APlayer.observer = undefined;\n    }\n  }\n\n  fn.updateAPlayerVolume = (e) => {\n    let percentage = ((e.clientX || e.changedTouches[0].clientX) -\n      APlayer.volumeBar.getBoundingClientRect().left) / APlayer.volumeBar.clientWidth;\n    percentage = Math.max(percentage, 0);\n    percentage = Math.min(percentage, 1);\n    APlayer.player.volume(percentage);\n  }\n\n  fn.onUpdateAPlayerVolume = () => {\n    try {\n      APlayer.volumeBar.children[0].style.width = APlayer.player.audio.volume * 100 + '%';\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 更新控制器状态\n  fn.updateAPlayerControllerStatus = () => {\n    try {\n      if (APlayer.player.audio.paused) {\n        playStatus = 'pause';\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.add('fa-play');\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.remove('fa-pause');\n      } else {\n        playStatus = 'play';\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.remove('fa-play');\n        document.getElementsByClassName('nav toggle')[0].children[0].classList.add('fa-pause');\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 播放/暂停\n  fn.aplayerToggle = () => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.toggle();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 上一曲\n  fn.aplayerBackward = () => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.skipBack();\n      APlayer.player.play();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 下一曲\n  fn.aplayerForward = () => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.skipForward();\n      APlayer.player.play();\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 调节音量\n  fn.aplayerVolume = (percent) => {\n    fn.checkAPlayer();\n    try {\n      APlayer.player.volume(percent);\n    } catch (error) {\n      console.log(error);\n    }\n  }\n\n  // 更新音乐标题\n  fn.updateTitle = () => {\n    fn.checkAPlayer();\n    try {\n      const index = APlayer.player.list.index;\n      const obj = APlayer.player.list.audios[index];\n      document.getElementsByClassName('nav music-title')[0].innerHTML = obj.title;\n    } catch (error) {\n      //console.log(error);\n    }\n  }\n\n  return {\n    checkAPlayer: fn.checkAPlayer,\n    aplayerBackward: fn.aplayerBackward,\n    aplayerToggle: fn.aplayerToggle,\n    aplayerForward: fn.aplayerForward,\n    APlayer: APlayer\n  }\n})()\n\nObject.freeze(RightMenuAplayer);\n\nvolantis.requestAnimationFrame(() => {\n  RightMenuAplayer.checkAPlayer();\n});\n","date":"2022-12-27T15:15:09.551Z","updated":"2022-12-27T15:15:09.551Z","path":"js/plugins/aplayer.js","layout":"false","title":"","comments":1,"_id":"clc6k3sf300026cu9g87i5ope"},{"_content":"document.addEventListener(\"DOMContentLoaded\", function () {\n  volantis.requestAnimationFrame(() => {\n    VolantisApp.init();\n    VolantisApp.subscribe();\n    VolantisFancyBox.init();\n    highlightKeyWords.startFromURL();\n    locationHash();\n  });\n});\n\n/* 锚点定位 */\nconst locationHash = () => {\n  if (window.location.hash) {\n    let locationID = decodeURI(window.location.hash.split('#')[1]).replace(/\\ /g, '-');\n    let target = document.getElementById(locationID);\n    if (target) {\n      setTimeout(() => {\n        if (window.location.hash.startsWith('#fn')) { // hexo-reference https://github.com/volantis-x/hexo-theme-volantis/issues/647\n          volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant', observer: true })\n        } else {\n          // 锚点中上半部有大片空白 高度大概是 volantis.dom.header.offsetHeight\n          volantis.scroll.to(target, { addTop: 5, behavior: 'instant', observer: true })\n        }\n      }, 1000)\n    }\n  }\n}\nObject.freeze(locationHash);\n\n/* Main */\nconst VolantisApp = (() => {\n  const fn = {},\n    COPYHTML = '<button class=\"btn-copy\" data-clipboard-snippet=\"\"><i class=\"fa-solid fa-copy\"></i><span>COPY</span></button>';\n  let scrollCorrection = 80;\n\n  fn.init = () => {\n    if (volantis.dom.header) {\n      scrollCorrection = volantis.dom.header.clientHeight + 16;\n    }\n\n    window.onresize = () => {\n      if (document.documentElement.clientWidth < 500) {\n        volantis.isMobile = 1;\n      } else {\n        volantis.isMobile = 0;\n      }\n      if (volantis.isMobile != volantis.isMobileOld) {\n        fn.setGlobalHeaderMenuEvent();\n        fn.setHeader();\n        fn.setHeaderSearch();\n      }\n    }\n    volantis.scroll.push(fn.scrollEventCallBack, \"scrollEventCallBack\")\n  }\n\n  fn.event = () => {\n    volantis.dom.$(document.getElementById(\"scroll-down\"))?.on('click', function () {\n      fn.scrolltoElement(volantis.dom.bodyAnchor);\n    });\n\n    // 如果 sidebar 为空，隐藏 sidebar。\n    const sidebar = document.querySelector(\"#l_side\")\n    if (sidebar) {\n      const sectionList = sidebar.querySelectorAll(\"section\")\n      if (!sectionList.length) {\n        document.querySelector(\"#l_main\").classList.add(\"no_sidebar\")\n      }\n    }\n\n    // 站点信息 最后活动日期\n    if (volantis.GLOBAL_CONFIG.sidebar.for_page.includes('webinfo') || volantis.GLOBAL_CONFIG.sidebar.for_post.includes('webinfo')) {\n      const lastupd = volantis.GLOBAL_CONFIG.sidebar.webinfo.lastupd;\n      if (!!document.getElementById('last-update-show') && lastupd.enable && lastupd.friendlyShow) {\n        document.getElementById('last-update-show').innerHTML = fn.utilTimeAgo(volantis.GLOBAL_CONFIG.lastupdate);\n      }\n    }\n\n    // 站点信息 运行时间\n    if (!!document.getElementById('webinfo-runtime-count')) {\n      let BirthDay = new Date(volantis.GLOBAL_CONFIG.sidebar.webinfo.runtime.data);\n      let timeold = (new Date().getTime() - BirthDay.getTime());\n      let daysold = Math.floor(timeold / (24 * 60 * 60 * 1000));\n      document.getElementById('webinfo-runtime-count').innerHTML = `${daysold} ${volantis.GLOBAL_CONFIG.sidebar.webinfo.runtime.unit}`;\n    }\n\n    // 消息提示 复制时弹出\n    document.body.oncopy = function () {\n      fn.messageCopyright()\n    };\n  }\n\n  fn.restData = () => {\n    scrollCorrection = volantis.dom.header ? volantis.dom.header.clientHeight + 16 : 80;\n  }\n\n  fn.setIsMobile = () => {\n    if (document.documentElement.clientWidth < 500) {\n      volantis.isMobile = 1;\n      volantis.isMobileOld = 1;\n    } else {\n      volantis.isMobile = 0;\n      volantis.isMobileOld = 0;\n    }\n  }\n\n  // 校正页面定位（被导航栏挡住的区域）\n  fn.scrolltoElement = (elem, correction = scrollCorrection) => {\n    volantis.scroll.to(elem, {\n      top: elem.getBoundingClientRect().top + document.documentElement.scrollTop - correction\n    })\n  }\n\n  // 滚动事件回调们\n  fn.scrollEventCallBack = () => {\n    // 【移动端 PC】//////////////////////////////////////////////////////////////////////\n\n    // 显示/隐藏 Header导航 topBtn 【移动端 PC】\n    const showHeaderPoint = volantis.dom.bodyAnchor.offsetTop - scrollCorrection;\n    const scrollTop = volantis.scroll.getScrollTop(); // 滚动条距离顶部的距离\n\n    // topBtn\n    if (volantis.dom.topBtn) {\n      if (scrollTop > volantis.dom.bodyAnchor.offsetTop) {\n        volantis.dom.topBtn.addClass('show');\n        // 向上滚动高亮 topBtn\n        if (volantis.scroll.del > 0) {\n          volantis.dom.topBtn.removeClass('hl');\n        } else {\n          volantis.dom.topBtn.addClass('hl');\n        }\n      } else {\n        volantis.dom.topBtn.removeClass('show').removeClass('hl');\n      }\n    }\n\n    // Header导航\n    if (volantis.dom.header) {\n      if (scrollTop - showHeaderPoint > -1) {\n        volantis.dom.header.addClass('show');\n      } else {\n        volantis.dom.header.removeClass('show');\n      }\n    }\n\n    // 决定一二级导航栏的切换 【向上滚动切换为一级导航栏；向下滚动切换为二级导航栏】  【移动端 PC】\n    if (pdata.ispage && volantis.dom.wrapper) {\n      if (volantis.scroll.del > 0 && scrollTop > 100) { // 向下滚动\n        volantis.dom.wrapper.addClass('sub'); // <---- 二级导航显示\n      } else if (volantis.scroll.del < 0) { // 向上滚动\n        volantis.dom.wrapper.removeClass('sub'); // <---- 取消二级导航显示 一级导航显示\n      }\n    }\n\n    // 【移动端】//////////////////////////////////////////////////////////////////////\n    if (volantis.isMobile) {\n      // 【移动端】 页面滚动  隐藏 移动端toc目录按钮\n      if (pdata.ispage && volantis.dom.tocTarget && volantis.dom.toc) {\n        volantis.dom.tocTarget.removeClass('active');\n        volantis.dom.toc.removeClass('active');\n      }\n      // 【移动端】 滚动时隐藏子菜单\n      if (volantis.dom.mPhoneList) {\n        volantis.dom.mPhoneList.forEach(function (e) {\n          volantis.dom.$(e).hide();\n        })\n      }\n    }\n  }\n\n  // 设置滚动锚点\n  fn.setScrollAnchor = () => {\n    // click topBtn 滚动至bodyAnchor 【移动端 PC】\n    if (volantis.dom.topBtn && volantis.dom.bodyAnchor) {\n      volantis.dom.topBtn.click(e => {\n        e.preventDefault();\n        e.stopPropagation();\n        fn.scrolltoElement(volantis.dom.bodyAnchor);\n        e.stopImmediatePropagation();\n      });\n    }\n\n  }\n\n  // 设置导航栏\n  fn.setHeader = () => {\n    // !!! 此处的Dom对象需要重载 !!!\n    if (!pdata.ispage) return;\n\n    // 填充二级导航文章标题 【移动端 PC】\n    volantis.dom.wrapper.find('.nav-sub .title').html(document.title.split(\" - \")[0]);\n\n    // ====== bind events to every btn =========\n    // 评论按钮 【移动端 PC】\n    volantis.dom.comment = volantis.dom.$(document.getElementById(\"s-comment\")); // 评论按钮  桌面端 移动端\n    volantis.dom.commentTarget = volantis.dom.$(document.querySelector('#l_main article#comments')); // 评论区域\n    if (volantis.dom.commentTarget) {\n      volantis.dom.comment.click(e => { // 评论按钮点击后 跳转到评论区域\n        e.preventDefault();\n        e.stopPropagation();\n        volantis.cleanContentVisibility();\n        fn.scrolltoElement(volantis.dom.commentTarget);\n        e.stopImmediatePropagation();\n      });\n    } else volantis.dom.comment.style.display = 'none'; // 关闭了评论，则隐藏评论按钮\n\n    // 移动端toc目录按钮 【移动端】\n    if (volantis.isMobile) {\n      volantis.dom.toc = volantis.dom.$(document.getElementById(\"s-toc\")); // 目录按钮  仅移动端\n      volantis.dom.tocTarget = volantis.dom.$(document.querySelector('#l_side .toc-wrapper')); // 侧边栏的目录列表\n      if (volantis.dom.tocTarget) {\n        // 点击移动端目录按钮 激活目录按钮 显示侧边栏的目录列表\n        volantis.dom.toc.click((e) => {\n          e.stopPropagation();\n          volantis.dom.tocTarget.toggleClass('active');\n          volantis.dom.toc.toggleClass('active');\n        });\n        // 点击空白 隐藏\n        volantis.dom.$(document).click(function (e) {\n          e.stopPropagation();\n          if (volantis.dom.tocTarget) {\n            volantis.dom.tocTarget.removeClass('active');\n          }\n          volantis.dom.toc.removeClass('active');\n        });\n      } else if (volantis.dom.toc) volantis.dom.toc.style.display = 'none'; // 隐藏toc目录按钮\n    }\n  }\n\n  // 设置导航栏菜单选中状态  【移动端 PC】\n  fn.setHeaderMenuSelection = () => {\n    // !!! 此处的Dom对象需要重载 !!!\n    volantis.dom.headerMenu = volantis.dom.$(document.querySelectorAll('#l_header .navigation,#l_cover .navigation,#l_side .navigation')); // 导航列表\n\n    // 先把已经激活的取消激活\n    volantis.dom.headerMenu.forEach(element => {\n      let li = volantis.dom.$(element).find('li a.active')\n      if (li)\n        li.removeClass('active')\n      let div = volantis.dom.$(element).find('div a.active')\n      if (div)\n        div.removeClass('active')\n    });\n\n    // replace '%' '/' '.'\n    var idname = location.pathname.replace(/\\/|%|\\./g, '');\n    if (idname.length == 0) {\n      idname = 'home';\n    }\n    var page = idname.match(/page\\d{0,}$/g);\n    if (page) {\n      page = page[0];\n      idname = idname.split(page)[0];\n    }\n    var index = idname.match(/index.html/);\n    if (index) {\n      index = index[0];\n      idname = idname.split(index)[0];\n    }\n    // 转义字符如 [, ], ~, #, @\n    idname = idname.replace(/(\\[|\\]|~|#|@)/g, '\\\\$1');\n    if (idname && volantis.dom.headerMenu) {\n      volantis.dom.headerMenu.forEach(element => {\n        // idname 不能为数字开头, 加一个 action- 前缀\n        let id = element.querySelector(\"[active-action=action-\" + idname + \"]\")\n        if (id) {\n          volantis.dom.$(id).addClass('active')\n        }\n      });\n    }\n  }\n\n  // 设置全局事件\n  fn.setGlobalHeaderMenuEvent = () => {\n    if (volantis.isMobile) {\n      // 【移动端】 关闭已经展开的子菜单 点击展开子菜单\n      document.querySelectorAll('#l_header .m-phone li').forEach(function (e) {\n        if (e.querySelector(\".list-v\")) {\n          // 点击菜单\n          volantis.dom.$(e).click(function (e) {\n            e.stopPropagation();\n            // 关闭已经展开的子菜单\n            e.currentTarget.parentElement.childNodes.forEach(function (e) {\n              if (Object.prototype.toString.call(e) == '[object HTMLLIElement]') {\n                e.childNodes.forEach(function (e) {\n                  if (Object.prototype.toString.call(e) == '[object HTMLUListElement]') {\n                    volantis.dom.$(e).hide()\n                  }\n                })\n              }\n            })\n            // 点击展开子菜单\n            let array = e.currentTarget.children\n            for (let index = 0; index < array.length; index++) {\n              const element = array[index];\n              if (volantis.dom.$(element).title === 'menu') { // 移动端菜单栏异常\n                volantis.dom.$(element).display = \"flex\"      // https://github.com/volantis-x/hexo-theme-volantis/issues/706\n              } else {\n                volantis.dom.$(element).show()\n              }\n            }\n          }, 0);\n        }\n      })\n    } else {\n      // 【PC端】 hover时展开子菜单，点击时[target.baseURI==origin时]隐藏子菜单? 现有逻辑大部分情况不隐藏子菜单\n      document.querySelectorAll('#wrapper .m-pc li > a[href]').forEach(function (e) {\n        volantis.dom.$(e.parentElement).click(function (e) {\n          e.stopPropagation();\n          if (e.target.origin == e.target.baseURI) {\n            document.querySelectorAll('#wrapper .m-pc .list-v').forEach(function (e) {\n              volantis.dom.$(e).hide(); // 大概率不会执行\n            })\n          }\n        }, 0);\n      })\n    }\n    fn.setPageHeaderMenuEvent();\n  }\n\n  // 【移动端】隐藏子菜单\n  fn.setPageHeaderMenuEvent = () => {\n    if (!volantis.isMobile) return\n    // 【移动端】 点击空白处隐藏子菜单\n    volantis.dom.$(document).click(function (e) {\n      volantis.dom.mPhoneList.forEach(function (e) {\n        volantis.dom.$(e).hide();\n      })\n    });\n  }\n\n  // 设置导航栏搜索框 【移动端】\n  fn.setHeaderSearch = () => {\n    if (!volantis.isMobile) return;\n    if (!volantis.dom.switcher) return;\n    // 点击移动端搜索按钮\n    volantis.dom.switcher.click(function (e) {\n      e.stopPropagation();\n      volantis.dom.header.toggleClass('z_search-open'); // 激活移动端搜索框\n      volantis.dom.switcher.toggleClass('active'); // 移动端搜索按钮\n    });\n    // 点击空白取消激活\n    volantis.dom.$(document).click(function (e) {\n      volantis.dom.header.removeClass('z_search-open');\n      volantis.dom.switcher.removeClass('active');\n    });\n    // 移动端点击搜索框 停止事件传播\n    volantis.dom.search.click(function (e) {\n      e.stopPropagation();\n    });\n  }\n\n  // 设置 tabs 标签  【移动端 PC】\n  fn.setTabs = () => {\n    let tabs = document.querySelectorAll('#l_main .tabs .nav-tabs')\n    if (!tabs) return\n    tabs.forEach(function (e) {\n      e.querySelectorAll('a').forEach(function (e) {\n        volantis.dom.$(e).on('click', (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          const $tab = volantis.dom.$(e.target.parentElement.parentElement.parentElement);\n          $tab.find('.nav-tabs .active').removeClass('active');\n          volantis.dom.$(e.target.parentElement).addClass('active');\n          $tab.find('.tab-content .active').removeClass('active');\n          $tab.find(e.target.className).addClass('active');\n          return false;\n        });\n      })\n    })\n  }\n\n  // hexo-reference 页脚跳转 https://github.com/volantis-x/hexo-theme-volantis/issues/647\n  fn.footnotes = () => {\n    let ref = document.querySelectorAll('#l_main .footnote-backref, #l_main .footnote-ref > a');\n    ref.forEach(function (e, i) {\n      ref[i].click = () => { }; // 强制清空原 click 事件\n      volantis.dom.$(e).on('click', (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        let targetID = decodeURI(e.target.hash.split('#')[1]).replace(/\\ /g, '-');\n        let target = document.getElementById(targetID);\n        if (target) {\n          volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant' })\n        }\n      });\n    })\n  }\n\n  // 工具类：代码块复制\n  fn.utilCopyCode = (Selector) => {\n    document.querySelectorAll(Selector).forEach(node => {\n      const test = node.insertAdjacentHTML(\"beforebegin\", COPYHTML);\n      const _BtnCopy = node.previousSibling;\n      _BtnCopy.onclick = e => {\n        e.stopPropagation();\n        const _icon = _BtnCopy.querySelector('i');\n        const _span = _BtnCopy.querySelector('span');\n\n        node.focus();\n        const range = new Range();\n        range.selectNodeContents(node);\n        document.getSelection().removeAllRanges();\n        document.getSelection().addRange(range);\n\n        const str = document.getSelection().toString();\n        fn.utilWriteClipText(str).then(() => {\n          fn.messageCopyright();\n          _BtnCopy.classList.add('copied');\n          _icon.classList.remove('fa-copy');\n          _icon.classList.add('fa-check-circle');\n          _span.innerText = \"COPIED\";\n          setTimeout(() => {\n            _icon.classList.remove('fa-check-circle');\n            _icon.classList.add('fa-copy');\n            _span.innerText = \"COPY\";\n          }, 2000)\n        }).catch(e => {\n          VolantisApp.message('系统提示', e, {\n            icon: 'fa fa-exclamation-circle red'\n          });\n          _BtnCopy.classList.add('copied-failed');\n          _icon.classList.remove('fa-copy');\n          _icon.classList.add('fa-exclamation-circle');\n          _span.innerText = \"COPY FAILED\";\n          setTimeout(() => {\n            _icon.classList.remove('fa-exclamation-circle');\n            _icon.classList.add('fa-copy');\n            _span.innerText = \"COPY\";\n          })\n        })\n      }\n    });\n  }\n\n  // 工具类：复制字符串到剪切板\n  fn.utilWriteClipText = (str) => {\n    return navigator.clipboard\n      .writeText(str)\n      .then(() => {\n        return Promise.resolve()\n      })\n      .catch(e => {\n        const input = document.createElement('textarea');\n        input.setAttribute('readonly', 'readonly');\n        document.body.appendChild(input);\n        input.innerHTML = str;\n        input.select();\n        try {\n          let result = document.execCommand('copy')\n          document.body.removeChild(input);\n          if (!result || result === 'unsuccessful') {\n            return Promise.reject('复制文本失败!')\n          } else {\n            return Promise.resolve()\n          }\n        } catch (e) {\n          document.body.removeChild(input);\n          return Promise.reject(\n            '当前浏览器不支持复制功能，请检查更新或更换其他浏览器操作!'\n          )\n        }\n      })\n  }\n\n  // 工具类：返回时间间隔\n  fn.utilTimeAgo = (dateTimeStamp) => {\n    const minute = 1e3 * 60, hour = minute * 60, day = hour * 24, week = day * 7, month = day * 30;\n    const now = new Date().getTime();\n    const diffValue = now - dateTimeStamp;\n    const minC = diffValue / minute,\n      hourC = diffValue / hour,\n      dayC = diffValue / day,\n      weekC = diffValue / week,\n      monthC = diffValue / month;\n    if (diffValue < 0) {\n      result = \"\"\n    } else if (monthC >= 1 && monthC < 7) {\n      result = \" \" + parseInt(monthC) + \" 月前\"\n    } else if (weekC >= 1 && weekC < 4) {\n      result = \" \" + parseInt(weekC) + \" 周前\"\n    } else if (dayC >= 1 && dayC < 7) {\n      result = \" \" + parseInt(dayC) + \" 天前\"\n    } else if (hourC >= 1 && hourC < 24) {\n      result = \" \" + parseInt(hourC) + \" 小时前\"\n    } else if (minC >= 1 && minC < 60) {\n      result = \" \" + parseInt(minC) + \" 分钟前\"\n    } else if (diffValue >= 0 && diffValue <= minute) {\n      result = \"刚刚\"\n    } else {\n      const datetime = new Date();\n      datetime.setTime(dateTimeStamp);\n      const Nyear = datetime.getFullYear();\n      const Nmonth = datetime.getMonth() + 1 < 10 ? \"0\" + (datetime.getMonth() + 1) : datetime.getMonth() + 1;\n      const Ndate = datetime.getDate() < 10 ? \"0\" + datetime.getDate() : datetime.getDate();\n      const Nhour = datetime.getHours() < 10 ? \"0\" + datetime.getHours() : datetime.getHours();\n      const Nminute = datetime.getMinutes() < 10 ? \"0\" + datetime.getMinutes() : datetime.getMinutes();\n      const Nsecond = datetime.getSeconds() < 10 ? \"0\" + datetime.getSeconds() : datetime.getSeconds();\n      result = Nyear + \"-\" + Nmonth + \"-\" + Ndate\n    }\n    return result;\n  }\n\n  // 消息提示：标准\n  fn.message = (title, message, option = {}, done = null) => {\n    if (typeof iziToast === \"undefined\") {\n      volantis.css(volantis.GLOBAL_CONFIG.cdn.izitoast_css)\n      volantis.js(volantis.GLOBAL_CONFIG.cdn.izitoast_js, () => {\n        tozashMessage(title, message, option, done);\n      });\n    } else {\n      tozashMessage(title, message, option, done);\n    }\n    function tozashMessage(title, message, option, done) {\n      const {\n        icon,\n        time,\n        position,\n        transitionIn,\n        transitionOut,\n        messageColor,\n        titleColor,\n        backgroundColor,\n        zindex,\n        displayMode\n      } = option;\n      iziToast.show({\n        layout: '2',\n        icon: 'Fontawesome',\n        closeOnEscape: 'true',\n        displayMode: displayMode || 'replace',\n        transitionIn: transitionIn || volantis.GLOBAL_CONFIG.plugins.message.transitionIn,\n        transitionOut: transitionOut || volantis.GLOBAL_CONFIG.plugins.message.transitionOut,\n        messageColor: messageColor || volantis.GLOBAL_CONFIG.plugins.message.messageColor,\n        titleColor: titleColor || volantis.GLOBAL_CONFIG.plugins.message.titleColor,\n        backgroundColor: backgroundColor || volantis.GLOBAL_CONFIG.plugins.message.backgroundColor,\n        zindex: zindex || volantis.GLOBAL_CONFIG.plugins.message.zindex,\n        icon: icon || volantis.GLOBAL_CONFIG.plugins.message.icon.default,\n        timeout: time || volantis.GLOBAL_CONFIG.plugins.message.time.default,\n        position: position || volantis.GLOBAL_CONFIG.plugins.message.position,\n        title: title,\n        message: message,\n        onClosed: () => {\n          if (done) done();\n        },\n      });\n    }\n  }\n\n  // 消息提示：询问\n  fn.question = (title, message, option = {}, success = null, cancel = null, done = null) => {\n    if (typeof iziToast === \"undefined\") {\n      volantis.css(volantis.GLOBAL_CONFIG.cdn.izitoast_css)\n      volantis.js(volantis.GLOBAL_CONFIG.cdn.izitoast_js, () => {\n        tozashQuestion(title, message, option, success, cancel, done);\n      });\n    } else {\n      tozashQuestion(title, message, option, success, cancel, done);\n    }\n\n    function tozashQuestion(title, message, option, success, cancel, done) {\n      const {\n        icon,\n        time,\n        position,\n        transitionIn,\n        transitionOut,\n        messageColor,\n        titleColor,\n        backgroundColor,\n        zindex\n      } = option;\n      iziToast.question({\n        id: 'question',\n        icon: 'Fontawesome',\n        close: false,\n        overlay: true,\n        displayMode: 'once',\n        position: 'center',\n        messageColor: messageColor || volantis.GLOBAL_CONFIG.plugins.message.messageColor,\n        titleColor: titleColor || volantis.GLOBAL_CONFIG.plugins.message.titleColor,\n        backgroundColor: backgroundColor || volantis.GLOBAL_CONFIG.plugins.message.backgroundColor,\n        zindex: zindex || volantis.GLOBAL_CONFIG.plugins.message.zindex,\n        icon: icon || volantis.GLOBAL_CONFIG.plugins.message.icon.quection,\n        timeout: time || volantis.GLOBAL_CONFIG.plugins.message.time.quection,\n        title: title,\n        message: message,\n        buttons: [\n          ['<button><b>是</b></button>', (instance, toast) => {\n            instance.hide({ transitionOut: transitionOut || 'fadeOut' }, toast, 'button');\n            if (success) success(instance, toast)\n          }],\n          ['<button><b>否</b></button>', (instance, toast) => {\n            instance.hide({ transitionOut: transitionOut || 'fadeOut' }, toast, 'button');\n            if (cancel) cancel(instance, toast)\n          }]\n        ],\n        onClosed: (instance, toast, closedBy) => {\n          if (done) done(instance, toast, closedBy);\n        }\n      });\n    }\n  }\n\n  // 消息提示：隐藏\n  fn.hideMessage = (done = null) => {\n    const toast = document.querySelector('.iziToast');\n    if (!toast) {\n      if (done) done()\n      return;\n    }\n\n    if (typeof iziToast === \"undefined\") {\n      volantis.css(volantis.GLOBAL_CONFIG.cdn.izitoast_css)\n      volantis.js(volantis.GLOBAL_CONFIG.cdn.izitoast_js, () => {\n        hideMessage(done);\n      });\n    } else {\n      hideMessage(done);\n    }\n\n    function hideMessage(done) {\n      iziToast.hide({}, toast);\n      if (done) done();\n    }\n  }\n\n  // 消息提示：复制\n  let messageCopyrightShow = 0;\n  fn.messageCopyright = () => {\n    // 消息提示 复制时弹出\n    if (volantis.GLOBAL_CONFIG.plugins.message.enable\n      && volantis.GLOBAL_CONFIG.plugins.message.copyright.enable\n      && messageCopyrightShow < 1) {\n      messageCopyrightShow++;\n      VolantisApp.message(volantis.GLOBAL_CONFIG.plugins.message.copyright.title,\n        volantis.GLOBAL_CONFIG.plugins.message.copyright.message, {\n        icon: volantis.GLOBAL_CONFIG.plugins.message.copyright.icon,\n        transitionIn: 'flipInX',\n        transitionOut: 'flipOutX',\n        displayMode: 1\n      });\n    }\n  }\n\n  return {\n    init: () => {\n      fn.init();\n      fn.event();\n    },\n    subscribe: () => {\n      fn.setIsMobile();\n      fn.setHeader();\n      fn.setHeaderMenuSelection();\n      fn.setGlobalHeaderMenuEvent();\n      fn.setHeaderSearch();\n      fn.setScrollAnchor();\n      fn.setTabs();\n      fn.footnotes();\n    },\n    utilCopyCode: fn.utilCopyCode,\n    utilWriteClipText: fn.utilWriteClipText,\n    utilTimeAgo: fn.utilTimeAgo,\n    message: fn.message,\n    question: fn.question,\n    hideMessage: fn.hideMessage,\n    messageCopyright: fn.messageCopyright,\n    scrolltoElement: fn.scrolltoElement\n  }\n})()\nObject.freeze(VolantisApp);\n\n/* FancyBox */\nconst VolantisFancyBox = (() => {\n  const fn = {};\n\n  fn.loadFancyBox = (done) => {\n    volantis.css(volantis.GLOBAL_CONFIG.cdn.fancybox_css);\n    volantis.js(volantis.GLOBAL_CONFIG.cdn.fancybox_js).then(() => {\n      if (done) done();\n    })\n  }\n\n  /**\n   * 加载及处理\n   * \n   * @param {*} checkMain 是否只处理文章区域的文章\n   * @param {*} done      FancyBox 加载完成后的动作，默认执行分组绑定\n   * @returns \n   */\n  fn.init = (checkMain = true, done = fn.groupBind) => {\n    if (!document.querySelector(\".md .gallery img, .fancybox\") && checkMain) return;\n    if (typeof Fancybox === \"undefined\") {\n      fn.loadFancyBox(done);\n    } else {\n      done();\n    }\n  }\n\n  /**\n   * 图片元素预处理\n   * \n   * @param {*} selectors 选择器\n   * @param {*} name      分组\n   */\n  fn.elementHandling = (selectors, name) => {\n    const nodeList = document.querySelectorAll(selectors);\n    nodeList.forEach($item => {\n      if ($item.hasAttribute('fancybox')) return;\n      $item.setAttribute('fancybox', '');\n      const $link = document.createElement('a');\n      $link.setAttribute('href', $item.src);\n      $link.setAttribute('data-caption', $item.alt);\n      $link.setAttribute('data-fancybox', name);\n      $link.classList.add('fancybox');\n      $link.append($item.cloneNode());\n      $item.replaceWith($link);\n    })\n  }\n\n  /**\n   * 原生绑定\n   * \n   * @param {*} selectors 选择器\n   */\n  fn.bind = (selectors) => {\n    fn.init(false, () => {\n      Fancybox.bind(selectors, {\n        groupAll: true,\n        Hash: false,\n        hideScrollbar: false,\n        Thumbs: {\n          autoStart: false,\n        },\n        caption: function (fancybox, carousel, slide) {\n          return slide.$trigger.alt || null\n        }\n      });\n    });\n  }\n\n  /**\n   * 分组绑定\n   * \n   * @param {*} groupName 分组名称\n   */\n  fn.groupBind = (groupName = null) => {\n    const group = new Set();\n\n    document.querySelectorAll(\".gallery\").forEach(ele => {\n      if (ele.querySelector(\"img\")) {\n        group.add(ele.getAttribute('data-group') || 'default');\n      }\n    })\n\n    if (!!groupName) group.add(groupName);\n\n    for (const iterator of group) {\n      Fancybox.unbind('[data-fancybox=\"' + iterator + '\"]');\n      Fancybox.bind('[data-fancybox=\"' + iterator + '\"]', {\n        Hash: false,\n        hideScrollbar: false,\n        Thumbs: {\n          autoStart: false,\n        }\n      });\n    }\n  }\n\n  return {\n    init: fn.init,\n    bind: fn.bind,\n    groupBind: (selectors, groupName = 'default') => {\n      try {\n        fn.elementHandling(selectors, groupName);\n        fn.init(false, () => {\n          fn.groupBind(groupName)\n        });\n      } catch (error) {\n        console.error(error)\n      }\n    }\n  }\n})()\nObject.freeze(VolantisFancyBox);\n\n// highlightKeyWords 与 搜索功能搭配 https://github.com/next-theme/hexo-theme-next/blob/eb194a7258058302baf59f02d4b80b6655338b01/source/js/third-party/search/local-search.js\n// Question: 锚点稳定性未知\n// ToDo: 查找模式\n// 0. (/////////要知道浏览器自带全页面查找功能 CTRL + F)\n// 1. 右键开启查找模式 / 导航栏菜单开启?? / CTRL + F ???\n// 2. 查找模式面板 (可拖动? or 固定?)\n// 3. keyword mark id 从 0 开始编号 查找下一处 highlightKeyWords.scrollToNextHighlightKeywordMark() 查找上一处 scrollToPrevHighlightKeywordMark() 循环查找(取模%)\n// 4. 可输入修改 查找关键词 keywords(type:list)\n// 5. 区分大小写 caseSensitive (/ 全字匹配?? / 正则匹配??)\n// 6. 在选定区域中查找 querySelector ??\n// 7. 关闭查找模式\n// 8. 搜索跳转 (URL 入口) 自动开启查找模式 调用 scrollToNextHighlightKeywordMark()\nconst highlightKeyWords = (() => {\n  let fn = {}\n  fn.markNum = 0\n  fn.markNextId = -1\n  fn.startFromURL = () => {\n    const params = decodeURI(new URL(location.href).searchParams.get('keyword'));\n    const keywords = params ? params.split(' ') : [];\n    const post = document.querySelector('#l_main');\n    if (keywords.length == 1 && keywords[0] == \"null\") {\n      return;\n    }\n    fn.start(keywords, post); // 渲染耗时较长\n    fn.scrollToFirstHighlightKeywordMark()\n  }\n  fn.scrollToFirstHighlightKeywordMark = () => {\n    volantis.cleanContentVisibility();\n    let target = fn.scrollToNextHighlightKeywordMark(\"0\");\n    if (!target) {\n      volantis.requestAnimationFrame(fn.scrollToFirstHighlightKeywordMark)\n    }\n  }\n  fn.scrollToNextHighlightKeywordMark = (id) => {\n    // Next Id\n    let input = id || (fn.markNextId + 1) % fn.markNum;\n    fn.markNextId = parseInt(input)\n    let target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    if (!target) {\n      fn.markNextId = (fn.markNextId + 1) % fn.markNum;\n      target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    }\n    if (target) {\n      volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant' })\n    }\n    // Current target\n    return target\n  }\n  fn.scrollToPrevHighlightKeywordMark = (id) => {\n    // Prev Id\n    let input = id || (fn.markNextId - 1 + fn.markNum) % fn.markNum;\n    fn.markNextId = parseInt(input)\n    let target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    if (!target) {\n      fn.markNextId = (fn.markNextId - 1 + fn.markNum) % fn.markNum;\n      target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    }\n    if (target) {\n      volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant' })\n    }\n    // Current target\n    return target\n  }\n  fn.start = (keywords, querySelector) => {\n    fn.markNum = 0\n    if (!keywords.length || !querySelector || (keywords.length == 1 && keywords[0] == \"null\")) return;\n    console.log(keywords);\n    const walk = document.createTreeWalker(querySelector, NodeFilter.SHOW_TEXT, null);\n    const allNodes = [];\n    while (walk.nextNode()) {\n      if (!walk.currentNode.parentNode.matches('button, select, textarea')) allNodes.push(walk.currentNode);\n    }\n    allNodes.forEach(node => {\n      const [indexOfNode] = fn.getIndexByWord(keywords, node.nodeValue);\n      if (!indexOfNode.length) return;\n      const slice = fn.mergeIntoSlice(0, node.nodeValue.length, indexOfNode);\n      fn.highlightText(node, slice, 'keyword');\n      fn.highlightStyle()\n    });\n  }\n  fn.getIndexByWord = (words, text, caseSensitive = false) => {\n    const index = [];\n    const included = new Set();\n    words.forEach(word => {\n      const div = document.createElement('div');\n      div.innerText = word;\n      word = div.innerHTML;\n\n      const wordLen = word.length;\n      if (wordLen === 0) return;\n      let startPosition = 0;\n      let position = -1;\n      if (!caseSensitive) {\n        text = text.toLowerCase();\n        word = word.toLowerCase();\n      }\n      while ((position = text.indexOf(word, startPosition)) > -1) {\n        index.push({ position, word });\n        included.add(word);\n        startPosition = position + wordLen;\n      }\n    });\n    index.sort((left, right) => {\n      if (left.position !== right.position) {\n        return left.position - right.position;\n      }\n      return right.word.length - left.word.length;\n    });\n    return [index, included];\n  };\n  fn.mergeIntoSlice = (start, end, index) => {\n    let item = index[0];\n    let { position, word } = item;\n    const hits = [];\n    const count = new Set();\n    while (position + word.length <= end && index.length !== 0) {\n      count.add(word);\n      hits.push({\n        position,\n        length: word.length\n      });\n      const wordEnd = position + word.length;\n\n      index.shift();\n      while (index.length !== 0) {\n        item = index[0];\n        position = item.position;\n        word = item.word;\n        if (wordEnd > position) {\n          index.shift();\n        } else {\n          break;\n        }\n      }\n    }\n    return {\n      hits,\n      start,\n      end,\n      count: count.size\n    };\n  };\n  fn.highlightText = (node, slice, className) => {\n    const val = node.nodeValue;\n    let index = slice.start;\n    const children = [];\n    for (const { position, length } of slice.hits) {\n      const text = document.createTextNode(val.substring(index, position));\n      index = position + length;\n      let mark = document.createElement('mark');\n      mark.className = className;\n      mark = fn.highlightStyle(mark)\n      mark.appendChild(document.createTextNode(val.substr(position, length)));\n      children.push(text, mark);\n    }\n    node.nodeValue = val.substring(index, slice.end);\n    children.forEach(element => {\n      node.parentNode.insertBefore(element, node);\n    });\n  }\n  fn.highlightStyle = (mark) => {\n    if (!mark) return;\n    mark.id = \"keyword-mark-\" + fn.markNum;\n    fn.markNum++;\n    mark.style.background = \"transparent\";\n    mark.style[\"border-bottom\"] = \"1px dashed #ff2a2a\";\n    mark.style[\"color\"] = \"#ff2a2a\";\n    mark.style[\"font-weight\"] = \"bold\";\n    return mark\n  }\n  fn.cleanHighlightStyle = () => {\n    document.querySelectorAll(\".keyword\").forEach(mark => {\n      mark.style.background = \"transparent\";\n      mark.style[\"border-bottom\"] = null;\n      mark.style[\"color\"] = null;\n      mark.style[\"font-weight\"] = null;\n    })\n  }\n  return {\n    start: (keywords, querySelector) => {\n      fn.start(keywords, querySelector)\n    },\n    startFromURL: () => {\n      fn.startFromURL()\n    },\n    scrollToNextHighlightKeywordMark: (id) => {\n      fn.scrollToNextHighlightKeywordMark(id)\n    },\n    scrollToPrevHighlightKeywordMark: (id) => {\n      fn.scrollToPrevHighlightKeywordMark(id)\n    },\n    cleanHighlightStyle: () => {\n      fn.cleanHighlightStyle()\n    },\n  }\n})()\nObject.freeze(highlightKeyWords);\n\n/* DOM 控制 */\nconst DOMController = {\n  /**\n   * 控制元素显隐\n   */\n  visible: (ele, type = true) => {\n    if (ele) ele.style.display = type === true ? 'block' : 'none';\n  },\n\n  /**\n   * 移除元素\n   */\n  remove: (param) => {\n    const node = document.querySelectorAll(param);\n    node.forEach(ele => {\n      ele.remove();\n    })\n  },\n\n  removeList: (list) => {\n    list.forEach(param => {\n      DOMController.remove(param)\n    })\n  },\n\n  /**\n   * 设置属性\n   */\n  setAttribute: (param, attrName, attrValue) => {\n    const node = document.querySelectorAll(param);\n    node.forEach(ele => {\n      ele.setAttribute(attrName, attrValue)\n    })\n  },\n\n  setAttributeList: (list) => {\n    list.forEach(item => {\n      DOMController.setAttribute(item[0], item[1], item[2])\n    })\n  },\n\n  /**\n   * 设置样式\n   */\n  setStyle: (param, styleName, styleValue) => {\n    const node = document.querySelectorAll(param);\n    node.forEach(ele => {\n      ele.style[styleName] = styleValue;\n    })\n  },\n\n  setStyleList: (list) => {\n    list.forEach(item => {\n      DOMController.setStyle(item[0], item[1], item[2])\n    })\n  },\n\n  fadeIn: (e) => {\n    if (!e) return;\n    e.style.visibility = \"visible\";\n    e.style.opacity = 1;\n    e.style.display = \"block\";\n    e.style.transition = \"all 0.5s linear\";\n    return e\n  },\n\n  fadeOut: (e) => {\n    if (!e) return;\n    e.style.visibility = \"hidden\";\n    e.style.opacity = 0;\n    e.style.display = \"none\";\n    e.style.transition = \"all 0.5s linear\";\n    return e\n  },\n\n  fadeToggle: (e) => {\n    if (!e) return;\n    if (e.style.visibility == \"hidden\") {\n      e = DOMController.fadeIn(e)\n    } else {\n      e = DOMController.fadeOut(e)\n    }\n    return e\n  },\n\n  fadeToggleList: (list) => {\n    list.forEach(param => {\n      DOMController.fadeToggle(param)\n    })\n  },\n\n  hasClass: (e, c) => {\n    if (!e) return;\n    return e.className.match(new RegExp('(\\\\s|^)' + c + '(\\\\s|$)'));\n  },\n\n  addClass: (e, c) => {\n    if (!e) return;\n    e.classList.add(c);\n    return e\n  },\n\n  removeClass: (e, c) => {\n    if (!e) return;\n    e.classList.remove(c);\n    return e\n  },\n\n  toggleClass: (e, c) => {\n    if (!e) return;\n    if (DOMController.hasClass(e, c)) {\n      DOMController.removeClass(e, c)\n    } else {\n      DOMController.addClass(e, c)\n    }\n    return e\n  },\n\n  toggleClassList: (list) => {\n    list.forEach(item => {\n      DOMController.toggleClass(item[0], item[1])\n    })\n  }\n}\nObject.freeze(DOMController);\n\nconst VolantisRequest = {\n  timeoutFetch: (url, ms, requestInit) => {\n    const controller = new AbortController()\n    requestInit.signal?.addEventListener('abort', () => controller.abort())\n    let promise = fetch(url, { ...requestInit, signal: controller.signal })\n    if (ms > 0) {\n      const timer = setTimeout(() => controller.abort(), ms)\n      promise.finally(() => { clearTimeout(timer) })\n    }\n    promise = promise.catch((err) => {\n      throw ((err || {}).name === 'AbortError') ? new Error(`Fetch timeout: ${url}`) : err\n    })\n    return promise\n  },\n\n  Fetch: async (url, requestInit, timeout = 15000) => {\n    const resp = await VolantisRequest.timeoutFetch(url, timeout, requestInit);\n    if (!resp.ok) throw new Error(`Fetch error: ${url} | ${resp.status}`);\n    let json = await resp.json()\n    if (!json.success) throw json\n    return json\n  },\n\n  POST: async (url, data) => {\n    const requestInit = {\n      method: 'POST',\n    }\n    if (data) {\n      const formData = new FormData();\n      Object.keys(data).forEach(key => formData.append(key, String(data[key])))\n      requestInit.body = formData;\n    }\n    const json = await VolantisRequest.Fetch(url, requestInit)\n    return json.data;\n  },\n\n  Get: async (url, data) => {\n    const json = await VolantisRequest.Fetch(url + (data ? (`?${new URLSearchParams(data)}`) : ''), {\n      method: 'GET'\n    })\n  }\n}\nObject.freeze(VolantisRequest);\n","source":"js/app.js","raw":"document.addEventListener(\"DOMContentLoaded\", function () {\n  volantis.requestAnimationFrame(() => {\n    VolantisApp.init();\n    VolantisApp.subscribe();\n    VolantisFancyBox.init();\n    highlightKeyWords.startFromURL();\n    locationHash();\n  });\n});\n\n/* 锚点定位 */\nconst locationHash = () => {\n  if (window.location.hash) {\n    let locationID = decodeURI(window.location.hash.split('#')[1]).replace(/\\ /g, '-');\n    let target = document.getElementById(locationID);\n    if (target) {\n      setTimeout(() => {\n        if (window.location.hash.startsWith('#fn')) { // hexo-reference https://github.com/volantis-x/hexo-theme-volantis/issues/647\n          volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant', observer: true })\n        } else {\n          // 锚点中上半部有大片空白 高度大概是 volantis.dom.header.offsetHeight\n          volantis.scroll.to(target, { addTop: 5, behavior: 'instant', observer: true })\n        }\n      }, 1000)\n    }\n  }\n}\nObject.freeze(locationHash);\n\n/* Main */\nconst VolantisApp = (() => {\n  const fn = {},\n    COPYHTML = '<button class=\"btn-copy\" data-clipboard-snippet=\"\"><i class=\"fa-solid fa-copy\"></i><span>COPY</span></button>';\n  let scrollCorrection = 80;\n\n  fn.init = () => {\n    if (volantis.dom.header) {\n      scrollCorrection = volantis.dom.header.clientHeight + 16;\n    }\n\n    window.onresize = () => {\n      if (document.documentElement.clientWidth < 500) {\n        volantis.isMobile = 1;\n      } else {\n        volantis.isMobile = 0;\n      }\n      if (volantis.isMobile != volantis.isMobileOld) {\n        fn.setGlobalHeaderMenuEvent();\n        fn.setHeader();\n        fn.setHeaderSearch();\n      }\n    }\n    volantis.scroll.push(fn.scrollEventCallBack, \"scrollEventCallBack\")\n  }\n\n  fn.event = () => {\n    volantis.dom.$(document.getElementById(\"scroll-down\"))?.on('click', function () {\n      fn.scrolltoElement(volantis.dom.bodyAnchor);\n    });\n\n    // 如果 sidebar 为空，隐藏 sidebar。\n    const sidebar = document.querySelector(\"#l_side\")\n    if (sidebar) {\n      const sectionList = sidebar.querySelectorAll(\"section\")\n      if (!sectionList.length) {\n        document.querySelector(\"#l_main\").classList.add(\"no_sidebar\")\n      }\n    }\n\n    // 站点信息 最后活动日期\n    if (volantis.GLOBAL_CONFIG.sidebar.for_page.includes('webinfo') || volantis.GLOBAL_CONFIG.sidebar.for_post.includes('webinfo')) {\n      const lastupd = volantis.GLOBAL_CONFIG.sidebar.webinfo.lastupd;\n      if (!!document.getElementById('last-update-show') && lastupd.enable && lastupd.friendlyShow) {\n        document.getElementById('last-update-show').innerHTML = fn.utilTimeAgo(volantis.GLOBAL_CONFIG.lastupdate);\n      }\n    }\n\n    // 站点信息 运行时间\n    if (!!document.getElementById('webinfo-runtime-count')) {\n      let BirthDay = new Date(volantis.GLOBAL_CONFIG.sidebar.webinfo.runtime.data);\n      let timeold = (new Date().getTime() - BirthDay.getTime());\n      let daysold = Math.floor(timeold / (24 * 60 * 60 * 1000));\n      document.getElementById('webinfo-runtime-count').innerHTML = `${daysold} ${volantis.GLOBAL_CONFIG.sidebar.webinfo.runtime.unit}`;\n    }\n\n    // 消息提示 复制时弹出\n    document.body.oncopy = function () {\n      fn.messageCopyright()\n    };\n  }\n\n  fn.restData = () => {\n    scrollCorrection = volantis.dom.header ? volantis.dom.header.clientHeight + 16 : 80;\n  }\n\n  fn.setIsMobile = () => {\n    if (document.documentElement.clientWidth < 500) {\n      volantis.isMobile = 1;\n      volantis.isMobileOld = 1;\n    } else {\n      volantis.isMobile = 0;\n      volantis.isMobileOld = 0;\n    }\n  }\n\n  // 校正页面定位（被导航栏挡住的区域）\n  fn.scrolltoElement = (elem, correction = scrollCorrection) => {\n    volantis.scroll.to(elem, {\n      top: elem.getBoundingClientRect().top + document.documentElement.scrollTop - correction\n    })\n  }\n\n  // 滚动事件回调们\n  fn.scrollEventCallBack = () => {\n    // 【移动端 PC】//////////////////////////////////////////////////////////////////////\n\n    // 显示/隐藏 Header导航 topBtn 【移动端 PC】\n    const showHeaderPoint = volantis.dom.bodyAnchor.offsetTop - scrollCorrection;\n    const scrollTop = volantis.scroll.getScrollTop(); // 滚动条距离顶部的距离\n\n    // topBtn\n    if (volantis.dom.topBtn) {\n      if (scrollTop > volantis.dom.bodyAnchor.offsetTop) {\n        volantis.dom.topBtn.addClass('show');\n        // 向上滚动高亮 topBtn\n        if (volantis.scroll.del > 0) {\n          volantis.dom.topBtn.removeClass('hl');\n        } else {\n          volantis.dom.topBtn.addClass('hl');\n        }\n      } else {\n        volantis.dom.topBtn.removeClass('show').removeClass('hl');\n      }\n    }\n\n    // Header导航\n    if (volantis.dom.header) {\n      if (scrollTop - showHeaderPoint > -1) {\n        volantis.dom.header.addClass('show');\n      } else {\n        volantis.dom.header.removeClass('show');\n      }\n    }\n\n    // 决定一二级导航栏的切换 【向上滚动切换为一级导航栏；向下滚动切换为二级导航栏】  【移动端 PC】\n    if (pdata.ispage && volantis.dom.wrapper) {\n      if (volantis.scroll.del > 0 && scrollTop > 100) { // 向下滚动\n        volantis.dom.wrapper.addClass('sub'); // <---- 二级导航显示\n      } else if (volantis.scroll.del < 0) { // 向上滚动\n        volantis.dom.wrapper.removeClass('sub'); // <---- 取消二级导航显示 一级导航显示\n      }\n    }\n\n    // 【移动端】//////////////////////////////////////////////////////////////////////\n    if (volantis.isMobile) {\n      // 【移动端】 页面滚动  隐藏 移动端toc目录按钮\n      if (pdata.ispage && volantis.dom.tocTarget && volantis.dom.toc) {\n        volantis.dom.tocTarget.removeClass('active');\n        volantis.dom.toc.removeClass('active');\n      }\n      // 【移动端】 滚动时隐藏子菜单\n      if (volantis.dom.mPhoneList) {\n        volantis.dom.mPhoneList.forEach(function (e) {\n          volantis.dom.$(e).hide();\n        })\n      }\n    }\n  }\n\n  // 设置滚动锚点\n  fn.setScrollAnchor = () => {\n    // click topBtn 滚动至bodyAnchor 【移动端 PC】\n    if (volantis.dom.topBtn && volantis.dom.bodyAnchor) {\n      volantis.dom.topBtn.click(e => {\n        e.preventDefault();\n        e.stopPropagation();\n        fn.scrolltoElement(volantis.dom.bodyAnchor);\n        e.stopImmediatePropagation();\n      });\n    }\n\n  }\n\n  // 设置导航栏\n  fn.setHeader = () => {\n    // !!! 此处的Dom对象需要重载 !!!\n    if (!pdata.ispage) return;\n\n    // 填充二级导航文章标题 【移动端 PC】\n    volantis.dom.wrapper.find('.nav-sub .title').html(document.title.split(\" - \")[0]);\n\n    // ====== bind events to every btn =========\n    // 评论按钮 【移动端 PC】\n    volantis.dom.comment = volantis.dom.$(document.getElementById(\"s-comment\")); // 评论按钮  桌面端 移动端\n    volantis.dom.commentTarget = volantis.dom.$(document.querySelector('#l_main article#comments')); // 评论区域\n    if (volantis.dom.commentTarget) {\n      volantis.dom.comment.click(e => { // 评论按钮点击后 跳转到评论区域\n        e.preventDefault();\n        e.stopPropagation();\n        volantis.cleanContentVisibility();\n        fn.scrolltoElement(volantis.dom.commentTarget);\n        e.stopImmediatePropagation();\n      });\n    } else volantis.dom.comment.style.display = 'none'; // 关闭了评论，则隐藏评论按钮\n\n    // 移动端toc目录按钮 【移动端】\n    if (volantis.isMobile) {\n      volantis.dom.toc = volantis.dom.$(document.getElementById(\"s-toc\")); // 目录按钮  仅移动端\n      volantis.dom.tocTarget = volantis.dom.$(document.querySelector('#l_side .toc-wrapper')); // 侧边栏的目录列表\n      if (volantis.dom.tocTarget) {\n        // 点击移动端目录按钮 激活目录按钮 显示侧边栏的目录列表\n        volantis.dom.toc.click((e) => {\n          e.stopPropagation();\n          volantis.dom.tocTarget.toggleClass('active');\n          volantis.dom.toc.toggleClass('active');\n        });\n        // 点击空白 隐藏\n        volantis.dom.$(document).click(function (e) {\n          e.stopPropagation();\n          if (volantis.dom.tocTarget) {\n            volantis.dom.tocTarget.removeClass('active');\n          }\n          volantis.dom.toc.removeClass('active');\n        });\n      } else if (volantis.dom.toc) volantis.dom.toc.style.display = 'none'; // 隐藏toc目录按钮\n    }\n  }\n\n  // 设置导航栏菜单选中状态  【移动端 PC】\n  fn.setHeaderMenuSelection = () => {\n    // !!! 此处的Dom对象需要重载 !!!\n    volantis.dom.headerMenu = volantis.dom.$(document.querySelectorAll('#l_header .navigation,#l_cover .navigation,#l_side .navigation')); // 导航列表\n\n    // 先把已经激活的取消激活\n    volantis.dom.headerMenu.forEach(element => {\n      let li = volantis.dom.$(element).find('li a.active')\n      if (li)\n        li.removeClass('active')\n      let div = volantis.dom.$(element).find('div a.active')\n      if (div)\n        div.removeClass('active')\n    });\n\n    // replace '%' '/' '.'\n    var idname = location.pathname.replace(/\\/|%|\\./g, '');\n    if (idname.length == 0) {\n      idname = 'home';\n    }\n    var page = idname.match(/page\\d{0,}$/g);\n    if (page) {\n      page = page[0];\n      idname = idname.split(page)[0];\n    }\n    var index = idname.match(/index.html/);\n    if (index) {\n      index = index[0];\n      idname = idname.split(index)[0];\n    }\n    // 转义字符如 [, ], ~, #, @\n    idname = idname.replace(/(\\[|\\]|~|#|@)/g, '\\\\$1');\n    if (idname && volantis.dom.headerMenu) {\n      volantis.dom.headerMenu.forEach(element => {\n        // idname 不能为数字开头, 加一个 action- 前缀\n        let id = element.querySelector(\"[active-action=action-\" + idname + \"]\")\n        if (id) {\n          volantis.dom.$(id).addClass('active')\n        }\n      });\n    }\n  }\n\n  // 设置全局事件\n  fn.setGlobalHeaderMenuEvent = () => {\n    if (volantis.isMobile) {\n      // 【移动端】 关闭已经展开的子菜单 点击展开子菜单\n      document.querySelectorAll('#l_header .m-phone li').forEach(function (e) {\n        if (e.querySelector(\".list-v\")) {\n          // 点击菜单\n          volantis.dom.$(e).click(function (e) {\n            e.stopPropagation();\n            // 关闭已经展开的子菜单\n            e.currentTarget.parentElement.childNodes.forEach(function (e) {\n              if (Object.prototype.toString.call(e) == '[object HTMLLIElement]') {\n                e.childNodes.forEach(function (e) {\n                  if (Object.prototype.toString.call(e) == '[object HTMLUListElement]') {\n                    volantis.dom.$(e).hide()\n                  }\n                })\n              }\n            })\n            // 点击展开子菜单\n            let array = e.currentTarget.children\n            for (let index = 0; index < array.length; index++) {\n              const element = array[index];\n              if (volantis.dom.$(element).title === 'menu') { // 移动端菜单栏异常\n                volantis.dom.$(element).display = \"flex\"      // https://github.com/volantis-x/hexo-theme-volantis/issues/706\n              } else {\n                volantis.dom.$(element).show()\n              }\n            }\n          }, 0);\n        }\n      })\n    } else {\n      // 【PC端】 hover时展开子菜单，点击时[target.baseURI==origin时]隐藏子菜单? 现有逻辑大部分情况不隐藏子菜单\n      document.querySelectorAll('#wrapper .m-pc li > a[href]').forEach(function (e) {\n        volantis.dom.$(e.parentElement).click(function (e) {\n          e.stopPropagation();\n          if (e.target.origin == e.target.baseURI) {\n            document.querySelectorAll('#wrapper .m-pc .list-v').forEach(function (e) {\n              volantis.dom.$(e).hide(); // 大概率不会执行\n            })\n          }\n        }, 0);\n      })\n    }\n    fn.setPageHeaderMenuEvent();\n  }\n\n  // 【移动端】隐藏子菜单\n  fn.setPageHeaderMenuEvent = () => {\n    if (!volantis.isMobile) return\n    // 【移动端】 点击空白处隐藏子菜单\n    volantis.dom.$(document).click(function (e) {\n      volantis.dom.mPhoneList.forEach(function (e) {\n        volantis.dom.$(e).hide();\n      })\n    });\n  }\n\n  // 设置导航栏搜索框 【移动端】\n  fn.setHeaderSearch = () => {\n    if (!volantis.isMobile) return;\n    if (!volantis.dom.switcher) return;\n    // 点击移动端搜索按钮\n    volantis.dom.switcher.click(function (e) {\n      e.stopPropagation();\n      volantis.dom.header.toggleClass('z_search-open'); // 激活移动端搜索框\n      volantis.dom.switcher.toggleClass('active'); // 移动端搜索按钮\n    });\n    // 点击空白取消激活\n    volantis.dom.$(document).click(function (e) {\n      volantis.dom.header.removeClass('z_search-open');\n      volantis.dom.switcher.removeClass('active');\n    });\n    // 移动端点击搜索框 停止事件传播\n    volantis.dom.search.click(function (e) {\n      e.stopPropagation();\n    });\n  }\n\n  // 设置 tabs 标签  【移动端 PC】\n  fn.setTabs = () => {\n    let tabs = document.querySelectorAll('#l_main .tabs .nav-tabs')\n    if (!tabs) return\n    tabs.forEach(function (e) {\n      e.querySelectorAll('a').forEach(function (e) {\n        volantis.dom.$(e).on('click', (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          const $tab = volantis.dom.$(e.target.parentElement.parentElement.parentElement);\n          $tab.find('.nav-tabs .active').removeClass('active');\n          volantis.dom.$(e.target.parentElement).addClass('active');\n          $tab.find('.tab-content .active').removeClass('active');\n          $tab.find(e.target.className).addClass('active');\n          return false;\n        });\n      })\n    })\n  }\n\n  // hexo-reference 页脚跳转 https://github.com/volantis-x/hexo-theme-volantis/issues/647\n  fn.footnotes = () => {\n    let ref = document.querySelectorAll('#l_main .footnote-backref, #l_main .footnote-ref > a');\n    ref.forEach(function (e, i) {\n      ref[i].click = () => { }; // 强制清空原 click 事件\n      volantis.dom.$(e).on('click', (e) => {\n        e.stopPropagation();\n        e.preventDefault();\n        let targetID = decodeURI(e.target.hash.split('#')[1]).replace(/\\ /g, '-');\n        let target = document.getElementById(targetID);\n        if (target) {\n          volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant' })\n        }\n      });\n    })\n  }\n\n  // 工具类：代码块复制\n  fn.utilCopyCode = (Selector) => {\n    document.querySelectorAll(Selector).forEach(node => {\n      const test = node.insertAdjacentHTML(\"beforebegin\", COPYHTML);\n      const _BtnCopy = node.previousSibling;\n      _BtnCopy.onclick = e => {\n        e.stopPropagation();\n        const _icon = _BtnCopy.querySelector('i');\n        const _span = _BtnCopy.querySelector('span');\n\n        node.focus();\n        const range = new Range();\n        range.selectNodeContents(node);\n        document.getSelection().removeAllRanges();\n        document.getSelection().addRange(range);\n\n        const str = document.getSelection().toString();\n        fn.utilWriteClipText(str).then(() => {\n          fn.messageCopyright();\n          _BtnCopy.classList.add('copied');\n          _icon.classList.remove('fa-copy');\n          _icon.classList.add('fa-check-circle');\n          _span.innerText = \"COPIED\";\n          setTimeout(() => {\n            _icon.classList.remove('fa-check-circle');\n            _icon.classList.add('fa-copy');\n            _span.innerText = \"COPY\";\n          }, 2000)\n        }).catch(e => {\n          VolantisApp.message('系统提示', e, {\n            icon: 'fa fa-exclamation-circle red'\n          });\n          _BtnCopy.classList.add('copied-failed');\n          _icon.classList.remove('fa-copy');\n          _icon.classList.add('fa-exclamation-circle');\n          _span.innerText = \"COPY FAILED\";\n          setTimeout(() => {\n            _icon.classList.remove('fa-exclamation-circle');\n            _icon.classList.add('fa-copy');\n            _span.innerText = \"COPY\";\n          })\n        })\n      }\n    });\n  }\n\n  // 工具类：复制字符串到剪切板\n  fn.utilWriteClipText = (str) => {\n    return navigator.clipboard\n      .writeText(str)\n      .then(() => {\n        return Promise.resolve()\n      })\n      .catch(e => {\n        const input = document.createElement('textarea');\n        input.setAttribute('readonly', 'readonly');\n        document.body.appendChild(input);\n        input.innerHTML = str;\n        input.select();\n        try {\n          let result = document.execCommand('copy')\n          document.body.removeChild(input);\n          if (!result || result === 'unsuccessful') {\n            return Promise.reject('复制文本失败!')\n          } else {\n            return Promise.resolve()\n          }\n        } catch (e) {\n          document.body.removeChild(input);\n          return Promise.reject(\n            '当前浏览器不支持复制功能，请检查更新或更换其他浏览器操作!'\n          )\n        }\n      })\n  }\n\n  // 工具类：返回时间间隔\n  fn.utilTimeAgo = (dateTimeStamp) => {\n    const minute = 1e3 * 60, hour = minute * 60, day = hour * 24, week = day * 7, month = day * 30;\n    const now = new Date().getTime();\n    const diffValue = now - dateTimeStamp;\n    const minC = diffValue / minute,\n      hourC = diffValue / hour,\n      dayC = diffValue / day,\n      weekC = diffValue / week,\n      monthC = diffValue / month;\n    if (diffValue < 0) {\n      result = \"\"\n    } else if (monthC >= 1 && monthC < 7) {\n      result = \" \" + parseInt(monthC) + \" 月前\"\n    } else if (weekC >= 1 && weekC < 4) {\n      result = \" \" + parseInt(weekC) + \" 周前\"\n    } else if (dayC >= 1 && dayC < 7) {\n      result = \" \" + parseInt(dayC) + \" 天前\"\n    } else if (hourC >= 1 && hourC < 24) {\n      result = \" \" + parseInt(hourC) + \" 小时前\"\n    } else if (minC >= 1 && minC < 60) {\n      result = \" \" + parseInt(minC) + \" 分钟前\"\n    } else if (diffValue >= 0 && diffValue <= minute) {\n      result = \"刚刚\"\n    } else {\n      const datetime = new Date();\n      datetime.setTime(dateTimeStamp);\n      const Nyear = datetime.getFullYear();\n      const Nmonth = datetime.getMonth() + 1 < 10 ? \"0\" + (datetime.getMonth() + 1) : datetime.getMonth() + 1;\n      const Ndate = datetime.getDate() < 10 ? \"0\" + datetime.getDate() : datetime.getDate();\n      const Nhour = datetime.getHours() < 10 ? \"0\" + datetime.getHours() : datetime.getHours();\n      const Nminute = datetime.getMinutes() < 10 ? \"0\" + datetime.getMinutes() : datetime.getMinutes();\n      const Nsecond = datetime.getSeconds() < 10 ? \"0\" + datetime.getSeconds() : datetime.getSeconds();\n      result = Nyear + \"-\" + Nmonth + \"-\" + Ndate\n    }\n    return result;\n  }\n\n  // 消息提示：标准\n  fn.message = (title, message, option = {}, done = null) => {\n    if (typeof iziToast === \"undefined\") {\n      volantis.css(volantis.GLOBAL_CONFIG.cdn.izitoast_css)\n      volantis.js(volantis.GLOBAL_CONFIG.cdn.izitoast_js, () => {\n        tozashMessage(title, message, option, done);\n      });\n    } else {\n      tozashMessage(title, message, option, done);\n    }\n    function tozashMessage(title, message, option, done) {\n      const {\n        icon,\n        time,\n        position,\n        transitionIn,\n        transitionOut,\n        messageColor,\n        titleColor,\n        backgroundColor,\n        zindex,\n        displayMode\n      } = option;\n      iziToast.show({\n        layout: '2',\n        icon: 'Fontawesome',\n        closeOnEscape: 'true',\n        displayMode: displayMode || 'replace',\n        transitionIn: transitionIn || volantis.GLOBAL_CONFIG.plugins.message.transitionIn,\n        transitionOut: transitionOut || volantis.GLOBAL_CONFIG.plugins.message.transitionOut,\n        messageColor: messageColor || volantis.GLOBAL_CONFIG.plugins.message.messageColor,\n        titleColor: titleColor || volantis.GLOBAL_CONFIG.plugins.message.titleColor,\n        backgroundColor: backgroundColor || volantis.GLOBAL_CONFIG.plugins.message.backgroundColor,\n        zindex: zindex || volantis.GLOBAL_CONFIG.plugins.message.zindex,\n        icon: icon || volantis.GLOBAL_CONFIG.plugins.message.icon.default,\n        timeout: time || volantis.GLOBAL_CONFIG.plugins.message.time.default,\n        position: position || volantis.GLOBAL_CONFIG.plugins.message.position,\n        title: title,\n        message: message,\n        onClosed: () => {\n          if (done) done();\n        },\n      });\n    }\n  }\n\n  // 消息提示：询问\n  fn.question = (title, message, option = {}, success = null, cancel = null, done = null) => {\n    if (typeof iziToast === \"undefined\") {\n      volantis.css(volantis.GLOBAL_CONFIG.cdn.izitoast_css)\n      volantis.js(volantis.GLOBAL_CONFIG.cdn.izitoast_js, () => {\n        tozashQuestion(title, message, option, success, cancel, done);\n      });\n    } else {\n      tozashQuestion(title, message, option, success, cancel, done);\n    }\n\n    function tozashQuestion(title, message, option, success, cancel, done) {\n      const {\n        icon,\n        time,\n        position,\n        transitionIn,\n        transitionOut,\n        messageColor,\n        titleColor,\n        backgroundColor,\n        zindex\n      } = option;\n      iziToast.question({\n        id: 'question',\n        icon: 'Fontawesome',\n        close: false,\n        overlay: true,\n        displayMode: 'once',\n        position: 'center',\n        messageColor: messageColor || volantis.GLOBAL_CONFIG.plugins.message.messageColor,\n        titleColor: titleColor || volantis.GLOBAL_CONFIG.plugins.message.titleColor,\n        backgroundColor: backgroundColor || volantis.GLOBAL_CONFIG.plugins.message.backgroundColor,\n        zindex: zindex || volantis.GLOBAL_CONFIG.plugins.message.zindex,\n        icon: icon || volantis.GLOBAL_CONFIG.plugins.message.icon.quection,\n        timeout: time || volantis.GLOBAL_CONFIG.plugins.message.time.quection,\n        title: title,\n        message: message,\n        buttons: [\n          ['<button><b>是</b></button>', (instance, toast) => {\n            instance.hide({ transitionOut: transitionOut || 'fadeOut' }, toast, 'button');\n            if (success) success(instance, toast)\n          }],\n          ['<button><b>否</b></button>', (instance, toast) => {\n            instance.hide({ transitionOut: transitionOut || 'fadeOut' }, toast, 'button');\n            if (cancel) cancel(instance, toast)\n          }]\n        ],\n        onClosed: (instance, toast, closedBy) => {\n          if (done) done(instance, toast, closedBy);\n        }\n      });\n    }\n  }\n\n  // 消息提示：隐藏\n  fn.hideMessage = (done = null) => {\n    const toast = document.querySelector('.iziToast');\n    if (!toast) {\n      if (done) done()\n      return;\n    }\n\n    if (typeof iziToast === \"undefined\") {\n      volantis.css(volantis.GLOBAL_CONFIG.cdn.izitoast_css)\n      volantis.js(volantis.GLOBAL_CONFIG.cdn.izitoast_js, () => {\n        hideMessage(done);\n      });\n    } else {\n      hideMessage(done);\n    }\n\n    function hideMessage(done) {\n      iziToast.hide({}, toast);\n      if (done) done();\n    }\n  }\n\n  // 消息提示：复制\n  let messageCopyrightShow = 0;\n  fn.messageCopyright = () => {\n    // 消息提示 复制时弹出\n    if (volantis.GLOBAL_CONFIG.plugins.message.enable\n      && volantis.GLOBAL_CONFIG.plugins.message.copyright.enable\n      && messageCopyrightShow < 1) {\n      messageCopyrightShow++;\n      VolantisApp.message(volantis.GLOBAL_CONFIG.plugins.message.copyright.title,\n        volantis.GLOBAL_CONFIG.plugins.message.copyright.message, {\n        icon: volantis.GLOBAL_CONFIG.plugins.message.copyright.icon,\n        transitionIn: 'flipInX',\n        transitionOut: 'flipOutX',\n        displayMode: 1\n      });\n    }\n  }\n\n  return {\n    init: () => {\n      fn.init();\n      fn.event();\n    },\n    subscribe: () => {\n      fn.setIsMobile();\n      fn.setHeader();\n      fn.setHeaderMenuSelection();\n      fn.setGlobalHeaderMenuEvent();\n      fn.setHeaderSearch();\n      fn.setScrollAnchor();\n      fn.setTabs();\n      fn.footnotes();\n    },\n    utilCopyCode: fn.utilCopyCode,\n    utilWriteClipText: fn.utilWriteClipText,\n    utilTimeAgo: fn.utilTimeAgo,\n    message: fn.message,\n    question: fn.question,\n    hideMessage: fn.hideMessage,\n    messageCopyright: fn.messageCopyright,\n    scrolltoElement: fn.scrolltoElement\n  }\n})()\nObject.freeze(VolantisApp);\n\n/* FancyBox */\nconst VolantisFancyBox = (() => {\n  const fn = {};\n\n  fn.loadFancyBox = (done) => {\n    volantis.css(volantis.GLOBAL_CONFIG.cdn.fancybox_css);\n    volantis.js(volantis.GLOBAL_CONFIG.cdn.fancybox_js).then(() => {\n      if (done) done();\n    })\n  }\n\n  /**\n   * 加载及处理\n   * \n   * @param {*} checkMain 是否只处理文章区域的文章\n   * @param {*} done      FancyBox 加载完成后的动作，默认执行分组绑定\n   * @returns \n   */\n  fn.init = (checkMain = true, done = fn.groupBind) => {\n    if (!document.querySelector(\".md .gallery img, .fancybox\") && checkMain) return;\n    if (typeof Fancybox === \"undefined\") {\n      fn.loadFancyBox(done);\n    } else {\n      done();\n    }\n  }\n\n  /**\n   * 图片元素预处理\n   * \n   * @param {*} selectors 选择器\n   * @param {*} name      分组\n   */\n  fn.elementHandling = (selectors, name) => {\n    const nodeList = document.querySelectorAll(selectors);\n    nodeList.forEach($item => {\n      if ($item.hasAttribute('fancybox')) return;\n      $item.setAttribute('fancybox', '');\n      const $link = document.createElement('a');\n      $link.setAttribute('href', $item.src);\n      $link.setAttribute('data-caption', $item.alt);\n      $link.setAttribute('data-fancybox', name);\n      $link.classList.add('fancybox');\n      $link.append($item.cloneNode());\n      $item.replaceWith($link);\n    })\n  }\n\n  /**\n   * 原生绑定\n   * \n   * @param {*} selectors 选择器\n   */\n  fn.bind = (selectors) => {\n    fn.init(false, () => {\n      Fancybox.bind(selectors, {\n        groupAll: true,\n        Hash: false,\n        hideScrollbar: false,\n        Thumbs: {\n          autoStart: false,\n        },\n        caption: function (fancybox, carousel, slide) {\n          return slide.$trigger.alt || null\n        }\n      });\n    });\n  }\n\n  /**\n   * 分组绑定\n   * \n   * @param {*} groupName 分组名称\n   */\n  fn.groupBind = (groupName = null) => {\n    const group = new Set();\n\n    document.querySelectorAll(\".gallery\").forEach(ele => {\n      if (ele.querySelector(\"img\")) {\n        group.add(ele.getAttribute('data-group') || 'default');\n      }\n    })\n\n    if (!!groupName) group.add(groupName);\n\n    for (const iterator of group) {\n      Fancybox.unbind('[data-fancybox=\"' + iterator + '\"]');\n      Fancybox.bind('[data-fancybox=\"' + iterator + '\"]', {\n        Hash: false,\n        hideScrollbar: false,\n        Thumbs: {\n          autoStart: false,\n        }\n      });\n    }\n  }\n\n  return {\n    init: fn.init,\n    bind: fn.bind,\n    groupBind: (selectors, groupName = 'default') => {\n      try {\n        fn.elementHandling(selectors, groupName);\n        fn.init(false, () => {\n          fn.groupBind(groupName)\n        });\n      } catch (error) {\n        console.error(error)\n      }\n    }\n  }\n})()\nObject.freeze(VolantisFancyBox);\n\n// highlightKeyWords 与 搜索功能搭配 https://github.com/next-theme/hexo-theme-next/blob/eb194a7258058302baf59f02d4b80b6655338b01/source/js/third-party/search/local-search.js\n// Question: 锚点稳定性未知\n// ToDo: 查找模式\n// 0. (/////////要知道浏览器自带全页面查找功能 CTRL + F)\n// 1. 右键开启查找模式 / 导航栏菜单开启?? / CTRL + F ???\n// 2. 查找模式面板 (可拖动? or 固定?)\n// 3. keyword mark id 从 0 开始编号 查找下一处 highlightKeyWords.scrollToNextHighlightKeywordMark() 查找上一处 scrollToPrevHighlightKeywordMark() 循环查找(取模%)\n// 4. 可输入修改 查找关键词 keywords(type:list)\n// 5. 区分大小写 caseSensitive (/ 全字匹配?? / 正则匹配??)\n// 6. 在选定区域中查找 querySelector ??\n// 7. 关闭查找模式\n// 8. 搜索跳转 (URL 入口) 自动开启查找模式 调用 scrollToNextHighlightKeywordMark()\nconst highlightKeyWords = (() => {\n  let fn = {}\n  fn.markNum = 0\n  fn.markNextId = -1\n  fn.startFromURL = () => {\n    const params = decodeURI(new URL(location.href).searchParams.get('keyword'));\n    const keywords = params ? params.split(' ') : [];\n    const post = document.querySelector('#l_main');\n    if (keywords.length == 1 && keywords[0] == \"null\") {\n      return;\n    }\n    fn.start(keywords, post); // 渲染耗时较长\n    fn.scrollToFirstHighlightKeywordMark()\n  }\n  fn.scrollToFirstHighlightKeywordMark = () => {\n    volantis.cleanContentVisibility();\n    let target = fn.scrollToNextHighlightKeywordMark(\"0\");\n    if (!target) {\n      volantis.requestAnimationFrame(fn.scrollToFirstHighlightKeywordMark)\n    }\n  }\n  fn.scrollToNextHighlightKeywordMark = (id) => {\n    // Next Id\n    let input = id || (fn.markNextId + 1) % fn.markNum;\n    fn.markNextId = parseInt(input)\n    let target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    if (!target) {\n      fn.markNextId = (fn.markNextId + 1) % fn.markNum;\n      target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    }\n    if (target) {\n      volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant' })\n    }\n    // Current target\n    return target\n  }\n  fn.scrollToPrevHighlightKeywordMark = (id) => {\n    // Prev Id\n    let input = id || (fn.markNextId - 1 + fn.markNum) % fn.markNum;\n    fn.markNextId = parseInt(input)\n    let target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    if (!target) {\n      fn.markNextId = (fn.markNextId - 1 + fn.markNum) % fn.markNum;\n      target = document.getElementById(\"keyword-mark-\" + fn.markNextId);\n    }\n    if (target) {\n      volantis.scroll.to(target, { addTop: - volantis.dom.header.offsetHeight - 5, behavior: 'instant' })\n    }\n    // Current target\n    return target\n  }\n  fn.start = (keywords, querySelector) => {\n    fn.markNum = 0\n    if (!keywords.length || !querySelector || (keywords.length == 1 && keywords[0] == \"null\")) return;\n    console.log(keywords);\n    const walk = document.createTreeWalker(querySelector, NodeFilter.SHOW_TEXT, null);\n    const allNodes = [];\n    while (walk.nextNode()) {\n      if (!walk.currentNode.parentNode.matches('button, select, textarea')) allNodes.push(walk.currentNode);\n    }\n    allNodes.forEach(node => {\n      const [indexOfNode] = fn.getIndexByWord(keywords, node.nodeValue);\n      if (!indexOfNode.length) return;\n      const slice = fn.mergeIntoSlice(0, node.nodeValue.length, indexOfNode);\n      fn.highlightText(node, slice, 'keyword');\n      fn.highlightStyle()\n    });\n  }\n  fn.getIndexByWord = (words, text, caseSensitive = false) => {\n    const index = [];\n    const included = new Set();\n    words.forEach(word => {\n      const div = document.createElement('div');\n      div.innerText = word;\n      word = div.innerHTML;\n\n      const wordLen = word.length;\n      if (wordLen === 0) return;\n      let startPosition = 0;\n      let position = -1;\n      if (!caseSensitive) {\n        text = text.toLowerCase();\n        word = word.toLowerCase();\n      }\n      while ((position = text.indexOf(word, startPosition)) > -1) {\n        index.push({ position, word });\n        included.add(word);\n        startPosition = position + wordLen;\n      }\n    });\n    index.sort((left, right) => {\n      if (left.position !== right.position) {\n        return left.position - right.position;\n      }\n      return right.word.length - left.word.length;\n    });\n    return [index, included];\n  };\n  fn.mergeIntoSlice = (start, end, index) => {\n    let item = index[0];\n    let { position, word } = item;\n    const hits = [];\n    const count = new Set();\n    while (position + word.length <= end && index.length !== 0) {\n      count.add(word);\n      hits.push({\n        position,\n        length: word.length\n      });\n      const wordEnd = position + word.length;\n\n      index.shift();\n      while (index.length !== 0) {\n        item = index[0];\n        position = item.position;\n        word = item.word;\n        if (wordEnd > position) {\n          index.shift();\n        } else {\n          break;\n        }\n      }\n    }\n    return {\n      hits,\n      start,\n      end,\n      count: count.size\n    };\n  };\n  fn.highlightText = (node, slice, className) => {\n    const val = node.nodeValue;\n    let index = slice.start;\n    const children = [];\n    for (const { position, length } of slice.hits) {\n      const text = document.createTextNode(val.substring(index, position));\n      index = position + length;\n      let mark = document.createElement('mark');\n      mark.className = className;\n      mark = fn.highlightStyle(mark)\n      mark.appendChild(document.createTextNode(val.substr(position, length)));\n      children.push(text, mark);\n    }\n    node.nodeValue = val.substring(index, slice.end);\n    children.forEach(element => {\n      node.parentNode.insertBefore(element, node);\n    });\n  }\n  fn.highlightStyle = (mark) => {\n    if (!mark) return;\n    mark.id = \"keyword-mark-\" + fn.markNum;\n    fn.markNum++;\n    mark.style.background = \"transparent\";\n    mark.style[\"border-bottom\"] = \"1px dashed #ff2a2a\";\n    mark.style[\"color\"] = \"#ff2a2a\";\n    mark.style[\"font-weight\"] = \"bold\";\n    return mark\n  }\n  fn.cleanHighlightStyle = () => {\n    document.querySelectorAll(\".keyword\").forEach(mark => {\n      mark.style.background = \"transparent\";\n      mark.style[\"border-bottom\"] = null;\n      mark.style[\"color\"] = null;\n      mark.style[\"font-weight\"] = null;\n    })\n  }\n  return {\n    start: (keywords, querySelector) => {\n      fn.start(keywords, querySelector)\n    },\n    startFromURL: () => {\n      fn.startFromURL()\n    },\n    scrollToNextHighlightKeywordMark: (id) => {\n      fn.scrollToNextHighlightKeywordMark(id)\n    },\n    scrollToPrevHighlightKeywordMark: (id) => {\n      fn.scrollToPrevHighlightKeywordMark(id)\n    },\n    cleanHighlightStyle: () => {\n      fn.cleanHighlightStyle()\n    },\n  }\n})()\nObject.freeze(highlightKeyWords);\n\n/* DOM 控制 */\nconst DOMController = {\n  /**\n   * 控制元素显隐\n   */\n  visible: (ele, type = true) => {\n    if (ele) ele.style.display = type === true ? 'block' : 'none';\n  },\n\n  /**\n   * 移除元素\n   */\n  remove: (param) => {\n    const node = document.querySelectorAll(param);\n    node.forEach(ele => {\n      ele.remove();\n    })\n  },\n\n  removeList: (list) => {\n    list.forEach(param => {\n      DOMController.remove(param)\n    })\n  },\n\n  /**\n   * 设置属性\n   */\n  setAttribute: (param, attrName, attrValue) => {\n    const node = document.querySelectorAll(param);\n    node.forEach(ele => {\n      ele.setAttribute(attrName, attrValue)\n    })\n  },\n\n  setAttributeList: (list) => {\n    list.forEach(item => {\n      DOMController.setAttribute(item[0], item[1], item[2])\n    })\n  },\n\n  /**\n   * 设置样式\n   */\n  setStyle: (param, styleName, styleValue) => {\n    const node = document.querySelectorAll(param);\n    node.forEach(ele => {\n      ele.style[styleName] = styleValue;\n    })\n  },\n\n  setStyleList: (list) => {\n    list.forEach(item => {\n      DOMController.setStyle(item[0], item[1], item[2])\n    })\n  },\n\n  fadeIn: (e) => {\n    if (!e) return;\n    e.style.visibility = \"visible\";\n    e.style.opacity = 1;\n    e.style.display = \"block\";\n    e.style.transition = \"all 0.5s linear\";\n    return e\n  },\n\n  fadeOut: (e) => {\n    if (!e) return;\n    e.style.visibility = \"hidden\";\n    e.style.opacity = 0;\n    e.style.display = \"none\";\n    e.style.transition = \"all 0.5s linear\";\n    return e\n  },\n\n  fadeToggle: (e) => {\n    if (!e) return;\n    if (e.style.visibility == \"hidden\") {\n      e = DOMController.fadeIn(e)\n    } else {\n      e = DOMController.fadeOut(e)\n    }\n    return e\n  },\n\n  fadeToggleList: (list) => {\n    list.forEach(param => {\n      DOMController.fadeToggle(param)\n    })\n  },\n\n  hasClass: (e, c) => {\n    if (!e) return;\n    return e.className.match(new RegExp('(\\\\s|^)' + c + '(\\\\s|$)'));\n  },\n\n  addClass: (e, c) => {\n    if (!e) return;\n    e.classList.add(c);\n    return e\n  },\n\n  removeClass: (e, c) => {\n    if (!e) return;\n    e.classList.remove(c);\n    return e\n  },\n\n  toggleClass: (e, c) => {\n    if (!e) return;\n    if (DOMController.hasClass(e, c)) {\n      DOMController.removeClass(e, c)\n    } else {\n      DOMController.addClass(e, c)\n    }\n    return e\n  },\n\n  toggleClassList: (list) => {\n    list.forEach(item => {\n      DOMController.toggleClass(item[0], item[1])\n    })\n  }\n}\nObject.freeze(DOMController);\n\nconst VolantisRequest = {\n  timeoutFetch: (url, ms, requestInit) => {\n    const controller = new AbortController()\n    requestInit.signal?.addEventListener('abort', () => controller.abort())\n    let promise = fetch(url, { ...requestInit, signal: controller.signal })\n    if (ms > 0) {\n      const timer = setTimeout(() => controller.abort(), ms)\n      promise.finally(() => { clearTimeout(timer) })\n    }\n    promise = promise.catch((err) => {\n      throw ((err || {}).name === 'AbortError') ? new Error(`Fetch timeout: ${url}`) : err\n    })\n    return promise\n  },\n\n  Fetch: async (url, requestInit, timeout = 15000) => {\n    const resp = await VolantisRequest.timeoutFetch(url, timeout, requestInit);\n    if (!resp.ok) throw new Error(`Fetch error: ${url} | ${resp.status}`);\n    let json = await resp.json()\n    if (!json.success) throw json\n    return json\n  },\n\n  POST: async (url, data) => {\n    const requestInit = {\n      method: 'POST',\n    }\n    if (data) {\n      const formData = new FormData();\n      Object.keys(data).forEach(key => formData.append(key, String(data[key])))\n      requestInit.body = formData;\n    }\n    const json = await VolantisRequest.Fetch(url, requestInit)\n    return json.data;\n  },\n\n  Get: async (url, data) => {\n    const json = await VolantisRequest.Fetch(url + (data ? (`?${new URLSearchParams(data)}`) : ''), {\n      method: 'GET'\n    })\n  }\n}\nObject.freeze(VolantisRequest);\n","date":"2022-12-27T15:15:09.550Z","updated":"2022-12-27T15:15:09.550Z","path":"js/app.js","layout":"false","title":"","comments":1,"_id":"clc6k3sf400036cu99ozi3a1p"},{"_content":"#safearea{\n  display: block\n}\n\n@import '_defines/*'\n\n// Project\n@import '_style'\n\n// Custom Files\nfor $injects_style in hexo-config('injects.style')\n  @import $injects_style;\n\n","source":"css/style.styl","raw":"#safearea{\n  display: block\n}\n\n@import '_defines/*'\n\n// Project\n@import '_style'\n\n// Custom Files\nfor $injects_style in hexo-config('injects.style')\n  @import $injects_style;\n\n","date":"2022-12-27T15:15:09.549Z","updated":"2022-12-27T15:15:09.549Z","path":"css/style.css","layout":"false","title":"","comments":1,"_id":"clc6k3sf400046cu980pz3p9b"},{"_content":"let Parallax = {};\nParallax.options = {};\nParallax.options.speed = 0.25;\nParallax.options.zIndex = -100;\nParallax.options.fade = 1500;\nParallax.slidein = () => {\n  let slider = Parallax.mirrors[0].slider;\n  if (Parallax.mirrors.length >= 2) {\n    slider = Parallax.mirrors[1].slider;\n  }\n  var opac = parseFloat(slider.style.opacity);\n  if (opac !== 1) {\n    if (Parallax.mirrors.length >= 2) {\n      opac = opac + 0.1;\n      slider.style.opacity = opac;\n      setTimeout(Parallax.slidein, Parallax.options.fade / 10);\n    }else{\n      slider.style.opacity = 1;\n    }\n  } else {\n    if (Parallax.mirrors.length >= 2) {\n      Parallax.mirrors[0].mirror.remove();\n      Parallax.mirrors.shift();\n    }\n  }\n};\nParallax.start = () => {\n  let mirror = document.createElement(\"div\");\n  mirror.classList.add(\"parallax-mirror\");\n  mirror.style.visibility = \"hidden\";\n  mirror.style.zIndex = Parallax.options.zIndex;\n  mirror.style.position = \"fixed\";\n  mirror.style.top = 0;\n  mirror.style.left = 0;\n  mirror.style.overflow = \"hidden\";\n  Parallax.window.appendChild(mirror);\n  let slider = document.createElement(\"img\");\n  slider.src = Parallax.options.src;\n  slider.alt = \"parallax\";\n  slider.classList.add(\"parallax-slider\");\n  slider.style.opacity = 0;\n  mirror.appendChild(slider);\n  if (!Parallax.mirrors) {\n    Parallax.mirrors = [];\n  }\n  let mirrorItem = {};\n  mirrorItem.mirror = mirror;\n  mirrorItem.slider = slider;\n  Parallax.mirrors.push(mirrorItem);\n  Parallax.slidein();\n  slider.addEventListener(\n    \"load\",\n    function () {\n      Parallax.update();\n    },\n    false\n  );\n};\nParallax.init = () => {\n  function loadDimensions() {\n    Parallax.wH = document.documentElement.clientHeight;\n    Parallax.wW = document.documentElement.clientWidth;\n  }\n  function getScrollTop() {\n    var scrollPos;\n    if (window.pageYOffset) {\n      scrollPos = window.pageYOffset;\n    } else if (document.compatMode && document.compatMode != \"BackCompat\") {\n      scrollPos = document.documentElement.scrollTop;\n    } else if (document.body) {\n      scrollPos = document.body.scrollTop;\n    }\n    return scrollPos;\n  }\n  function loadScrollPosition() {\n    const winScrollTop = getScrollTop();\n    Parallax.sT = Math.max(0, winScrollTop);\n    Parallax.sL = Math.max(0, document.body.scrollLeft);\n    Parallax.overScroll = Math.min(winScrollTop, 0);\n  }\n  window.addEventListener(\n    \"resize\",\n    function () {\n      loadDimensions();\n      Parallax.update();\n    },\n    false\n  );\n  loadDimensions();\n  let lastPosition = -1;\n  (function loop() {\n    const yoffset = getScrollTop();\n    if (lastPosition !== yoffset) {\n      lastPosition = yoffset;\n      loadScrollPosition();\n      Parallax.update();\n    }\n    window.requestAnimationFrame =\n      window.requestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.webkitRequestAnimationFrame;\n    window.requestAnimationFrame(loop);\n  })();\n};\n\nParallax.refreshItem = (slider) => {\n  Parallax.options.aspectRatio =\n    slider.naturalWidth / (slider.naturalHeight || 1);\n  const aspect = Parallax.options.aspectRatio || 1;\n  Parallax.options.boxWidth = Parallax.window.clientWidth;\n  Parallax.options.boxHeight = Parallax.window.clientHeight;\n  Parallax.options.boxOffsetTop = Parallax.window.scrollTop;\n  Parallax.options.boxOffsetLeft = Parallax.window.scrollLeft;\n  Parallax.options.boxOffsetBottom =\n    Parallax.options.boxOffsetTop + Parallax.options.boxHeight;\n  const winHeight = Parallax.wH;\n  const maxOffset = Parallax.options.boxOffsetTop;\n  const minOffset = Math.max(\n    Parallax.options.boxOffsetTop + Parallax.options.boxHeight - winHeight,\n    0\n  );\n  const imageHeightMin =\n    (Parallax.options.boxHeight +\n      (maxOffset - minOffset) * (1 - Parallax.options.speed)) |\n    0;\n  const imageOffsetMin =\n    ((Parallax.options.boxOffsetTop - maxOffset) *\n      (1 - Parallax.options.speed)) |\n    0;\n  let margin;\n  if (Parallax.options.boxWidth < imageHeightMin * aspect) {\n    Parallax.options.imageWidth = (imageHeightMin * aspect) | 0;\n    Parallax.options.imageHeight = imageHeightMin;\n    Parallax.options.offsetBaseTop = imageOffsetMin;\n    margin = Parallax.options.imageWidth - Parallax.options.boxWidth;\n    Parallax.options.offsetLeft = (-margin / 2) | 0;\n  } else {\n    Parallax.options.imageWidth = Parallax.options.boxWidth;\n    Parallax.options.imageHeight = (Parallax.options.boxWidth / aspect) | 0;\n    Parallax.options.offsetLeft = 0;\n    margin = Parallax.options.imageHeight - imageHeightMin;\n    Parallax.options.offsetBaseTop = (imageOffsetMin - margin / 2) | 0;\n  }\n};\nParallax.renderItem = (mirror, slider) => {\n  const scrollTop = Parallax.sT;\n  const scrollLeft = Parallax.sL;\n  const scrollBottom = scrollTop + Parallax.wH;\n  if (\n    Parallax.options.boxOffsetBottom > scrollTop &&\n    Parallax.options.boxOffsetTop <= scrollBottom\n  ) {\n    Parallax.options.visibility = \"visible\";\n    Parallax.options.mirrorTop = Parallax.options.boxOffsetTop - scrollTop;\n    Parallax.options.mirrorLeft = Parallax.options.boxOffsetLeft - scrollLeft;\n    Parallax.options.offsetTop =\n      Parallax.options.offsetBaseTop -\n      Parallax.options.mirrorTop * (1 - Parallax.options.speed);\n  } else {\n    Parallax.options.visibility = \"hidden\";\n  }\n  mirror.style.transform =\n    \"translate3d(\" +\n    Parallax.options.mirrorLeft +\n    \"px, \" +\n    Parallax.options.mirrorTop +\n    \"px, 0px)\";\n  mirror.style.visibility = Parallax.options.visibility;\n  mirror.style.height = Parallax.options.boxHeight + \"px\";\n  mirror.style.width = Parallax.options.boxWidth + \"px\";\n\n  slider.style.transform =\n    \"translate3d(\" +\n    Parallax.options.offsetLeft +\n    \"px, \" +\n    Parallax.options.offsetTop +\n    \"px, 0px)\";\n  slider.style.position = \"absolute\";\n  slider.style.height = Parallax.options.imageHeight + \"px\";\n  slider.style.width = Parallax.options.imageWidth + \"px\";\n  slider.style.maxWidth = \"none\";\n};\nParallax.update = () => {\n  if (!Parallax.mirrors) {\n    return\n  }\n  Parallax.mirrors.forEach((e) => {\n    Parallax.refreshItem(e.slider);\n    Parallax.renderItem(e.mirror, e.slider);\n  });\n};\n","source":"js/plugins/parallax.js","raw":"let Parallax = {};\nParallax.options = {};\nParallax.options.speed = 0.25;\nParallax.options.zIndex = -100;\nParallax.options.fade = 1500;\nParallax.slidein = () => {\n  let slider = Parallax.mirrors[0].slider;\n  if (Parallax.mirrors.length >= 2) {\n    slider = Parallax.mirrors[1].slider;\n  }\n  var opac = parseFloat(slider.style.opacity);\n  if (opac !== 1) {\n    if (Parallax.mirrors.length >= 2) {\n      opac = opac + 0.1;\n      slider.style.opacity = opac;\n      setTimeout(Parallax.slidein, Parallax.options.fade / 10);\n    }else{\n      slider.style.opacity = 1;\n    }\n  } else {\n    if (Parallax.mirrors.length >= 2) {\n      Parallax.mirrors[0].mirror.remove();\n      Parallax.mirrors.shift();\n    }\n  }\n};\nParallax.start = () => {\n  let mirror = document.createElement(\"div\");\n  mirror.classList.add(\"parallax-mirror\");\n  mirror.style.visibility = \"hidden\";\n  mirror.style.zIndex = Parallax.options.zIndex;\n  mirror.style.position = \"fixed\";\n  mirror.style.top = 0;\n  mirror.style.left = 0;\n  mirror.style.overflow = \"hidden\";\n  Parallax.window.appendChild(mirror);\n  let slider = document.createElement(\"img\");\n  slider.src = Parallax.options.src;\n  slider.alt = \"parallax\";\n  slider.classList.add(\"parallax-slider\");\n  slider.style.opacity = 0;\n  mirror.appendChild(slider);\n  if (!Parallax.mirrors) {\n    Parallax.mirrors = [];\n  }\n  let mirrorItem = {};\n  mirrorItem.mirror = mirror;\n  mirrorItem.slider = slider;\n  Parallax.mirrors.push(mirrorItem);\n  Parallax.slidein();\n  slider.addEventListener(\n    \"load\",\n    function () {\n      Parallax.update();\n    },\n    false\n  );\n};\nParallax.init = () => {\n  function loadDimensions() {\n    Parallax.wH = document.documentElement.clientHeight;\n    Parallax.wW = document.documentElement.clientWidth;\n  }\n  function getScrollTop() {\n    var scrollPos;\n    if (window.pageYOffset) {\n      scrollPos = window.pageYOffset;\n    } else if (document.compatMode && document.compatMode != \"BackCompat\") {\n      scrollPos = document.documentElement.scrollTop;\n    } else if (document.body) {\n      scrollPos = document.body.scrollTop;\n    }\n    return scrollPos;\n  }\n  function loadScrollPosition() {\n    const winScrollTop = getScrollTop();\n    Parallax.sT = Math.max(0, winScrollTop);\n    Parallax.sL = Math.max(0, document.body.scrollLeft);\n    Parallax.overScroll = Math.min(winScrollTop, 0);\n  }\n  window.addEventListener(\n    \"resize\",\n    function () {\n      loadDimensions();\n      Parallax.update();\n    },\n    false\n  );\n  loadDimensions();\n  let lastPosition = -1;\n  (function loop() {\n    const yoffset = getScrollTop();\n    if (lastPosition !== yoffset) {\n      lastPosition = yoffset;\n      loadScrollPosition();\n      Parallax.update();\n    }\n    window.requestAnimationFrame =\n      window.requestAnimationFrame ||\n      window.mozRequestAnimationFrame ||\n      window.webkitRequestAnimationFrame;\n    window.requestAnimationFrame(loop);\n  })();\n};\n\nParallax.refreshItem = (slider) => {\n  Parallax.options.aspectRatio =\n    slider.naturalWidth / (slider.naturalHeight || 1);\n  const aspect = Parallax.options.aspectRatio || 1;\n  Parallax.options.boxWidth = Parallax.window.clientWidth;\n  Parallax.options.boxHeight = Parallax.window.clientHeight;\n  Parallax.options.boxOffsetTop = Parallax.window.scrollTop;\n  Parallax.options.boxOffsetLeft = Parallax.window.scrollLeft;\n  Parallax.options.boxOffsetBottom =\n    Parallax.options.boxOffsetTop + Parallax.options.boxHeight;\n  const winHeight = Parallax.wH;\n  const maxOffset = Parallax.options.boxOffsetTop;\n  const minOffset = Math.max(\n    Parallax.options.boxOffsetTop + Parallax.options.boxHeight - winHeight,\n    0\n  );\n  const imageHeightMin =\n    (Parallax.options.boxHeight +\n      (maxOffset - minOffset) * (1 - Parallax.options.speed)) |\n    0;\n  const imageOffsetMin =\n    ((Parallax.options.boxOffsetTop - maxOffset) *\n      (1 - Parallax.options.speed)) |\n    0;\n  let margin;\n  if (Parallax.options.boxWidth < imageHeightMin * aspect) {\n    Parallax.options.imageWidth = (imageHeightMin * aspect) | 0;\n    Parallax.options.imageHeight = imageHeightMin;\n    Parallax.options.offsetBaseTop = imageOffsetMin;\n    margin = Parallax.options.imageWidth - Parallax.options.boxWidth;\n    Parallax.options.offsetLeft = (-margin / 2) | 0;\n  } else {\n    Parallax.options.imageWidth = Parallax.options.boxWidth;\n    Parallax.options.imageHeight = (Parallax.options.boxWidth / aspect) | 0;\n    Parallax.options.offsetLeft = 0;\n    margin = Parallax.options.imageHeight - imageHeightMin;\n    Parallax.options.offsetBaseTop = (imageOffsetMin - margin / 2) | 0;\n  }\n};\nParallax.renderItem = (mirror, slider) => {\n  const scrollTop = Parallax.sT;\n  const scrollLeft = Parallax.sL;\n  const scrollBottom = scrollTop + Parallax.wH;\n  if (\n    Parallax.options.boxOffsetBottom > scrollTop &&\n    Parallax.options.boxOffsetTop <= scrollBottom\n  ) {\n    Parallax.options.visibility = \"visible\";\n    Parallax.options.mirrorTop = Parallax.options.boxOffsetTop - scrollTop;\n    Parallax.options.mirrorLeft = Parallax.options.boxOffsetLeft - scrollLeft;\n    Parallax.options.offsetTop =\n      Parallax.options.offsetBaseTop -\n      Parallax.options.mirrorTop * (1 - Parallax.options.speed);\n  } else {\n    Parallax.options.visibility = \"hidden\";\n  }\n  mirror.style.transform =\n    \"translate3d(\" +\n    Parallax.options.mirrorLeft +\n    \"px, \" +\n    Parallax.options.mirrorTop +\n    \"px, 0px)\";\n  mirror.style.visibility = Parallax.options.visibility;\n  mirror.style.height = Parallax.options.boxHeight + \"px\";\n  mirror.style.width = Parallax.options.boxWidth + \"px\";\n\n  slider.style.transform =\n    \"translate3d(\" +\n    Parallax.options.offsetLeft +\n    \"px, \" +\n    Parallax.options.offsetTop +\n    \"px, 0px)\";\n  slider.style.position = \"absolute\";\n  slider.style.height = Parallax.options.imageHeight + \"px\";\n  slider.style.width = Parallax.options.imageWidth + \"px\";\n  slider.style.maxWidth = \"none\";\n};\nParallax.update = () => {\n  if (!Parallax.mirrors) {\n    return\n  }\n  Parallax.mirrors.forEach((e) => {\n    Parallax.refreshItem(e.slider);\n    Parallax.renderItem(e.mirror, e.slider);\n  });\n};\n","date":"2022-12-27T15:15:09.551Z","updated":"2022-12-27T15:15:09.551Z","path":"js/plugins/parallax.js","layout":"false","title":"","comments":1,"_id":"clc6k3sf400056cu93t2i930w"},{"_content":"\nconst RightMenus = {\n  defaultEvent: ['copyText', 'copyLink', 'copyPaste', 'copyAll', 'copyCut', 'copyImg', 'printMode', 'readMode'],\n  defaultGroup: ['navigation', 'inputBox', 'seletctText', 'elementCheck', 'elementImage', 'articlePage'],\n  messageRightMenu: volantis.GLOBAL_CONFIG.plugins.message.enable && volantis.GLOBAL_CONFIG.plugins.message.rightmenu.enable,\n  corsAnywhere: volantis.GLOBAL_CONFIG.plugins.rightmenus.options.corsAnywhere,\n  urlRegx: /^((https|http)?:\\/\\/)+[A-Za-z0-9]+\\.[A-Za-z0-9]+[\\/=\\?%\\-&_~`@[\\]\\':+!]*([^<>\\\"\\\"])*$/,\n  imgRegx: /\\.(jpe?g|png|webp|svg|gif|jifi)(-|_|!|\\?|\\/)?.*$/,\n\n  /**\n   * 加载右键菜单\n   */\n  initialMenu: () => {\n    RightMenus.fun.init();\n  },\n\n  /**\n   * 读取剪切板\n   * @returns text\n   */\n  readClipboard: async () => {\n    let clipboardText;\n    const result = await navigator.permissions.query({ name: 'clipboard-read' });\n    switch (result.state) {\n      case 'granted':\n      case 'prompt':\n        clipboardText = await navigator.clipboard.readText()\n        break;\n      default:\n        window.clipboardRead = false;\n        break;\n    }\n    return clipboardText;\n  },\n\n  /**\n   * 写入文本到剪切板\n   * @param {String} text\n   */\n  writeClipText: text => {\n    return navigator.clipboard\n      .writeText(text)\n      .then(() => {\n        return Promise.resolve()\n      })\n      .catch(err => {\n        return Promise.reject(err)\n      })\n  },\n\n  /**\n   * 写入图片到剪切板\n   * @param {*} link\n   * @param {*} success\n   * @param {*} error\n   */\n  writeClipImg: async (link, success, error) => {\n    const image = new Image;\n    image.crossOrigin = \"Anonymous\";\n    image.addEventListener('load', () => {\n      let canvas = document.createElement(\"canvas\");\n      let context = canvas.getContext(\"2d\");\n      canvas.width = image.width;\n      canvas.height = image.height;\n      context.drawImage(image, 0, 0);\n      canvas.toBlob(blob => {\n        navigator.clipboard.write([\n          new ClipboardItem({ 'image/png': blob })\n        ]).then(e => {\n          success(e)\n        }).catch(e => {\n          error(e)\n        })\n      }, 'image/png')\n    }, false)\n    image.src = `${link}?(lll￢ω￢)`;\n  },\n\n  /**\n   * 粘贴文本到剪切板\n   * @param {*} elemt\n   * @param {*} value\n   */\n  insertAtCaret: (elemt, value) => {\n    const startPos = elemt.selectionStart,\n      endPos = elemt.selectionEnd;\n    if (document.selection) {\n      elemt.focus();\n      var sel = document.selection.createRange();\n      sel.text = value;\n      elemt.focus();\n    } else {\n      if (startPos || startPos == '0') {\n        var scrollTop = elemt.scrollTop;\n        elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);\n        elemt.focus();\n        elemt.selectionStart = startPos + value.length;\n        elemt.selectionEnd = startPos + value.length;\n        elemt.scrollTop = scrollTop;\n      } else {\n        elemt.value += value;\n        elemt.focus();\n      }\n    }\n  }\n}\n\n/**\n * 事件处理区域\n */\nRightMenus.fun = (() => {\n  const rightMenuConfig = volantis.GLOBAL_CONFIG.plugins.rightmenus;\n\n  const\n    fn = {},\n    _rightMenuWrapper = document.getElementById('rightmenu-wrapper'),\n    _rightMenuContent = document.getElementById('rightmenu-content'),\n    _rightMenuList = document.querySelectorAll('#rightmenu-content li.menuLoad-Content'),\n    _rightMenuListWithHr = document.querySelectorAll('#rightmenu-content li, #rightmenu-content hr, #menuMusic'),\n    _readBkg = document.getElementById('read_bkg'),\n    _menuMusic = document.getElementById('menuMusic'),\n    _backward = document.querySelector('#menuMusic .backward'),\n    _toggle = document.querySelector('#menuMusic .toggle'),\n    _forward = document.querySelector('#menuMusic .forward');\n\n  // 公共数据\n  let globalData = {\n    mouseEvent: null,\n    isInputBox: false,\n    selectText: '',\n    inputValue: '',\n    isLink: false,\n    linkUrl: '',\n    isMediaLink: false,\n    mediaLinkUrl: '',\n    isImage: false,\n    isArticle: false,\n    pathName: '',\n    isReadClipboard: true,\n    isShowMusic: false,\n    statusCheck: false\n  }\n  const globalDataBackup = Object.assign({}, globalData);\n\n  /**\n   * 初始化监听事件处理\n   */\n  fn.initEvent = () => {\n    fn.elementAppend();\n    fn.contextmenu();\n    fn.menuEvent();\n  }\n\n  /**\n   * 预置元素设定\n   */\n  fn.elementAppend = () => {\n    // 阅读模式\n    if (_readBkg) _readBkg.parentNode.removeChild(_readBkg);\n    const readBkg = document.createElement(\"div\");\n    readBkg.className = \"common_read_bkg common_read_hide\";\n    readBkg.id = \"read_bkg\";\n    window.document.body.appendChild(readBkg);\n  }\n\n  /**\n   * 右键菜单位置设定\n   * @param {*} event\n   */\n  fn.menuPosition = (event) => {\n    try {\n      let mouseClientX = event.clientX;\n      let mouseClientY = event.clientY;\n      let screenWidth = document.documentElement.clientWidth || document.body.clientWidth;\n      let screenHeight = document.documentElement.clientHeight || document.body.clientHeight;\n\n      _rightMenuWrapper.style.display = 'block';\n      fn.menuControl(event);\n\n      let menuWidth = _rightMenuContent.offsetWidth;\n      let menuHeight = _rightMenuContent.offsetHeight;\n      let showLeft = mouseClientX + menuWidth > screenWidth ? mouseClientX - menuWidth + 10 : mouseClientX;\n      let showTop = mouseClientY + menuHeight > screenHeight ? mouseClientY - menuHeight + 10 : mouseClientY;\n      showTop = mouseClientY + menuHeight > screenHeight && showTop < menuHeight && mouseClientY < menuHeight ?\n        showTop + (screenHeight - menuHeight - showTop - 10) : showTop;\n      _rightMenuWrapper.style.left = `${showLeft}px`;\n      _rightMenuWrapper.style.top = `${showTop}px`;\n      if (volantis.GLOBAL_CONFIG.plugins.message.rightmenu.notice) fn.menuNotic();\n    } catch (error) {\n      console.error(error);\n      fn.hideMenu();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * 菜单项控制\n   * @param {*} event\n   */\n  fn.menuControl = (event) => {\n    fn.globalDataSet(event);\n    if (!!_menuMusic) _menuMusic.style.display = globalData.isShowMusic ? 'block' : 'none';\n    _rightMenuList.forEach(item => {\n      item.style.display = 'none';\n      const nodeName = item.firstElementChild.nodeName;\n      const groupName = item.firstElementChild.getAttribute('data-group');\n      const itemEvent = item.firstElementChild.getAttribute('data-event');\n      if (globalData.statusCheck || globalData.isArticle) {\n        switch (groupName) {\n          case 'inputBox':\n            if (globalData.isInputBox) {\n              item.style.display = 'block';\n              if (itemEvent === 'copyCut' && !globalData.selectText) item.style.display = 'none';\n              if (itemEvent === 'copyAll' && !globalData.inputValue) item.style.display = 'none';\n              if (itemEvent === 'copyPaste' && !globalData.isReadClipboard) item.style.display = 'none';\n            }\n            break;\n          case 'seletctText':\n            if (!!globalData.selectText) item.style.display = 'block';\n            break;\n          case 'elementCheck':\n            if (globalData.isLink || globalData.isMediaLink) item.style.display = 'block';\n            break;\n          case 'elementImage':\n            if (globalData.isImage) item.style.display = 'block';\n            break;\n          case 'articlePage':\n            if (globalData.isArticle) item.style.display = 'block';\n            break;\n          default:\n            item.style.display = nodeName === 'A'\n              ? globalData.isArticle && !globalData.statusCheck && rightMenuConfig.options.articleShowLink\n                ? 'block'\n                : 'none'\n              : 'block';\n            break;\n        }\n      } else if (nodeName === 'A' || RightMenus.defaultGroup.every(item => { return groupName !== item })) {\n        item.style.display = 'block';\n      }\n    })\n\n    // 执行外部事件\n    volantis.mouseEvent = event;\n    volantis.rightmenu.method.handle.start()\n\n    // 过滤 HR 元素\n    let elementHrItem = { item: null, hide: true };\n    _rightMenuListWithHr.forEach((item) => {\n      if (item.nodeName === \"HR\") {\n        item.style.display = 'block';\n        if (!elementHrItem.item) {\n          elementHrItem.item = item;\n          return;\n        }\n        if (elementHrItem.hide || elementHrItem.item.nextElementSibling.nodeName === \"hr\") {\n          elementHrItem.item.style.display = 'none';\n        }\n        elementHrItem.item = item;\n        elementHrItem.hide = true;\n      } else {\n        if (item.style.display === 'block' && elementHrItem.hide) {\n          elementHrItem.hide = false;\n        }\n      }\n    })\n    if (!!elementHrItem.item && elementHrItem.hide) elementHrItem.item.style.display = 'none';\n  }\n\n  /**\n   * 元素状态判断/全局数据设置\n   * @param {*} event\n   */\n  fn.globalDataSet = (event) => {\n    globalData = Object.assign({}, globalDataBackup);\n    globalData.mouseEvent = event;\n    globalData.selectText = window.getSelection().toString();\n\n    // 判断是否为输入框\n    if (event.target.tagName.toLowerCase() === 'input' || event.target.tagName.toLowerCase() === 'textarea') {\n      globalData.isInputBox = true;\n      globalData.inputValue = event.target.value;\n    }\n\n    // 判断是否允许读取剪切板\n    if (globalData.isInputBox && window.clipboardRead === false) {\n      globalData.isReadClipboard = false;\n    }\n\n    // 判断是否包含链接\n    if (!!event.target.href && RightMenus.urlRegx.test(event.target.href)) {\n      globalData.isLink = true;\n      globalData.linkUrl = event.target.href;\n    }\n\n    // 判断是否包含媒体链接\n    if (!!event.target.currentSrc && RightMenus.urlRegx.test(event.target.currentSrc)) {\n      globalData.isMediaLink = true;\n      globalData.mediaLinkUrl = event.target.currentSrc;\n    }\n\n    // 判断是否为图片地址\n    if (globalData.isMediaLink && RightMenus.imgRegx.test(globalData.mediaLinkUrl)) {\n      globalData.isImage = true;\n    }\n\n    // 判断是否为文章页面\n    if (!!(document.querySelector('#post.article') || null)) {\n      globalData.isArticle = true;\n      globalData.pathName = window.location.pathname;\n    }\n\n    // 判断是否显示音乐控制器\n    if (volantis.GLOBAL_CONFIG.plugins.aplayer?.enable\n      && typeof RightMenuAplayer !== 'undefined'\n      && RightMenuAplayer.APlayer.player !== undefined) {\n      if (rightMenuConfig.options.musicAlwaysShow\n        || RightMenuAplayer.APlayer.status === 'play'\n        || RightMenuAplayer.APlayer.status === 'undefined') {\n        globalData.isShowMusic = true;\n      }\n    }\n\n    // 设定校验状态\n    if (!!globalData.selectText || globalData.isInputBox || globalData.isLink || globalData.isMediaLink) {\n      globalData.statusCheck = true;\n    }\n  }\n\n  /**\n   * 全局右键监听函数\n   */\n  fn.contextmenu = () => {\n    window.document.oncontextmenu = (event) => {\n      if (event.ctrlKey || document.body.offsetWidth <= 500) {\n        fn.hideMenu();\n        return true;\n      }\n      return fn.menuPosition(event);\n    }\n\n    _rightMenuWrapper.oncontextmenu = (event) => {\n      event.stopPropagation();\n      event.preventDefault();\n      return false;\n    }\n\n    window.removeEventListener('blur', fn.hideMenu);\n    window.addEventListener('blur', fn.hideMenu);\n    document.body.removeEventListener('click', fn.hideMenu);\n    document.body.addEventListener('click', fn.hideMenu);\n  }\n\n  /**\n   * 菜单项事件处理函数\n   */\n  fn.menuEvent = () => {\n    _rightMenuList.forEach(item => {\n      let eventName = item.firstElementChild.getAttribute('data-event');\n      const id = item.firstElementChild.getAttribute('id');\n      const groupName = item.firstElementChild.getAttribute('data-group');\n      if (item.firstElementChild.nodeName === \"A\") return;\n      item.addEventListener('click', () => {\n        try {\n          if (RightMenus.defaultEvent.every(item => { return eventName !== item })) {\n            if (groupName === 'seletctText') {\n              RightMenusFunction[id](globalData.selectText)\n            } else if (groupName === 'elementCheck') {\n              RightMenusFunction[id](globalData.isLink ? globalData.linkUrl : globalData.mediaLinkUrl)\n            } else if (groupName === 'elementImage') {\n              RightMenusFunction[id](globalData.mediaLinkUrl)\n            } else {\n              RightMenusFunction[id]()\n            }\n          } else {\n            fn[eventName]()\n          }\n        } catch (error) {\n          if (volantis.GLOBAL_CONFIG.debug === \"rightMenus\") {\n            console.error({\n              id: id,\n              error: error,\n              globalData: globalData,\n              groupName: groupName,\n              eventName: eventName\n            });\n          }\n          if (RightMenus.messageRightMenu) {\n            VolantisApp.message('错误提示', error, {\n              icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n              time: '15000'\n            });\n          }\n        }\n      })\n    })\n\n    if (_forward && _toggle && _forward) {\n      _backward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerBackward();\n      }\n      _toggle.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerToggle();\n      }\n      _forward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerForward();\n      }\n    }\n  }\n\n  /**\n   * 隐藏菜单显示\n   */\n  fn.hideMenu = () => {\n    _rightMenuWrapper.style.display = null;\n    _rightMenuWrapper.style.left = null;\n    _rightMenuWrapper.style.top = null;\n  }\n\n  /**\n   * 右键菜单覆盖提示\n   */\n  fn.menuNotic = () => {\n    const NoticeRightMenu = localStorage.getItem('NoticeRightMenu') === 'true';\n    if (RightMenus.messageRightMenu && !NoticeRightMenu)\n      VolantisApp.message('右键菜单', '唤醒原系统菜单请使用：<kbd>Ctrl</kbd> + <kbd>右键</kbd>', {\n        icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n        displayMode: 1,\n        time: 9000\n      }, () => {\n        localStorage.setItem('NoticeRightMenu', 'true')\n      });\n  }\n\n  fn.copyText = () => {\n    VolantisApp.utilWriteClipText(globalData.selectText)\n      .then(() => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.messageCopyright();\n        }\n      }).catch(e => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.message('系统提示', e, {\n            icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n            displayMode: 1,\n            time: 9000\n          });\n        }\n      })\n  }\n\n  fn.copyLink = () => {\n    VolantisApp.utilWriteClipText(globalData.linkUrl || globalData.mediaLinkUrl)\n      .then(() => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.messageCopyright();\n        }\n      }).catch(e => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.message('系统提示', e, {\n            icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n            displayMode: 1,\n            time: 9000\n          });\n        }\n      })\n  }\n\n  fn.copyAll = () => {\n    globalData.mouseEvent.target.select();\n  }\n\n  fn.copyPaste = async () => {\n    const result = await RightMenus.readClipboard() || '';\n    if (RightMenus.messageRightMenu && window.clipboardRead === false) {\n      VolantisApp.message('系统提示', '未授予剪切板读取权限！');\n    } else if (RightMenus.messageRightMenu && result === '') {\n      VolantisApp.message('系统提示', '仅支持复制文本内容！');\n    } else {\n      RightMenus.insertAtCaret(globalData.mouseEvent.target, result);\n    }\n  }\n\n  fn.copyCut = () => {\n    const statrPos = globalData.mouseEvent.target.selectionStart;\n    const endPos = globalData.mouseEvent.target.selectionEnd;\n    const inputStr = globalData.inputValue;\n    fn.copyText(globalData.selectText);\n    globalData.mouseEvent.target.value = inputStr.substring(0, statrPos) + inputStr.substring(endPos, inputStr.length);\n    globalData.mouseEvent.target.selectionStart = statrPos;\n    globalData.mouseEvent.target.selectionEnd = statrPos;\n    globalData.mouseEvent.target.focus();\n  }\n\n  fn.copyImg = () => {\n    if (volantis.GLOBAL_CONFIG.plugins.message.rightmenu.notice) {\n      VolantisApp.message('系统提示', '复制中，请等待。', {\n        icon: rightMenuConfig.options.iconPrefix + ' fa-images'\n      })\n    }\n    RightMenus.writeClipImg(globalData.mediaLinkUrl, e => {\n      if (RightMenus.messageRightMenu) {\n        VolantisApp.hideMessage();\n        VolantisApp.message('系统提示', '图片复制成功！', {\n          icon: rightMenuConfig.options.iconPrefix + ' fa-images'\n        });\n      }\n    }, (e) => {\n      console.error(e);\n      if (RightMenus.messageRightMenu) {\n        VolantisApp.hideMessage();\n        VolantisApp.message('系统提示', '复制失败：' + e, {\n          icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n          time: 9000\n        });\n      }\n    })\n  }\n\n  fn.printMode = () => {\n    if (window.location.pathname === globalData.pathName) {\n      if (RightMenus.messageRightMenu) {\n        const message = '是否打印当前页面？<br><em style=\"font-size: 80%\">建议打印时勾选背景图形</em><br>'\n        VolantisApp.question('', message, { time: 9000 }, () => { fn.printHtml() })\n      } else {\n        fn.printHtml()\n      }\n    }\n  }\n\n  fn.printHtml = () => {\n    if (volantis.isReadModel) fn.readMode();\n    DOMController.setAttribute('details', 'open', 'true');\n    DOMController.removeList([\n      '.cus-article-bkg', '.iziToast-overlay', '.iziToast-wrapper', '.prev-next',\n      'footer', '#l_header', '#l_cover', '#l_side', '#comments', '#s-top', '#BKG',\n      '#rightmenu-wrapper', '.nav-tabs', '.parallax-mirror', '.new-meta-item.share', \n      '.new-meta-box', 'button.btn-copy', 'iframe'\n    ]);\n    DOMController.setStyleList([\n      ['body', 'backgroundColor', 'unset'], ['#l_main, .copyright.license', 'width', '100%'],  \n      ['#post', 'boxShadow', 'none'], ['#post', 'background', 'none'], ['#post', 'padding', '0'],  \n      ['h1', 'textAlign', 'center'], ['h1', 'fontWeight', '600'], ['h1', 'fontSize', '2rem'], ['h1', 'marginBottom', '20px'], \n      ['.tab-pane', 'display', 'block'], ['.tab-content', 'borderTop', 'none'], ['.highlight>table pre', 'whiteSpace', 'pre-wrap'], \n      ['.highlight>table pre', 'wordBreak', 'break-all'], ['.fancybox img', 'height', 'auto'], ['.fancybox img', 'weight', 'auto'], \n      ['.copyright.license', 'margin', '0'], ['.copyright.license', 'padding', '1.25em 20px'],  \n      ['figure.highlight, .copyright.license', 'display', 'inline-block'], \n    ]);\n    setTimeout(() => {\n      window.print();\n      document.body.innerHTML = '';\n      window.location.reload();\n    }, 50);\n  }\n\n  fn.readMode = () => {\n    if (typeof ScrollReveal === 'function') ScrollReveal().clean('#comments');\n    DOMController.setStyle('#l_header', 'opacity', 0);\n    DOMController.fadeToggleList([\n      document.querySelector('#l_cover'), document.querySelector('footer'),\n      document.querySelector('#s-top'), document.querySelector('.article-meta#bottom'),\n      document.querySelector('.prev-next'), document.querySelector('#l_side'),\n      document.querySelector('#comments'), \n    ]);\n    DOMController.toggleClassList([\n      [document.querySelector('#l_main'), 'common_read'], [document.querySelector('#l_main'), 'common_read_main'],\n      [document.querySelector('#l_body'), 'common_read'], [document.querySelector('#safearea'), 'common_read'],\n      [document.querySelector('h1'), 'common_read_h1'], [document.querySelector('#post'), 'post_read'],\n      [document.querySelector('#l_cover'), 'read_cover'], [document.querySelector('.widget.toc-wrapper'), 'post_read']\n    ]);\n    DOMController.setStyle('.copyright.license', 'margin', '15px 0');\n    volantis.isReadModel = volantis.isReadModel === undefined ? true : !volantis.isReadModel;\n    if (volantis.isReadModel) {\n      if (RightMenus.messageRightMenu) VolantisApp.message('系统提示', '阅读模式已开启，您可以点击屏幕空白处退出。', {\n        backgroundColor: 'var(--color-read-post)',\n        icon: rightMenuConfig.options.iconPrefix + ' fa-book-reader',\n        displayMode: 1,\n        time: 5000\n      });\n      document.querySelector('#l_body').removeEventListener('click', fn.readMode);\n      document.querySelector('#l_body').addEventListener('click', (event) => {\n        if (DOMController.hasClass(event.target, 'common_read')) {\n          fn.readMode();\n        }\n      });\n    } else {\n      document.querySelector('#l_body').removeEventListener('click', fn.readMode);\n      document.querySelector('#post').removeEventListener('click', fn.readMode);\n      DOMController.setStyle('.prev-next', 'display', 'flex');\n      DOMController.setStyle('.copyright.license', 'margin', '15px -40px');\n    }\n  }\n\n  return {\n    init: fn.initEvent,\n    hideMenu: fn.hideMenu,\n    readMode: fn.readMode\n  }\n})()\n\nObject.freeze(RightMenus);\nvolantis.requestAnimationFrame(() => {\n  if (document.readyState !== 'loading') {\n    RightMenus.initialMenu();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", function () {\n      RightMenus.initialMenu();\n    })\n  }\n});\n","source":"js/plugins/rightMenus.js","raw":"\nconst RightMenus = {\n  defaultEvent: ['copyText', 'copyLink', 'copyPaste', 'copyAll', 'copyCut', 'copyImg', 'printMode', 'readMode'],\n  defaultGroup: ['navigation', 'inputBox', 'seletctText', 'elementCheck', 'elementImage', 'articlePage'],\n  messageRightMenu: volantis.GLOBAL_CONFIG.plugins.message.enable && volantis.GLOBAL_CONFIG.plugins.message.rightmenu.enable,\n  corsAnywhere: volantis.GLOBAL_CONFIG.plugins.rightmenus.options.corsAnywhere,\n  urlRegx: /^((https|http)?:\\/\\/)+[A-Za-z0-9]+\\.[A-Za-z0-9]+[\\/=\\?%\\-&_~`@[\\]\\':+!]*([^<>\\\"\\\"])*$/,\n  imgRegx: /\\.(jpe?g|png|webp|svg|gif|jifi)(-|_|!|\\?|\\/)?.*$/,\n\n  /**\n   * 加载右键菜单\n   */\n  initialMenu: () => {\n    RightMenus.fun.init();\n  },\n\n  /**\n   * 读取剪切板\n   * @returns text\n   */\n  readClipboard: async () => {\n    let clipboardText;\n    const result = await navigator.permissions.query({ name: 'clipboard-read' });\n    switch (result.state) {\n      case 'granted':\n      case 'prompt':\n        clipboardText = await navigator.clipboard.readText()\n        break;\n      default:\n        window.clipboardRead = false;\n        break;\n    }\n    return clipboardText;\n  },\n\n  /**\n   * 写入文本到剪切板\n   * @param {String} text\n   */\n  writeClipText: text => {\n    return navigator.clipboard\n      .writeText(text)\n      .then(() => {\n        return Promise.resolve()\n      })\n      .catch(err => {\n        return Promise.reject(err)\n      })\n  },\n\n  /**\n   * 写入图片到剪切板\n   * @param {*} link\n   * @param {*} success\n   * @param {*} error\n   */\n  writeClipImg: async (link, success, error) => {\n    const image = new Image;\n    image.crossOrigin = \"Anonymous\";\n    image.addEventListener('load', () => {\n      let canvas = document.createElement(\"canvas\");\n      let context = canvas.getContext(\"2d\");\n      canvas.width = image.width;\n      canvas.height = image.height;\n      context.drawImage(image, 0, 0);\n      canvas.toBlob(blob => {\n        navigator.clipboard.write([\n          new ClipboardItem({ 'image/png': blob })\n        ]).then(e => {\n          success(e)\n        }).catch(e => {\n          error(e)\n        })\n      }, 'image/png')\n    }, false)\n    image.src = `${link}?(lll￢ω￢)`;\n  },\n\n  /**\n   * 粘贴文本到剪切板\n   * @param {*} elemt\n   * @param {*} value\n   */\n  insertAtCaret: (elemt, value) => {\n    const startPos = elemt.selectionStart,\n      endPos = elemt.selectionEnd;\n    if (document.selection) {\n      elemt.focus();\n      var sel = document.selection.createRange();\n      sel.text = value;\n      elemt.focus();\n    } else {\n      if (startPos || startPos == '0') {\n        var scrollTop = elemt.scrollTop;\n        elemt.value = elemt.value.substring(0, startPos) + value + elemt.value.substring(endPos, elemt.value.length);\n        elemt.focus();\n        elemt.selectionStart = startPos + value.length;\n        elemt.selectionEnd = startPos + value.length;\n        elemt.scrollTop = scrollTop;\n      } else {\n        elemt.value += value;\n        elemt.focus();\n      }\n    }\n  }\n}\n\n/**\n * 事件处理区域\n */\nRightMenus.fun = (() => {\n  const rightMenuConfig = volantis.GLOBAL_CONFIG.plugins.rightmenus;\n\n  const\n    fn = {},\n    _rightMenuWrapper = document.getElementById('rightmenu-wrapper'),\n    _rightMenuContent = document.getElementById('rightmenu-content'),\n    _rightMenuList = document.querySelectorAll('#rightmenu-content li.menuLoad-Content'),\n    _rightMenuListWithHr = document.querySelectorAll('#rightmenu-content li, #rightmenu-content hr, #menuMusic'),\n    _readBkg = document.getElementById('read_bkg'),\n    _menuMusic = document.getElementById('menuMusic'),\n    _backward = document.querySelector('#menuMusic .backward'),\n    _toggle = document.querySelector('#menuMusic .toggle'),\n    _forward = document.querySelector('#menuMusic .forward');\n\n  // 公共数据\n  let globalData = {\n    mouseEvent: null,\n    isInputBox: false,\n    selectText: '',\n    inputValue: '',\n    isLink: false,\n    linkUrl: '',\n    isMediaLink: false,\n    mediaLinkUrl: '',\n    isImage: false,\n    isArticle: false,\n    pathName: '',\n    isReadClipboard: true,\n    isShowMusic: false,\n    statusCheck: false\n  }\n  const globalDataBackup = Object.assign({}, globalData);\n\n  /**\n   * 初始化监听事件处理\n   */\n  fn.initEvent = () => {\n    fn.elementAppend();\n    fn.contextmenu();\n    fn.menuEvent();\n  }\n\n  /**\n   * 预置元素设定\n   */\n  fn.elementAppend = () => {\n    // 阅读模式\n    if (_readBkg) _readBkg.parentNode.removeChild(_readBkg);\n    const readBkg = document.createElement(\"div\");\n    readBkg.className = \"common_read_bkg common_read_hide\";\n    readBkg.id = \"read_bkg\";\n    window.document.body.appendChild(readBkg);\n  }\n\n  /**\n   * 右键菜单位置设定\n   * @param {*} event\n   */\n  fn.menuPosition = (event) => {\n    try {\n      let mouseClientX = event.clientX;\n      let mouseClientY = event.clientY;\n      let screenWidth = document.documentElement.clientWidth || document.body.clientWidth;\n      let screenHeight = document.documentElement.clientHeight || document.body.clientHeight;\n\n      _rightMenuWrapper.style.display = 'block';\n      fn.menuControl(event);\n\n      let menuWidth = _rightMenuContent.offsetWidth;\n      let menuHeight = _rightMenuContent.offsetHeight;\n      let showLeft = mouseClientX + menuWidth > screenWidth ? mouseClientX - menuWidth + 10 : mouseClientX;\n      let showTop = mouseClientY + menuHeight > screenHeight ? mouseClientY - menuHeight + 10 : mouseClientY;\n      showTop = mouseClientY + menuHeight > screenHeight && showTop < menuHeight && mouseClientY < menuHeight ?\n        showTop + (screenHeight - menuHeight - showTop - 10) : showTop;\n      _rightMenuWrapper.style.left = `${showLeft}px`;\n      _rightMenuWrapper.style.top = `${showTop}px`;\n      if (volantis.GLOBAL_CONFIG.plugins.message.rightmenu.notice) fn.menuNotic();\n    } catch (error) {\n      console.error(error);\n      fn.hideMenu();\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * 菜单项控制\n   * @param {*} event\n   */\n  fn.menuControl = (event) => {\n    fn.globalDataSet(event);\n    if (!!_menuMusic) _menuMusic.style.display = globalData.isShowMusic ? 'block' : 'none';\n    _rightMenuList.forEach(item => {\n      item.style.display = 'none';\n      const nodeName = item.firstElementChild.nodeName;\n      const groupName = item.firstElementChild.getAttribute('data-group');\n      const itemEvent = item.firstElementChild.getAttribute('data-event');\n      if (globalData.statusCheck || globalData.isArticle) {\n        switch (groupName) {\n          case 'inputBox':\n            if (globalData.isInputBox) {\n              item.style.display = 'block';\n              if (itemEvent === 'copyCut' && !globalData.selectText) item.style.display = 'none';\n              if (itemEvent === 'copyAll' && !globalData.inputValue) item.style.display = 'none';\n              if (itemEvent === 'copyPaste' && !globalData.isReadClipboard) item.style.display = 'none';\n            }\n            break;\n          case 'seletctText':\n            if (!!globalData.selectText) item.style.display = 'block';\n            break;\n          case 'elementCheck':\n            if (globalData.isLink || globalData.isMediaLink) item.style.display = 'block';\n            break;\n          case 'elementImage':\n            if (globalData.isImage) item.style.display = 'block';\n            break;\n          case 'articlePage':\n            if (globalData.isArticle) item.style.display = 'block';\n            break;\n          default:\n            item.style.display = nodeName === 'A'\n              ? globalData.isArticle && !globalData.statusCheck && rightMenuConfig.options.articleShowLink\n                ? 'block'\n                : 'none'\n              : 'block';\n            break;\n        }\n      } else if (nodeName === 'A' || RightMenus.defaultGroup.every(item => { return groupName !== item })) {\n        item.style.display = 'block';\n      }\n    })\n\n    // 执行外部事件\n    volantis.mouseEvent = event;\n    volantis.rightmenu.method.handle.start()\n\n    // 过滤 HR 元素\n    let elementHrItem = { item: null, hide: true };\n    _rightMenuListWithHr.forEach((item) => {\n      if (item.nodeName === \"HR\") {\n        item.style.display = 'block';\n        if (!elementHrItem.item) {\n          elementHrItem.item = item;\n          return;\n        }\n        if (elementHrItem.hide || elementHrItem.item.nextElementSibling.nodeName === \"hr\") {\n          elementHrItem.item.style.display = 'none';\n        }\n        elementHrItem.item = item;\n        elementHrItem.hide = true;\n      } else {\n        if (item.style.display === 'block' && elementHrItem.hide) {\n          elementHrItem.hide = false;\n        }\n      }\n    })\n    if (!!elementHrItem.item && elementHrItem.hide) elementHrItem.item.style.display = 'none';\n  }\n\n  /**\n   * 元素状态判断/全局数据设置\n   * @param {*} event\n   */\n  fn.globalDataSet = (event) => {\n    globalData = Object.assign({}, globalDataBackup);\n    globalData.mouseEvent = event;\n    globalData.selectText = window.getSelection().toString();\n\n    // 判断是否为输入框\n    if (event.target.tagName.toLowerCase() === 'input' || event.target.tagName.toLowerCase() === 'textarea') {\n      globalData.isInputBox = true;\n      globalData.inputValue = event.target.value;\n    }\n\n    // 判断是否允许读取剪切板\n    if (globalData.isInputBox && window.clipboardRead === false) {\n      globalData.isReadClipboard = false;\n    }\n\n    // 判断是否包含链接\n    if (!!event.target.href && RightMenus.urlRegx.test(event.target.href)) {\n      globalData.isLink = true;\n      globalData.linkUrl = event.target.href;\n    }\n\n    // 判断是否包含媒体链接\n    if (!!event.target.currentSrc && RightMenus.urlRegx.test(event.target.currentSrc)) {\n      globalData.isMediaLink = true;\n      globalData.mediaLinkUrl = event.target.currentSrc;\n    }\n\n    // 判断是否为图片地址\n    if (globalData.isMediaLink && RightMenus.imgRegx.test(globalData.mediaLinkUrl)) {\n      globalData.isImage = true;\n    }\n\n    // 判断是否为文章页面\n    if (!!(document.querySelector('#post.article') || null)) {\n      globalData.isArticle = true;\n      globalData.pathName = window.location.pathname;\n    }\n\n    // 判断是否显示音乐控制器\n    if (volantis.GLOBAL_CONFIG.plugins.aplayer?.enable\n      && typeof RightMenuAplayer !== 'undefined'\n      && RightMenuAplayer.APlayer.player !== undefined) {\n      if (rightMenuConfig.options.musicAlwaysShow\n        || RightMenuAplayer.APlayer.status === 'play'\n        || RightMenuAplayer.APlayer.status === 'undefined') {\n        globalData.isShowMusic = true;\n      }\n    }\n\n    // 设定校验状态\n    if (!!globalData.selectText || globalData.isInputBox || globalData.isLink || globalData.isMediaLink) {\n      globalData.statusCheck = true;\n    }\n  }\n\n  /**\n   * 全局右键监听函数\n   */\n  fn.contextmenu = () => {\n    window.document.oncontextmenu = (event) => {\n      if (event.ctrlKey || document.body.offsetWidth <= 500) {\n        fn.hideMenu();\n        return true;\n      }\n      return fn.menuPosition(event);\n    }\n\n    _rightMenuWrapper.oncontextmenu = (event) => {\n      event.stopPropagation();\n      event.preventDefault();\n      return false;\n    }\n\n    window.removeEventListener('blur', fn.hideMenu);\n    window.addEventListener('blur', fn.hideMenu);\n    document.body.removeEventListener('click', fn.hideMenu);\n    document.body.addEventListener('click', fn.hideMenu);\n  }\n\n  /**\n   * 菜单项事件处理函数\n   */\n  fn.menuEvent = () => {\n    _rightMenuList.forEach(item => {\n      let eventName = item.firstElementChild.getAttribute('data-event');\n      const id = item.firstElementChild.getAttribute('id');\n      const groupName = item.firstElementChild.getAttribute('data-group');\n      if (item.firstElementChild.nodeName === \"A\") return;\n      item.addEventListener('click', () => {\n        try {\n          if (RightMenus.defaultEvent.every(item => { return eventName !== item })) {\n            if (groupName === 'seletctText') {\n              RightMenusFunction[id](globalData.selectText)\n            } else if (groupName === 'elementCheck') {\n              RightMenusFunction[id](globalData.isLink ? globalData.linkUrl : globalData.mediaLinkUrl)\n            } else if (groupName === 'elementImage') {\n              RightMenusFunction[id](globalData.mediaLinkUrl)\n            } else {\n              RightMenusFunction[id]()\n            }\n          } else {\n            fn[eventName]()\n          }\n        } catch (error) {\n          if (volantis.GLOBAL_CONFIG.debug === \"rightMenus\") {\n            console.error({\n              id: id,\n              error: error,\n              globalData: globalData,\n              groupName: groupName,\n              eventName: eventName\n            });\n          }\n          if (RightMenus.messageRightMenu) {\n            VolantisApp.message('错误提示', error, {\n              icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n              time: '15000'\n            });\n          }\n        }\n      })\n    })\n\n    if (_forward && _toggle && _forward) {\n      _backward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerBackward();\n      }\n      _toggle.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerToggle();\n      }\n      _forward.onclick = (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        RightMenuAplayer.aplayerForward();\n      }\n    }\n  }\n\n  /**\n   * 隐藏菜单显示\n   */\n  fn.hideMenu = () => {\n    _rightMenuWrapper.style.display = null;\n    _rightMenuWrapper.style.left = null;\n    _rightMenuWrapper.style.top = null;\n  }\n\n  /**\n   * 右键菜单覆盖提示\n   */\n  fn.menuNotic = () => {\n    const NoticeRightMenu = localStorage.getItem('NoticeRightMenu') === 'true';\n    if (RightMenus.messageRightMenu && !NoticeRightMenu)\n      VolantisApp.message('右键菜单', '唤醒原系统菜单请使用：<kbd>Ctrl</kbd> + <kbd>右键</kbd>', {\n        icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n        displayMode: 1,\n        time: 9000\n      }, () => {\n        localStorage.setItem('NoticeRightMenu', 'true')\n      });\n  }\n\n  fn.copyText = () => {\n    VolantisApp.utilWriteClipText(globalData.selectText)\n      .then(() => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.messageCopyright();\n        }\n      }).catch(e => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.message('系统提示', e, {\n            icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n            displayMode: 1,\n            time: 9000\n          });\n        }\n      })\n  }\n\n  fn.copyLink = () => {\n    VolantisApp.utilWriteClipText(globalData.linkUrl || globalData.mediaLinkUrl)\n      .then(() => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.messageCopyright();\n        }\n      }).catch(e => {\n        if (RightMenus.messageRightMenu) {\n          VolantisApp.message('系统提示', e, {\n            icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n            displayMode: 1,\n            time: 9000\n          });\n        }\n      })\n  }\n\n  fn.copyAll = () => {\n    globalData.mouseEvent.target.select();\n  }\n\n  fn.copyPaste = async () => {\n    const result = await RightMenus.readClipboard() || '';\n    if (RightMenus.messageRightMenu && window.clipboardRead === false) {\n      VolantisApp.message('系统提示', '未授予剪切板读取权限！');\n    } else if (RightMenus.messageRightMenu && result === '') {\n      VolantisApp.message('系统提示', '仅支持复制文本内容！');\n    } else {\n      RightMenus.insertAtCaret(globalData.mouseEvent.target, result);\n    }\n  }\n\n  fn.copyCut = () => {\n    const statrPos = globalData.mouseEvent.target.selectionStart;\n    const endPos = globalData.mouseEvent.target.selectionEnd;\n    const inputStr = globalData.inputValue;\n    fn.copyText(globalData.selectText);\n    globalData.mouseEvent.target.value = inputStr.substring(0, statrPos) + inputStr.substring(endPos, inputStr.length);\n    globalData.mouseEvent.target.selectionStart = statrPos;\n    globalData.mouseEvent.target.selectionEnd = statrPos;\n    globalData.mouseEvent.target.focus();\n  }\n\n  fn.copyImg = () => {\n    if (volantis.GLOBAL_CONFIG.plugins.message.rightmenu.notice) {\n      VolantisApp.message('系统提示', '复制中，请等待。', {\n        icon: rightMenuConfig.options.iconPrefix + ' fa-images'\n      })\n    }\n    RightMenus.writeClipImg(globalData.mediaLinkUrl, e => {\n      if (RightMenus.messageRightMenu) {\n        VolantisApp.hideMessage();\n        VolantisApp.message('系统提示', '图片复制成功！', {\n          icon: rightMenuConfig.options.iconPrefix + ' fa-images'\n        });\n      }\n    }, (e) => {\n      console.error(e);\n      if (RightMenus.messageRightMenu) {\n        VolantisApp.hideMessage();\n        VolantisApp.message('系统提示', '复制失败：' + e, {\n          icon: rightMenuConfig.options.iconPrefix + ' fa-exclamation-square red',\n          time: 9000\n        });\n      }\n    })\n  }\n\n  fn.printMode = () => {\n    if (window.location.pathname === globalData.pathName) {\n      if (RightMenus.messageRightMenu) {\n        const message = '是否打印当前页面？<br><em style=\"font-size: 80%\">建议打印时勾选背景图形</em><br>'\n        VolantisApp.question('', message, { time: 9000 }, () => { fn.printHtml() })\n      } else {\n        fn.printHtml()\n      }\n    }\n  }\n\n  fn.printHtml = () => {\n    if (volantis.isReadModel) fn.readMode();\n    DOMController.setAttribute('details', 'open', 'true');\n    DOMController.removeList([\n      '.cus-article-bkg', '.iziToast-overlay', '.iziToast-wrapper', '.prev-next',\n      'footer', '#l_header', '#l_cover', '#l_side', '#comments', '#s-top', '#BKG',\n      '#rightmenu-wrapper', '.nav-tabs', '.parallax-mirror', '.new-meta-item.share', \n      '.new-meta-box', 'button.btn-copy', 'iframe'\n    ]);\n    DOMController.setStyleList([\n      ['body', 'backgroundColor', 'unset'], ['#l_main, .copyright.license', 'width', '100%'],  \n      ['#post', 'boxShadow', 'none'], ['#post', 'background', 'none'], ['#post', 'padding', '0'],  \n      ['h1', 'textAlign', 'center'], ['h1', 'fontWeight', '600'], ['h1', 'fontSize', '2rem'], ['h1', 'marginBottom', '20px'], \n      ['.tab-pane', 'display', 'block'], ['.tab-content', 'borderTop', 'none'], ['.highlight>table pre', 'whiteSpace', 'pre-wrap'], \n      ['.highlight>table pre', 'wordBreak', 'break-all'], ['.fancybox img', 'height', 'auto'], ['.fancybox img', 'weight', 'auto'], \n      ['.copyright.license', 'margin', '0'], ['.copyright.license', 'padding', '1.25em 20px'],  \n      ['figure.highlight, .copyright.license', 'display', 'inline-block'], \n    ]);\n    setTimeout(() => {\n      window.print();\n      document.body.innerHTML = '';\n      window.location.reload();\n    }, 50);\n  }\n\n  fn.readMode = () => {\n    if (typeof ScrollReveal === 'function') ScrollReveal().clean('#comments');\n    DOMController.setStyle('#l_header', 'opacity', 0);\n    DOMController.fadeToggleList([\n      document.querySelector('#l_cover'), document.querySelector('footer'),\n      document.querySelector('#s-top'), document.querySelector('.article-meta#bottom'),\n      document.querySelector('.prev-next'), document.querySelector('#l_side'),\n      document.querySelector('#comments'), \n    ]);\n    DOMController.toggleClassList([\n      [document.querySelector('#l_main'), 'common_read'], [document.querySelector('#l_main'), 'common_read_main'],\n      [document.querySelector('#l_body'), 'common_read'], [document.querySelector('#safearea'), 'common_read'],\n      [document.querySelector('h1'), 'common_read_h1'], [document.querySelector('#post'), 'post_read'],\n      [document.querySelector('#l_cover'), 'read_cover'], [document.querySelector('.widget.toc-wrapper'), 'post_read']\n    ]);\n    DOMController.setStyle('.copyright.license', 'margin', '15px 0');\n    volantis.isReadModel = volantis.isReadModel === undefined ? true : !volantis.isReadModel;\n    if (volantis.isReadModel) {\n      if (RightMenus.messageRightMenu) VolantisApp.message('系统提示', '阅读模式已开启，您可以点击屏幕空白处退出。', {\n        backgroundColor: 'var(--color-read-post)',\n        icon: rightMenuConfig.options.iconPrefix + ' fa-book-reader',\n        displayMode: 1,\n        time: 5000\n      });\n      document.querySelector('#l_body').removeEventListener('click', fn.readMode);\n      document.querySelector('#l_body').addEventListener('click', (event) => {\n        if (DOMController.hasClass(event.target, 'common_read')) {\n          fn.readMode();\n        }\n      });\n    } else {\n      document.querySelector('#l_body').removeEventListener('click', fn.readMode);\n      document.querySelector('#post').removeEventListener('click', fn.readMode);\n      DOMController.setStyle('.prev-next', 'display', 'flex');\n      DOMController.setStyle('.copyright.license', 'margin', '15px -40px');\n    }\n  }\n\n  return {\n    init: fn.initEvent,\n    hideMenu: fn.hideMenu,\n    readMode: fn.readMode\n  }\n})()\n\nObject.freeze(RightMenus);\nvolantis.requestAnimationFrame(() => {\n  if (document.readyState !== 'loading') {\n    RightMenus.initialMenu();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", function () {\n      RightMenus.initialMenu();\n    })\n  }\n});\n","date":"2022-12-27T15:15:09.552Z","updated":"2022-12-27T15:15:09.552Z","path":"js/plugins/rightMenus.js","layout":"false","title":"","comments":1,"_id":"clc6k3sf500066cu9gn8k4tm8"},{"_content":"let SearchService = (() => {\n  const fn = {};\n  let search, meilisearch, timerId; \n  fn.queryText = null;\n  fn.template = `<div id=\"u-search\">\n  <div class=\"modal\">\n    <header class=\"modal-header\" class=\"clearfix\">\n      <button type=\"submit\" id=\"u-search-modal-btn-submit\" class=\"u-search-btn-submit\">\n        <span class=\"fa-solid fa-search\"></span>\n      </button>\n      <div id=\"meilisearch-search-input\"></div>\n      <a id=\"u-search-btn-close\" class=\"btn-close\"> <span class=\"fa-solid fa-times\"></span> </a>\n    </header>\n    <main class=\"modal-body\">\n      <div id=\"meilisearch-search-results\">\n        <div id=\"meilisearch-hits\">\n          <div class=\"search-icon\"><i class=\"fa-sharp fa-solid fa-telescope\"></i></i></div>\n        </div>\n      </div>\n    </main>\n    <footer>\n      <hr>\n      <div id=\"meilisearch-info\">\n        <div class=\"meilisearch-stats\"></div>\n        <div class=\"meilisearch-poweredBy\">\n          <a href=\"https://www.meilisearch.com\" titile=\"meilisearch\" target=\"_blank\">\n            <svg width=\"97\" height=\"20\" viewBox=\"0 0 537 83\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M49.8729 49.6398C49.8729 41.9727 53.5489 37.4565 60.5858 37.4565C67.2026 37.4565 69.4082 42.1827 69.4082 48.2744V80.9383H84.3222V46.5939C84.3222 33.7805 77.6004 24.643 64.3668 24.643C56.4897 24.643 50.9232 27.0586 46.0919 32.4151C42.941 27.5838 37.5846 24.643 30.1275 24.643C22.2504 24.643 16.7889 27.8989 14.2682 32.6251V25.9033H0.509521V80.9383H15.4236V49.3247C15.4236 41.9727 19.2046 37.4565 26.1365 37.4565C32.7532 37.4565 34.9588 42.1827 34.9588 48.2744V80.9383H49.8729V49.6398Z\" fill=\"black\"/><path d=\"M145.538 57.727C145.538 57.727 145.748 55.7314 145.748 53.3158C145.748 37.0363 134.72 24.643 118.441 24.643C102.161 24.643 90.8184 37.0363 90.8184 53.3158C90.8184 70.2253 102.266 82.1986 118.546 82.1986C131.254 82.1986 141.337 74.5315 144.593 63.3985H129.574C127.788 67.3896 123.482 69.3851 118.966 69.3851C111.509 69.3851 106.678 65.289 105.627 57.727H145.538ZM118.336 36.6162C125.268 36.6162 129.784 40.8174 130.834 47.014H105.837C107.098 40.7123 111.509 36.6162 118.336 36.6162Z\" fill=\"black\"/><path d=\"M147.947 38.7168H154.564V80.9383H169.478V25.9033H147.947V38.7168ZM162.021 18.7614C167.272 18.7614 171.054 15.0854 171.054 9.83396C171.054 4.58254 167.272 0.801514 162.021 0.801514C156.77 0.801514 152.989 4.58254 152.989 9.83396C152.989 15.0854 156.77 18.7614 162.021 18.7614Z\" fill=\"black\"/><path d=\"M200.361 68.1248C199.94 68.1248 199.31 68.2298 198.365 68.2298C195.004 68.2298 194.584 66.6544 194.584 64.3438V2.16688H179.67V65.394C179.67 76.317 183.871 81.1483 195.739 81.1483C197.735 81.1483 199.625 80.9382 200.361 80.8332V68.1248Z\" fill=\"black\"/><path d=\"M202.057 38.7168H208.674V80.9383H223.588V25.9033H202.057V38.7168ZM216.131 18.7614C221.383 18.7614 225.164 15.0854 225.164 9.83396C225.164 4.58254 221.383 0.801514 216.131 0.801514C210.88 0.801514 207.099 4.58254 207.099 9.83396C207.099 15.0854 210.88 18.7614 216.131 18.7614Z\" fill=\"black\"/><path d=\"M253.531 81.5175C268.025 81.5175 274.852 73.8504 274.852 65.7632C274.852 43.2871 241.768 55.7855 241.768 40.9765C241.768 36.1452 245.864 32.0491 254.161 32.0491C262.669 32.0491 266.66 36.6703 267.29 42.4469H274.747C274.117 35.1999 269.18 25.5373 254.371 25.5373C241.663 25.5373 234.521 33.0994 234.521 41.2916C234.521 63.2425 267.605 50.6391 267.605 65.9733C267.605 71.3297 262.564 75.0057 253.531 75.0057C244.289 75.0057 239.667 70.3845 239.142 63.5576H231.58C232.21 72.9051 238.092 81.5175 253.531 81.5175Z\" fill=\"black\"/><path d=\"M334.078 55.6805C334.078 55.6805 334.183 54 334.183 52.8447C334.183 37.7206 324.415 25.5373 308.451 25.5373C292.382 25.5373 282.194 38.6659 282.194 53.4749C282.194 68.4939 291.647 81.5175 308.556 81.5175C321.265 81.5175 330.087 73.7454 333.238 63.5576H325.466C323.155 70.0694 316.853 74.7956 308.661 74.7956C297.423 74.7956 290.386 66.4984 289.651 55.6805H334.078ZM308.451 32.2592C318.954 32.2592 325.781 39.2961 326.726 49.5888H289.861C291.121 39.7162 298.053 32.2592 308.451 32.2592Z\" fill=\"black\"/><path d=\"M380.477 54.8402V59.8816C380.477 69.0191 373.86 75.3208 361.152 75.3208C353.274 75.3208 348.968 72.0649 348.968 65.028C348.968 61.457 350.649 58.7263 353.274 57.2559C356.005 55.7855 359.681 54.8402 380.477 54.8402ZM360.311 81.5175C369.554 81.5175 377.011 78.5767 380.792 72.485V80.2571H387.934V45.2827C387.934 33.4145 381.107 25.5373 365.668 25.5373C350.859 25.5373 344.347 32.9944 342.982 42.5519H350.229C351.699 34.9899 357.476 31.9441 365.353 31.9441C375.435 31.9441 380.477 36.1452 380.477 45.1776V48.6436C363.567 48.6436 356.53 48.9587 351.279 51.0592C345.187 53.4749 341.616 58.8313 341.616 65.2381C341.616 74.5856 347.603 81.5175 360.311 81.5175Z\" fill=\"black\"/><path d=\"M428.703 26.3776C428.703 26.3776 427.443 26.2725 426.917 26.2725C417.045 26.2725 411.793 31.4189 409.798 35.0949V26.7977H402.656V80.2571H410.113V49.9039C410.113 38.7709 416.94 33.3094 426.077 33.3094C427.443 33.3094 428.703 33.4145 428.703 33.4145V26.3776Z\" fill=\"black\"/><path d=\"M429.976 53.5799C429.976 68.1789 440.059 81.5175 456.338 81.5175C470.832 81.5175 479.235 71.8548 481.335 61.247H473.773C471.568 69.5442 465.476 74.7956 456.338 74.7956C445.1 74.7956 437.538 65.8682 437.538 53.5799C437.538 41.1866 445.1 32.2592 456.338 32.2592C465.476 32.2592 471.568 37.5106 473.773 45.8078H481.335C479.235 35.1999 470.832 25.5373 456.338 25.5373C440.059 25.5373 429.976 38.8759 429.976 53.5799Z\" fill=\"black\"/><path d=\"M498.891 1.48584H491.434V80.2571H498.891V48.6436C498.891 37.7206 505.927 32.0491 514.96 32.0491C524.517 32.0491 529.034 37.9307 529.034 47.5933V80.2571H536.491V46.1229C536.491 34.2547 529.454 25.5373 516.22 25.5373C506.243 25.5373 500.781 30.9988 498.891 34.2547V1.48584Z\" fill=\"black\"/></svg>\n          </a>\n        </div>\n      </div>\n    </footer>\n  </div>\n  <div id=\"modal-overlay\" class=\"modal-overlay\"></div>\n  </div>\n  `;\n\n  fn.init = () => {\n    let div = document.createElement(\"div\");\n    div.innerHTML += fn.template;\n    document.body.append(div);\n\n    meilisearch = volantis.GLOBAL_CONFIG.search;\n    if (meilisearch.appId && meilisearch.apiKey && meilisearch.indexName) {\n      fn.event();\n      fn.setAlgolia();\n    } else {\n      document.querySelector('#u-search main.modal-body').innerHTML = 'Algolia setting is invalid!';\n      document.querySelector('#u-search main.modal-body').style.textAlign = 'center';\n      document.querySelector('#u-search .modal').style.maxHeight = '128px';\n    }\n  }\n\n  fn.event = () => {\n    document\n      .querySelector(\"#u-search-btn-close\")\n      .addEventListener(\"click\", fn.close, false);\n    document\n      .querySelector(\"#modal-overlay\")\n      .addEventListener(\"click\", fn.close, false);\n    document.querySelectorAll(\".u-search-form\").forEach((e) => {\n      e.addEventListener(\"submit\", fn.onSubmit, false);\n    });\n    document.querySelector(\"#meilisearch-search-input\").addEventListener(\"input\", event => {\n      let input = event.target.querySelector(\".ais-SearchBox-input\");\n      if (input) {\n        fn.queryText = input.value;\n      } else {\n        fn.queryText = event.target.value;\n      }\n    })\n  }\n\n  fn.setAlgolia = () => {\n    search = instantsearch({\n      indexName: meilisearch.indexName,\n      searchClient: instantMeiliSearch(meilisearch.appId, meilisearch.apiKey),\n      searchFunction(helper) {\n        helper.state.query && helper.search()\n      },\n    })\n\n    const configure = instantsearch.widgets.configure({\n      hitsPerPage: meilisearch.hitsPerPage\n    })\n\n    const searchBox = instantsearch.widgets.searchBox({\n      container: '#meilisearch-search-input',\n      autofocus: true,\n      showReset: false,\n      showSubmit: false,\n      showLoadingIndicator: false,\n      searchAsYouType: meilisearch.searchAsYouType,\n      placeholder: meilisearch.placeholder,\n      templates: {\n        input: 'meilisearch-input'\n      },\n      queryHook(query, refine) {\n        clearTimeout(timerId)\n        timerId = setTimeout(() => refine(query), 500)\n      }\n    })\n\n    const hits = instantsearch.widgets.hits({\n      container: '#meilisearch-hits',\n      templates: {\n        item(data) {\n          const keyword = !!fn.queryText ? `?keyword=${fn.queryText}` : ''\n          const link = data.permalink ? data.permalink : `${volantis.GLOBAL_CONFIG.root}${data.path}`\n          const result = data._highlightResult\n          const content = fn.cutContent(result.text.value)\n          return `\n            <a href=\"${link}${keyword}\" class=\"result\">\n            <span class=\"title\">${result.title.value || 'no-title'}</span>\n            <span class=\"digest\">${content}</span>\n            </a>`\n        },\n        empty: function (data) {\n          return (\n            `<div id=\"resule-hits-empty\"><i class=\"fa-solid fa-box-open\"></i><p>${volantis.GLOBAL_CONFIG.languages.search.hits_empty.replace(/\\$\\{query}/, data.query)}</p></div>`\n          )\n        }\n      }\n    })\n\n    const stats = instantsearch.widgets.stats({\n      container: '#meilisearch-info > .meilisearch-stats',\n      templates: {\n        text: function (data) {\n          const stats = volantis.GLOBAL_CONFIG.languages.search.hits_stats\n            .replace(/\\$\\{hits}/, data.nbHits)\n            .replace(/\\$\\{time}/, data.processingTimeMS)\n          return (\n            `${stats}`\n          )\n        }\n      }\n    })\n\n    search.addWidgets([searchBox, hits, stats])\n\n    search.start()\n\n  }\n\n  fn.setQueryText = queryText => {\n    fn.queryText = queryText;\n    if (!search) {\n      fn.init()\n    }\n    search?.setUiState({\n      [meilisearch.indexName]: {\n        query: queryText\n      }\n    })\n  }\n\n  fn.search = () => {\n    document.querySelector(\"#u-search\").style.display = \"block\";\n    document.addEventListener(\"keydown\", event => {\n      if (event.code === \"Escape\") {\n        fn.close();\n      }\n    }, { once: true })\n  }\n\n  fn.onSubmit = (event) => {\n    event.preventDefault();\n    let input = event.target.querySelector(\".u-search-input\");\n    fn.setQueryText(input?.value ? input.value : event.target.value)\n    fn.search();\n  };\n\n  fn.cutContent = content => {\n    if (content === '') return ''\n\n    const firstOccur = content.indexOf('<mark>')\n\n    let start = firstOccur - 30\n    let end = firstOccur + 120\n    let pre = ''\n    let post = ''\n\n    if (start <= 0) {\n      start = 0\n      end = 140\n    } else {\n      pre = '...'\n    }\n\n    if (end > content.length) {\n      end = content.length\n    } else {\n      post = '...'\n    }\n\n    let matchContent = pre + content.substring(start, end) + post\n    return matchContent\n  }\n\n  fn.close = () => {\n    document.querySelector(\"#u-search\").style.display = \"none\";\n  };\n\n  return {\n    init: fn.init,\n    setQueryText: queryText => {\n      fn.setQueryText(queryText);\n    },\n    search: fn.search,\n    close: fn.close\n  }\n})()\n\nObject.freeze(SearchService);\n\nSearchService.init();\n","source":"js/search/meilisearch.js","raw":"let SearchService = (() => {\n  const fn = {};\n  let search, meilisearch, timerId; \n  fn.queryText = null;\n  fn.template = `<div id=\"u-search\">\n  <div class=\"modal\">\n    <header class=\"modal-header\" class=\"clearfix\">\n      <button type=\"submit\" id=\"u-search-modal-btn-submit\" class=\"u-search-btn-submit\">\n        <span class=\"fa-solid fa-search\"></span>\n      </button>\n      <div id=\"meilisearch-search-input\"></div>\n      <a id=\"u-search-btn-close\" class=\"btn-close\"> <span class=\"fa-solid fa-times\"></span> </a>\n    </header>\n    <main class=\"modal-body\">\n      <div id=\"meilisearch-search-results\">\n        <div id=\"meilisearch-hits\">\n          <div class=\"search-icon\"><i class=\"fa-sharp fa-solid fa-telescope\"></i></i></div>\n        </div>\n      </div>\n    </main>\n    <footer>\n      <hr>\n      <div id=\"meilisearch-info\">\n        <div class=\"meilisearch-stats\"></div>\n        <div class=\"meilisearch-poweredBy\">\n          <a href=\"https://www.meilisearch.com\" titile=\"meilisearch\" target=\"_blank\">\n            <svg width=\"97\" height=\"20\" viewBox=\"0 0 537 83\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M49.8729 49.6398C49.8729 41.9727 53.5489 37.4565 60.5858 37.4565C67.2026 37.4565 69.4082 42.1827 69.4082 48.2744V80.9383H84.3222V46.5939C84.3222 33.7805 77.6004 24.643 64.3668 24.643C56.4897 24.643 50.9232 27.0586 46.0919 32.4151C42.941 27.5838 37.5846 24.643 30.1275 24.643C22.2504 24.643 16.7889 27.8989 14.2682 32.6251V25.9033H0.509521V80.9383H15.4236V49.3247C15.4236 41.9727 19.2046 37.4565 26.1365 37.4565C32.7532 37.4565 34.9588 42.1827 34.9588 48.2744V80.9383H49.8729V49.6398Z\" fill=\"black\"/><path d=\"M145.538 57.727C145.538 57.727 145.748 55.7314 145.748 53.3158C145.748 37.0363 134.72 24.643 118.441 24.643C102.161 24.643 90.8184 37.0363 90.8184 53.3158C90.8184 70.2253 102.266 82.1986 118.546 82.1986C131.254 82.1986 141.337 74.5315 144.593 63.3985H129.574C127.788 67.3896 123.482 69.3851 118.966 69.3851C111.509 69.3851 106.678 65.289 105.627 57.727H145.538ZM118.336 36.6162C125.268 36.6162 129.784 40.8174 130.834 47.014H105.837C107.098 40.7123 111.509 36.6162 118.336 36.6162Z\" fill=\"black\"/><path d=\"M147.947 38.7168H154.564V80.9383H169.478V25.9033H147.947V38.7168ZM162.021 18.7614C167.272 18.7614 171.054 15.0854 171.054 9.83396C171.054 4.58254 167.272 0.801514 162.021 0.801514C156.77 0.801514 152.989 4.58254 152.989 9.83396C152.989 15.0854 156.77 18.7614 162.021 18.7614Z\" fill=\"black\"/><path d=\"M200.361 68.1248C199.94 68.1248 199.31 68.2298 198.365 68.2298C195.004 68.2298 194.584 66.6544 194.584 64.3438V2.16688H179.67V65.394C179.67 76.317 183.871 81.1483 195.739 81.1483C197.735 81.1483 199.625 80.9382 200.361 80.8332V68.1248Z\" fill=\"black\"/><path d=\"M202.057 38.7168H208.674V80.9383H223.588V25.9033H202.057V38.7168ZM216.131 18.7614C221.383 18.7614 225.164 15.0854 225.164 9.83396C225.164 4.58254 221.383 0.801514 216.131 0.801514C210.88 0.801514 207.099 4.58254 207.099 9.83396C207.099 15.0854 210.88 18.7614 216.131 18.7614Z\" fill=\"black\"/><path d=\"M253.531 81.5175C268.025 81.5175 274.852 73.8504 274.852 65.7632C274.852 43.2871 241.768 55.7855 241.768 40.9765C241.768 36.1452 245.864 32.0491 254.161 32.0491C262.669 32.0491 266.66 36.6703 267.29 42.4469H274.747C274.117 35.1999 269.18 25.5373 254.371 25.5373C241.663 25.5373 234.521 33.0994 234.521 41.2916C234.521 63.2425 267.605 50.6391 267.605 65.9733C267.605 71.3297 262.564 75.0057 253.531 75.0057C244.289 75.0057 239.667 70.3845 239.142 63.5576H231.58C232.21 72.9051 238.092 81.5175 253.531 81.5175Z\" fill=\"black\"/><path d=\"M334.078 55.6805C334.078 55.6805 334.183 54 334.183 52.8447C334.183 37.7206 324.415 25.5373 308.451 25.5373C292.382 25.5373 282.194 38.6659 282.194 53.4749C282.194 68.4939 291.647 81.5175 308.556 81.5175C321.265 81.5175 330.087 73.7454 333.238 63.5576H325.466C323.155 70.0694 316.853 74.7956 308.661 74.7956C297.423 74.7956 290.386 66.4984 289.651 55.6805H334.078ZM308.451 32.2592C318.954 32.2592 325.781 39.2961 326.726 49.5888H289.861C291.121 39.7162 298.053 32.2592 308.451 32.2592Z\" fill=\"black\"/><path d=\"M380.477 54.8402V59.8816C380.477 69.0191 373.86 75.3208 361.152 75.3208C353.274 75.3208 348.968 72.0649 348.968 65.028C348.968 61.457 350.649 58.7263 353.274 57.2559C356.005 55.7855 359.681 54.8402 380.477 54.8402ZM360.311 81.5175C369.554 81.5175 377.011 78.5767 380.792 72.485V80.2571H387.934V45.2827C387.934 33.4145 381.107 25.5373 365.668 25.5373C350.859 25.5373 344.347 32.9944 342.982 42.5519H350.229C351.699 34.9899 357.476 31.9441 365.353 31.9441C375.435 31.9441 380.477 36.1452 380.477 45.1776V48.6436C363.567 48.6436 356.53 48.9587 351.279 51.0592C345.187 53.4749 341.616 58.8313 341.616 65.2381C341.616 74.5856 347.603 81.5175 360.311 81.5175Z\" fill=\"black\"/><path d=\"M428.703 26.3776C428.703 26.3776 427.443 26.2725 426.917 26.2725C417.045 26.2725 411.793 31.4189 409.798 35.0949V26.7977H402.656V80.2571H410.113V49.9039C410.113 38.7709 416.94 33.3094 426.077 33.3094C427.443 33.3094 428.703 33.4145 428.703 33.4145V26.3776Z\" fill=\"black\"/><path d=\"M429.976 53.5799C429.976 68.1789 440.059 81.5175 456.338 81.5175C470.832 81.5175 479.235 71.8548 481.335 61.247H473.773C471.568 69.5442 465.476 74.7956 456.338 74.7956C445.1 74.7956 437.538 65.8682 437.538 53.5799C437.538 41.1866 445.1 32.2592 456.338 32.2592C465.476 32.2592 471.568 37.5106 473.773 45.8078H481.335C479.235 35.1999 470.832 25.5373 456.338 25.5373C440.059 25.5373 429.976 38.8759 429.976 53.5799Z\" fill=\"black\"/><path d=\"M498.891 1.48584H491.434V80.2571H498.891V48.6436C498.891 37.7206 505.927 32.0491 514.96 32.0491C524.517 32.0491 529.034 37.9307 529.034 47.5933V80.2571H536.491V46.1229C536.491 34.2547 529.454 25.5373 516.22 25.5373C506.243 25.5373 500.781 30.9988 498.891 34.2547V1.48584Z\" fill=\"black\"/></svg>\n          </a>\n        </div>\n      </div>\n    </footer>\n  </div>\n  <div id=\"modal-overlay\" class=\"modal-overlay\"></div>\n  </div>\n  `;\n\n  fn.init = () => {\n    let div = document.createElement(\"div\");\n    div.innerHTML += fn.template;\n    document.body.append(div);\n\n    meilisearch = volantis.GLOBAL_CONFIG.search;\n    if (meilisearch.appId && meilisearch.apiKey && meilisearch.indexName) {\n      fn.event();\n      fn.setAlgolia();\n    } else {\n      document.querySelector('#u-search main.modal-body').innerHTML = 'Algolia setting is invalid!';\n      document.querySelector('#u-search main.modal-body').style.textAlign = 'center';\n      document.querySelector('#u-search .modal').style.maxHeight = '128px';\n    }\n  }\n\n  fn.event = () => {\n    document\n      .querySelector(\"#u-search-btn-close\")\n      .addEventListener(\"click\", fn.close, false);\n    document\n      .querySelector(\"#modal-overlay\")\n      .addEventListener(\"click\", fn.close, false);\n    document.querySelectorAll(\".u-search-form\").forEach((e) => {\n      e.addEventListener(\"submit\", fn.onSubmit, false);\n    });\n    document.querySelector(\"#meilisearch-search-input\").addEventListener(\"input\", event => {\n      let input = event.target.querySelector(\".ais-SearchBox-input\");\n      if (input) {\n        fn.queryText = input.value;\n      } else {\n        fn.queryText = event.target.value;\n      }\n    })\n  }\n\n  fn.setAlgolia = () => {\n    search = instantsearch({\n      indexName: meilisearch.indexName,\n      searchClient: instantMeiliSearch(meilisearch.appId, meilisearch.apiKey),\n      searchFunction(helper) {\n        helper.state.query && helper.search()\n      },\n    })\n\n    const configure = instantsearch.widgets.configure({\n      hitsPerPage: meilisearch.hitsPerPage\n    })\n\n    const searchBox = instantsearch.widgets.searchBox({\n      container: '#meilisearch-search-input',\n      autofocus: true,\n      showReset: false,\n      showSubmit: false,\n      showLoadingIndicator: false,\n      searchAsYouType: meilisearch.searchAsYouType,\n      placeholder: meilisearch.placeholder,\n      templates: {\n        input: 'meilisearch-input'\n      },\n      queryHook(query, refine) {\n        clearTimeout(timerId)\n        timerId = setTimeout(() => refine(query), 500)\n      }\n    })\n\n    const hits = instantsearch.widgets.hits({\n      container: '#meilisearch-hits',\n      templates: {\n        item(data) {\n          const keyword = !!fn.queryText ? `?keyword=${fn.queryText}` : ''\n          const link = data.permalink ? data.permalink : `${volantis.GLOBAL_CONFIG.root}${data.path}`\n          const result = data._highlightResult\n          const content = fn.cutContent(result.text.value)\n          return `\n            <a href=\"${link}${keyword}\" class=\"result\">\n            <span class=\"title\">${result.title.value || 'no-title'}</span>\n            <span class=\"digest\">${content}</span>\n            </a>`\n        },\n        empty: function (data) {\n          return (\n            `<div id=\"resule-hits-empty\"><i class=\"fa-solid fa-box-open\"></i><p>${volantis.GLOBAL_CONFIG.languages.search.hits_empty.replace(/\\$\\{query}/, data.query)}</p></div>`\n          )\n        }\n      }\n    })\n\n    const stats = instantsearch.widgets.stats({\n      container: '#meilisearch-info > .meilisearch-stats',\n      templates: {\n        text: function (data) {\n          const stats = volantis.GLOBAL_CONFIG.languages.search.hits_stats\n            .replace(/\\$\\{hits}/, data.nbHits)\n            .replace(/\\$\\{time}/, data.processingTimeMS)\n          return (\n            `${stats}`\n          )\n        }\n      }\n    })\n\n    search.addWidgets([searchBox, hits, stats])\n\n    search.start()\n\n  }\n\n  fn.setQueryText = queryText => {\n    fn.queryText = queryText;\n    if (!search) {\n      fn.init()\n    }\n    search?.setUiState({\n      [meilisearch.indexName]: {\n        query: queryText\n      }\n    })\n  }\n\n  fn.search = () => {\n    document.querySelector(\"#u-search\").style.display = \"block\";\n    document.addEventListener(\"keydown\", event => {\n      if (event.code === \"Escape\") {\n        fn.close();\n      }\n    }, { once: true })\n  }\n\n  fn.onSubmit = (event) => {\n    event.preventDefault();\n    let input = event.target.querySelector(\".u-search-input\");\n    fn.setQueryText(input?.value ? input.value : event.target.value)\n    fn.search();\n  };\n\n  fn.cutContent = content => {\n    if (content === '') return ''\n\n    const firstOccur = content.indexOf('<mark>')\n\n    let start = firstOccur - 30\n    let end = firstOccur + 120\n    let pre = ''\n    let post = ''\n\n    if (start <= 0) {\n      start = 0\n      end = 140\n    } else {\n      pre = '...'\n    }\n\n    if (end > content.length) {\n      end = content.length\n    } else {\n      post = '...'\n    }\n\n    let matchContent = pre + content.substring(start, end) + post\n    return matchContent\n  }\n\n  fn.close = () => {\n    document.querySelector(\"#u-search\").style.display = \"none\";\n  };\n\n  return {\n    init: fn.init,\n    setQueryText: queryText => {\n      fn.setQueryText(queryText);\n    },\n    search: fn.search,\n    close: fn.close\n  }\n})()\n\nObject.freeze(SearchService);\n\nSearchService.init();\n","date":"2022-12-27T15:15:09.555Z","updated":"2022-12-27T15:15:09.555Z","path":"js/search/meilisearch.js","layout":"false","title":"","comments":1,"_id":"clc6k3sfb00076cu9ff7l7w4g"},{"_content":"let SearchService = (() => {\n  const fn = {};\n  fn.queryText = null;\n  fn.data = null;\n  fn.template = `<div id=\"u-search\">\n  <div class=\"modal\">\n    <header class=\"modal-header\" class=\"clearfix\">\n      <form id=\"u-search-modal-form\" class=\"u-search-form\" name=\"uSearchModalForm\">\n        <input type=\"text\" id=\"u-search-modal-input\" class=\"u-search-input\" />\n        <button type=\"submit\" id=\"u-search-modal-btn-submit\" class=\"u-search-btn-submit\">\n          <span class=\"fa-solid fa-search\"></span>\n        </button>\n      </form>\n      <a id=\"u-search-btn-close\" class=\"btn-close\"> <span class=\"fa-solid fa-times\"></span> </a>\n    </header>\n    <main class=\"modal-body\">\n      <ul class=\"modal-results\"></ul>\n    </main>\n  </div>\n  <div id=\"modal-overlay\" class=\"modal-overlay\"></div>\n</div>\n`;\n  fn.init = async () => {\n    let div = document.createElement(\"div\");\n    div.innerHTML += fn.template;\n    document.body.append(div);\n    document.querySelectorAll(\".u-search-form\").forEach((e) => {\n      e.addEventListener(\"submit\", fn.onSubmit, false);\n    });\n    let uSearchModalInput = document.querySelector(\"#u-search-modal-input\");\n    uSearchModalInput.addEventListener(\"input\", fn.onSubmit);\n    document\n      .querySelector(\"#u-search-btn-close\")\n      .addEventListener(\"click\", fn.close, false);\n    document\n      .querySelector(\"#modal-overlay\")\n      .addEventListener(\"click\", fn.close, false);\n    if (!fn.data) {\n      fn.data = await fn.fetchData();\n    }\n  };\n  fn.onSubmit = (event) => {\n    event.preventDefault();\n    let input = event.target.querySelector(\".u-search-input\");\n    if (input) {\n      fn.queryText = input.value;\n    } else {\n      fn.queryText = event.target.value;\n    }\n\n    if (fn.queryText) {\n      fn.search();\n    }\n  };\n  fn.search = async () => {\n    document.querySelectorAll(\".u-search-input\").forEach((e) => {\n      e.value = fn.queryText;\n    });\n    document.querySelector(\"#u-search\").style.display = \"block\";\n    if (!fn.data) {\n      fn.data = await fn.fetchData();\n    }\n    let results = \"\";\n    results += fn.buildResultList(fn.data.pages);\n    results += fn.buildResultList(fn.data.posts);\n    if (results === \"\") {\n      results = `<div id=\"resule-hits-empty\"><i class=\"fa-solid fa-box-open\"></i><p>${volantis.GLOBAL_CONFIG.languages.search.hits_empty.replace(/\\$\\{query}/, fn.queryText)}</p></div>`\n    }\n    document.querySelector(\"#u-search .modal-results\").innerHTML = results;\n    document.addEventListener(\"keydown\", function f(event) {\n      if (event.code === \"Escape\") {\n        fn.close();\n        document.removeEventListener(\"keydown\", f);\n      }\n    });\n  };\n  fn.close = () => {\n    document.querySelector(\"#u-search\").style.display = \"none\";\n  };\n  fn.fetchData = () => {\n    return fetch(volantis.GLOBAL_CONFIG.search.dataPath)\n      .then((response) => response.text())\n      .then((res) => {\n        const data = JSON.parse(res);\n        // console.log(data);\n        return data;\n      });\n  };\n  fn.buildResultList = (data) => {\n    let html = \"\";\n    data.forEach((post) => {\n      if (post.text) {\n        post.text = post.text.replace(/12345\\d*/g, \"\") // 简易移除代码行号\n      }\n      if (!post.title && post.text) {\n        post.title = post.text.trim().slice(0, 15)\n      }\n      if (fn.contentSearch(post)) {\n        html += fn.buildResult(post.permalink, post.title, post.digest);\n      }\n    });\n    return html;\n  };\n  fn.contentSearch = (post) => {\n    let post_title = post.title.trim().toLowerCase();\n    let post_content = post.text.trim().toLowerCase();\n    let keywords = fn.queryText\n      .trim()\n      .toLowerCase()\n      .split(/[-\\s]+/);\n    let foundMatch = false;\n    let index_title = -1;\n    let index_content = -1;\n    let first_occur = -1;\n    if (post_title && post_content) {\n      keywords.forEach((word, index) => {\n        index_title = post_title.indexOf(word);\n        index_content = post_content.indexOf(word);\n        if (index_title < 0 && index_content < 0) {\n          foundMatch = false;\n        } else {\n          foundMatch = true;\n          if (index_content < 0) {\n            index_content = 0;\n          }\n          if (index === 0) {\n            first_occur = index_content;\n          }\n        }\n        if (foundMatch) {\n          post_content = post.text.trim();\n          let start = 0;\n          let end = 0;\n          if (first_occur >= 0) {\n            start = Math.max(first_occur - 40, 0);\n            end =\n              start === 0\n                ? Math.min(200, post_content.length)\n                : Math.min(first_occur + 120, post_content.length);\n            let match_content = post_content.substring(start, end);\n            keywords.forEach(function (keyword) {\n              let regS = new RegExp(keyword, \"gi\");\n              match_content = match_content.replace(\n                regS,\n                \"<b mark>\" + keyword + \"</b>\"\n              );\n            });\n            post.digest = match_content + \"......\";\n          } else {\n            end = Math.min(200, post_content.length);\n            post.digest = post_content.trim().substring(0, end);\n          }\n        }\n      });\n    }\n    return foundMatch;\n  };\n  fn.buildResult = (url, title, digest) => {\n    let result = fn.getUrlRelativePath(url);\n    let html = \"\";\n    html += \"<li>\";\n    html +=\n      \"<a class='result' href='\" + result + \"?keyword=\" + fn.queryText + \"'>\";\n    html += \"<span class='title'>\" + title + \"</span>\";\n    if (digest !== \"\") html += \"<span class='digest'>\" + digest + \"</span>\";\n    html += \"</a>\";\n    html += \"</li>\";\n    return html;\n  };\n  fn.getUrlRelativePath = function (url) {\n    let arrUrl = url.split(\"//\");\n    let start = arrUrl[1].indexOf(\"/\");\n    let relUrl = arrUrl[1].substring(start);\n    if (relUrl.indexOf(\"?\") != -1) {\n      relUrl = relUrl.split(\"?\")[0];\n    }\n    return relUrl;\n  };\n  return {\n    init: () => {\n      fn.init();\n    },\n    setQueryText: (queryText) => {\n      fn.queryText = queryText;\n    },\n    search: () => {\n      fn.search();\n    },\n  };\n})();\nObject.freeze(SearchService);\n\nSearchService.init();\n","source":"js/search/hexo.js","raw":"let SearchService = (() => {\n  const fn = {};\n  fn.queryText = null;\n  fn.data = null;\n  fn.template = `<div id=\"u-search\">\n  <div class=\"modal\">\n    <header class=\"modal-header\" class=\"clearfix\">\n      <form id=\"u-search-modal-form\" class=\"u-search-form\" name=\"uSearchModalForm\">\n        <input type=\"text\" id=\"u-search-modal-input\" class=\"u-search-input\" />\n        <button type=\"submit\" id=\"u-search-modal-btn-submit\" class=\"u-search-btn-submit\">\n          <span class=\"fa-solid fa-search\"></span>\n        </button>\n      </form>\n      <a id=\"u-search-btn-close\" class=\"btn-close\"> <span class=\"fa-solid fa-times\"></span> </a>\n    </header>\n    <main class=\"modal-body\">\n      <ul class=\"modal-results\"></ul>\n    </main>\n  </div>\n  <div id=\"modal-overlay\" class=\"modal-overlay\"></div>\n</div>\n`;\n  fn.init = async () => {\n    let div = document.createElement(\"div\");\n    div.innerHTML += fn.template;\n    document.body.append(div);\n    document.querySelectorAll(\".u-search-form\").forEach((e) => {\n      e.addEventListener(\"submit\", fn.onSubmit, false);\n    });\n    let uSearchModalInput = document.querySelector(\"#u-search-modal-input\");\n    uSearchModalInput.addEventListener(\"input\", fn.onSubmit);\n    document\n      .querySelector(\"#u-search-btn-close\")\n      .addEventListener(\"click\", fn.close, false);\n    document\n      .querySelector(\"#modal-overlay\")\n      .addEventListener(\"click\", fn.close, false);\n    if (!fn.data) {\n      fn.data = await fn.fetchData();\n    }\n  };\n  fn.onSubmit = (event) => {\n    event.preventDefault();\n    let input = event.target.querySelector(\".u-search-input\");\n    if (input) {\n      fn.queryText = input.value;\n    } else {\n      fn.queryText = event.target.value;\n    }\n\n    if (fn.queryText) {\n      fn.search();\n    }\n  };\n  fn.search = async () => {\n    document.querySelectorAll(\".u-search-input\").forEach((e) => {\n      e.value = fn.queryText;\n    });\n    document.querySelector(\"#u-search\").style.display = \"block\";\n    if (!fn.data) {\n      fn.data = await fn.fetchData();\n    }\n    let results = \"\";\n    results += fn.buildResultList(fn.data.pages);\n    results += fn.buildResultList(fn.data.posts);\n    if (results === \"\") {\n      results = `<div id=\"resule-hits-empty\"><i class=\"fa-solid fa-box-open\"></i><p>${volantis.GLOBAL_CONFIG.languages.search.hits_empty.replace(/\\$\\{query}/, fn.queryText)}</p></div>`\n    }\n    document.querySelector(\"#u-search .modal-results\").innerHTML = results;\n    document.addEventListener(\"keydown\", function f(event) {\n      if (event.code === \"Escape\") {\n        fn.close();\n        document.removeEventListener(\"keydown\", f);\n      }\n    });\n  };\n  fn.close = () => {\n    document.querySelector(\"#u-search\").style.display = \"none\";\n  };\n  fn.fetchData = () => {\n    return fetch(volantis.GLOBAL_CONFIG.search.dataPath)\n      .then((response) => response.text())\n      .then((res) => {\n        const data = JSON.parse(res);\n        // console.log(data);\n        return data;\n      });\n  };\n  fn.buildResultList = (data) => {\n    let html = \"\";\n    data.forEach((post) => {\n      if (post.text) {\n        post.text = post.text.replace(/12345\\d*/g, \"\") // 简易移除代码行号\n      }\n      if (!post.title && post.text) {\n        post.title = post.text.trim().slice(0, 15)\n      }\n      if (fn.contentSearch(post)) {\n        html += fn.buildResult(post.permalink, post.title, post.digest);\n      }\n    });\n    return html;\n  };\n  fn.contentSearch = (post) => {\n    let post_title = post.title.trim().toLowerCase();\n    let post_content = post.text.trim().toLowerCase();\n    let keywords = fn.queryText\n      .trim()\n      .toLowerCase()\n      .split(/[-\\s]+/);\n    let foundMatch = false;\n    let index_title = -1;\n    let index_content = -1;\n    let first_occur = -1;\n    if (post_title && post_content) {\n      keywords.forEach((word, index) => {\n        index_title = post_title.indexOf(word);\n        index_content = post_content.indexOf(word);\n        if (index_title < 0 && index_content < 0) {\n          foundMatch = false;\n        } else {\n          foundMatch = true;\n          if (index_content < 0) {\n            index_content = 0;\n          }\n          if (index === 0) {\n            first_occur = index_content;\n          }\n        }\n        if (foundMatch) {\n          post_content = post.text.trim();\n          let start = 0;\n          let end = 0;\n          if (first_occur >= 0) {\n            start = Math.max(first_occur - 40, 0);\n            end =\n              start === 0\n                ? Math.min(200, post_content.length)\n                : Math.min(first_occur + 120, post_content.length);\n            let match_content = post_content.substring(start, end);\n            keywords.forEach(function (keyword) {\n              let regS = new RegExp(keyword, \"gi\");\n              match_content = match_content.replace(\n                regS,\n                \"<b mark>\" + keyword + \"</b>\"\n              );\n            });\n            post.digest = match_content + \"......\";\n          } else {\n            end = Math.min(200, post_content.length);\n            post.digest = post_content.trim().substring(0, end);\n          }\n        }\n      });\n    }\n    return foundMatch;\n  };\n  fn.buildResult = (url, title, digest) => {\n    let result = fn.getUrlRelativePath(url);\n    let html = \"\";\n    html += \"<li>\";\n    html +=\n      \"<a class='result' href='\" + result + \"?keyword=\" + fn.queryText + \"'>\";\n    html += \"<span class='title'>\" + title + \"</span>\";\n    if (digest !== \"\") html += \"<span class='digest'>\" + digest + \"</span>\";\n    html += \"</a>\";\n    html += \"</li>\";\n    return html;\n  };\n  fn.getUrlRelativePath = function (url) {\n    let arrUrl = url.split(\"//\");\n    let start = arrUrl[1].indexOf(\"/\");\n    let relUrl = arrUrl[1].substring(start);\n    if (relUrl.indexOf(\"?\") != -1) {\n      relUrl = relUrl.split(\"?\")[0];\n    }\n    return relUrl;\n  };\n  return {\n    init: () => {\n      fn.init();\n    },\n    setQueryText: (queryText) => {\n      fn.queryText = queryText;\n    },\n    search: () => {\n      fn.search();\n    },\n  };\n})();\nObject.freeze(SearchService);\n\nSearchService.init();\n","date":"2022-12-27T15:15:09.555Z","updated":"2022-12-27T15:15:09.555Z","path":"js/search/hexo.js","layout":"false","title":"","comments":1,"_id":"clc6k3sfd00086cu990t14mbe"},{"_content":"let SearchService = (() => {\n  const fn = {};\n  let search, algolia, timerId; \n  fn.queryText = null;\n  fn.template = `<div id=\"u-search\">\n  <div class=\"modal\">\n    <header class=\"modal-header\" class=\"clearfix\">\n      <button type=\"submit\" id=\"u-search-modal-btn-submit\" class=\"u-search-btn-submit\">\n        <span class=\"fa-solid fa-search\"></span>\n      </button>\n      <div id=\"algolia-search-input\"></div>\n      <a id=\"u-search-btn-close\" class=\"btn-close\"> <span class=\"fa-solid fa-times\"></span> </a>\n    </header>\n    <main class=\"modal-body\">\n      <div id=\"algolia-search-results\">\n        <div id=\"algolia-hits\">\n          <div class=\"search-icon\"><i class=\"fa-sharp fa-solid fa-telescope\"></i></i></div>\n        </div>\n      </div>\n    </main>\n    <footer>\n      <div id=\"algolia-pagination\"></div>\n      <hr>\n      <div id=\"algolia-info\">\n        <div class=\"algolia-stats\"></div>\n        <div class=\"algolia-poweredBy\"></div>\n      </div>\n    </footer>\n  </div>\n  <div id=\"modal-overlay\" class=\"modal-overlay\"></div>\n  </div>\n  `;\n\n  fn.init = () => {\n    let div = document.createElement(\"div\");\n    div.innerHTML += fn.template;\n    document.body.append(div);\n\n    algolia = volantis.GLOBAL_CONFIG.search;\n    if (algolia.appId && algolia.apiKey && algolia.indexName) {\n      fn.event();\n      fn.setAlgolia();\n    } else {\n      document.querySelector('#u-search main.modal-body').innerHTML = 'Algolia setting is invalid!';\n      document.querySelector('#u-search main.modal-body').style.textAlign = 'center';\n      document.querySelector('#u-search .modal').style.maxHeight = '128px';\n    }\n  }\n\n  fn.event = () => {\n    document\n      .querySelector(\"#u-search-btn-close\")\n      .addEventListener(\"click\", fn.close, false);\n    document\n      .querySelector(\"#modal-overlay\")\n      .addEventListener(\"click\", fn.close, false);\n    document.querySelectorAll(\".u-search-form\").forEach((e) => {\n      e.addEventListener(\"submit\", fn.onSubmit, false);\n    });\n    document.querySelector(\"#algolia-search-input\").addEventListener(\"input\", event => {\n      let input = event.target.querySelector(\".ais-SearchBox-input\");\n      if (input) {\n        fn.queryText = input.value;\n      } else {\n        fn.queryText = event.target.value;\n      }\n    })\n  }\n\n  fn.setAlgolia = () => {\n    search = instantsearch({\n      indexName: algolia.indexName,\n      searchClient: algoliasearch(algolia.appId, algolia.apiKey),\n      searchFunction(helper) {\n        helper.state.query && helper.search()\n      },\n    })\n\n    const configure = instantsearch.widgets.configure({\n      hitsPerPage: algolia.hitsPerPage\n    })\n\n    const searchBox = instantsearch.widgets.searchBox({\n      container: '#algolia-search-input',\n      autofocus: true,\n      showReset: false,\n      showSubmit: false,\n      showLoadingIndicator: false,\n      searchAsYouType: algolia.searchAsYouType,\n      placeholder: algolia.placeholder,\n      templates: {\n        input: 'algolia-input'\n      },\n      queryHook(query, refine) {\n        clearTimeout(timerId)\n        timerId = setTimeout(() => refine(query), 500)\n      }\n    })\n\n    const hits = instantsearch.widgets.hits({\n      container: '#algolia-hits',\n      templates: {\n        item(data) {\n          const keyword = !!fn.queryText ? `?keyword=${fn.queryText}` : ''\n          const link = data.permalink ? data.permalink : `${volantis.GLOBAL_CONFIG.root}${data.path}`\n          const result = data._highlightResult\n          const content = result.contentStripTruncate\n            ? fn.cutContent(result.contentStripTruncate.value)\n            : result.contentStrip\n              ? fn.cutContent(result.contentStrip.value)\n              : result.content\n                ? fn.cutContent(result.content.value)\n                : ''\n          return `\n            <a href=\"${link}${keyword}\" class=\"result\">\n            <span class=\"title\">${result.title.value || 'no-title'}</span>\n            <span class=\"digest\">${content}</span>\n            </a>`\n        },\n        empty: function (data) {\n          return (\n            `<div id=\"resule-hits-empty\"><i class=\"fa-solid fa-box-open\"></i><p>${volantis.GLOBAL_CONFIG.languages.search.hits_empty.replace(/\\$\\{query}/, data.query)}</p></div>`\n          )\n        }\n      }\n    })\n\n    const stats = instantsearch.widgets.stats({\n      container: '#algolia-info > .algolia-stats',\n      templates: {\n        text: function (data) {\n          const stats = volantis.GLOBAL_CONFIG.languages.search.hits_stats\n            .replace(/\\$\\{hits}/, data.nbHits)\n            .replace(/\\$\\{time}/, data.processingTimeMS)\n          return (\n            `${stats}`\n          )\n        }\n      }\n    })\n\n    const powerBy = instantsearch.widgets.poweredBy({\n      container: '#algolia-info > .algolia-poweredBy',\n      theme: volantis.dark?.mode === 'dark' ? 'dark' : 'light'\n    })\n\n    const pagination = instantsearch.widgets.pagination({\n      container: '#algolia-pagination',\n      totalPages: 5,\n      templates: {\n        first: '<i class=\"fas fa-angle-double-left\"></i>',\n        last: '<i class=\"fas fa-angle-double-right\"></i>',\n        previous: '<i class=\"fas fa-angle-left\"></i>',\n        next: '<i class=\"fas fa-angle-right\"></i>'\n      }\n    })\n\n    search.addWidgets([configure, searchBox, hits, stats, powerBy, pagination])\n\n    search.start()\n\n  }\n\n  fn.setQueryText = queryText => {\n    fn.queryText = queryText;\n    if (!search) {\n      fn.init()\n    }\n    search?.setUiState({\n      [algolia.indexName]: {\n        query: queryText\n      }\n    })\n  }\n\n  fn.search = () => {\n    document.querySelector(\"#u-search\").style.display = \"block\";\n    document.addEventListener(\"keydown\", event => {\n      if (event.code === \"Escape\") {\n        fn.close();\n      }\n    }, { once: true })\n  }\n\n  fn.onSubmit = (event) => {\n    event.preventDefault();\n    let input = event.target.querySelector(\".u-search-input\");\n    fn.setQueryText(input?.value ? input.value : event.target.value)\n    fn.search();\n  };\n\n  fn.cutContent = content => {\n    if (content === '') return ''\n\n    const firstOccur = content.indexOf('<mark>')\n\n    let start = firstOccur - 30\n    let end = firstOccur + 120\n    let pre = ''\n    let post = ''\n\n    if (start <= 0) {\n      start = 0\n      end = 140\n    } else {\n      pre = '...'\n    }\n\n    if (end > content.length) {\n      end = content.length\n    } else {\n      post = '...'\n    }\n\n    let matchContent = pre + content.substring(start, end) + post\n    return matchContent\n  }\n\n  fn.close = () => {\n    document.querySelector(\"#u-search\").style.display = \"none\";\n  };\n\n  return {\n    init: fn.init,\n    setQueryText: queryText => {\n      fn.setQueryText(queryText);\n    },\n    search: fn.search,\n    close: fn.close\n  }\n})()\n\nObject.freeze(SearchService);\n\nSearchService.init();\n","source":"js/search/algolia.js","raw":"let SearchService = (() => {\n  const fn = {};\n  let search, algolia, timerId; \n  fn.queryText = null;\n  fn.template = `<div id=\"u-search\">\n  <div class=\"modal\">\n    <header class=\"modal-header\" class=\"clearfix\">\n      <button type=\"submit\" id=\"u-search-modal-btn-submit\" class=\"u-search-btn-submit\">\n        <span class=\"fa-solid fa-search\"></span>\n      </button>\n      <div id=\"algolia-search-input\"></div>\n      <a id=\"u-search-btn-close\" class=\"btn-close\"> <span class=\"fa-solid fa-times\"></span> </a>\n    </header>\n    <main class=\"modal-body\">\n      <div id=\"algolia-search-results\">\n        <div id=\"algolia-hits\">\n          <div class=\"search-icon\"><i class=\"fa-sharp fa-solid fa-telescope\"></i></i></div>\n        </div>\n      </div>\n    </main>\n    <footer>\n      <div id=\"algolia-pagination\"></div>\n      <hr>\n      <div id=\"algolia-info\">\n        <div class=\"algolia-stats\"></div>\n        <div class=\"algolia-poweredBy\"></div>\n      </div>\n    </footer>\n  </div>\n  <div id=\"modal-overlay\" class=\"modal-overlay\"></div>\n  </div>\n  `;\n\n  fn.init = () => {\n    let div = document.createElement(\"div\");\n    div.innerHTML += fn.template;\n    document.body.append(div);\n\n    algolia = volantis.GLOBAL_CONFIG.search;\n    if (algolia.appId && algolia.apiKey && algolia.indexName) {\n      fn.event();\n      fn.setAlgolia();\n    } else {\n      document.querySelector('#u-search main.modal-body').innerHTML = 'Algolia setting is invalid!';\n      document.querySelector('#u-search main.modal-body').style.textAlign = 'center';\n      document.querySelector('#u-search .modal').style.maxHeight = '128px';\n    }\n  }\n\n  fn.event = () => {\n    document\n      .querySelector(\"#u-search-btn-close\")\n      .addEventListener(\"click\", fn.close, false);\n    document\n      .querySelector(\"#modal-overlay\")\n      .addEventListener(\"click\", fn.close, false);\n    document.querySelectorAll(\".u-search-form\").forEach((e) => {\n      e.addEventListener(\"submit\", fn.onSubmit, false);\n    });\n    document.querySelector(\"#algolia-search-input\").addEventListener(\"input\", event => {\n      let input = event.target.querySelector(\".ais-SearchBox-input\");\n      if (input) {\n        fn.queryText = input.value;\n      } else {\n        fn.queryText = event.target.value;\n      }\n    })\n  }\n\n  fn.setAlgolia = () => {\n    search = instantsearch({\n      indexName: algolia.indexName,\n      searchClient: algoliasearch(algolia.appId, algolia.apiKey),\n      searchFunction(helper) {\n        helper.state.query && helper.search()\n      },\n    })\n\n    const configure = instantsearch.widgets.configure({\n      hitsPerPage: algolia.hitsPerPage\n    })\n\n    const searchBox = instantsearch.widgets.searchBox({\n      container: '#algolia-search-input',\n      autofocus: true,\n      showReset: false,\n      showSubmit: false,\n      showLoadingIndicator: false,\n      searchAsYouType: algolia.searchAsYouType,\n      placeholder: algolia.placeholder,\n      templates: {\n        input: 'algolia-input'\n      },\n      queryHook(query, refine) {\n        clearTimeout(timerId)\n        timerId = setTimeout(() => refine(query), 500)\n      }\n    })\n\n    const hits = instantsearch.widgets.hits({\n      container: '#algolia-hits',\n      templates: {\n        item(data) {\n          const keyword = !!fn.queryText ? `?keyword=${fn.queryText}` : ''\n          const link = data.permalink ? data.permalink : `${volantis.GLOBAL_CONFIG.root}${data.path}`\n          const result = data._highlightResult\n          const content = result.contentStripTruncate\n            ? fn.cutContent(result.contentStripTruncate.value)\n            : result.contentStrip\n              ? fn.cutContent(result.contentStrip.value)\n              : result.content\n                ? fn.cutContent(result.content.value)\n                : ''\n          return `\n            <a href=\"${link}${keyword}\" class=\"result\">\n            <span class=\"title\">${result.title.value || 'no-title'}</span>\n            <span class=\"digest\">${content}</span>\n            </a>`\n        },\n        empty: function (data) {\n          return (\n            `<div id=\"resule-hits-empty\"><i class=\"fa-solid fa-box-open\"></i><p>${volantis.GLOBAL_CONFIG.languages.search.hits_empty.replace(/\\$\\{query}/, data.query)}</p></div>`\n          )\n        }\n      }\n    })\n\n    const stats = instantsearch.widgets.stats({\n      container: '#algolia-info > .algolia-stats',\n      templates: {\n        text: function (data) {\n          const stats = volantis.GLOBAL_CONFIG.languages.search.hits_stats\n            .replace(/\\$\\{hits}/, data.nbHits)\n            .replace(/\\$\\{time}/, data.processingTimeMS)\n          return (\n            `${stats}`\n          )\n        }\n      }\n    })\n\n    const powerBy = instantsearch.widgets.poweredBy({\n      container: '#algolia-info > .algolia-poweredBy',\n      theme: volantis.dark?.mode === 'dark' ? 'dark' : 'light'\n    })\n\n    const pagination = instantsearch.widgets.pagination({\n      container: '#algolia-pagination',\n      totalPages: 5,\n      templates: {\n        first: '<i class=\"fas fa-angle-double-left\"></i>',\n        last: '<i class=\"fas fa-angle-double-right\"></i>',\n        previous: '<i class=\"fas fa-angle-left\"></i>',\n        next: '<i class=\"fas fa-angle-right\"></i>'\n      }\n    })\n\n    search.addWidgets([configure, searchBox, hits, stats, powerBy, pagination])\n\n    search.start()\n\n  }\n\n  fn.setQueryText = queryText => {\n    fn.queryText = queryText;\n    if (!search) {\n      fn.init()\n    }\n    search?.setUiState({\n      [algolia.indexName]: {\n        query: queryText\n      }\n    })\n  }\n\n  fn.search = () => {\n    document.querySelector(\"#u-search\").style.display = \"block\";\n    document.addEventListener(\"keydown\", event => {\n      if (event.code === \"Escape\") {\n        fn.close();\n      }\n    }, { once: true })\n  }\n\n  fn.onSubmit = (event) => {\n    event.preventDefault();\n    let input = event.target.querySelector(\".u-search-input\");\n    fn.setQueryText(input?.value ? input.value : event.target.value)\n    fn.search();\n  };\n\n  fn.cutContent = content => {\n    if (content === '') return ''\n\n    const firstOccur = content.indexOf('<mark>')\n\n    let start = firstOccur - 30\n    let end = firstOccur + 120\n    let pre = ''\n    let post = ''\n\n    if (start <= 0) {\n      start = 0\n      end = 140\n    } else {\n      pre = '...'\n    }\n\n    if (end > content.length) {\n      end = content.length\n    } else {\n      post = '...'\n    }\n\n    let matchContent = pre + content.substring(start, end) + post\n    return matchContent\n  }\n\n  fn.close = () => {\n    document.querySelector(\"#u-search\").style.display = \"none\";\n  };\n\n  return {\n    init: fn.init,\n    setQueryText: queryText => {\n      fn.setQueryText(queryText);\n    },\n    search: fn.search,\n    close: fn.close\n  }\n})()\n\nObject.freeze(SearchService);\n\nSearchService.init();\n","date":"2022-12-27T15:15:09.554Z","updated":"2022-12-27T15:15:09.554Z","path":"js/search/algolia.js","layout":"false","title":"","comments":1,"_id":"clc6k3sfg00096cu961hq59r9"},{"_content":"const ContributorsJS = {\n  requestAPI: (url, callback, timeout) => {\n    let retryTimes = 5;\n\n    function request() {\n      return new Promise((resolve, reject) => {\n        let status = 0; // 0 等待 1 完成 2 超时\n        let timer = setTimeout(() => {\n          if (status === 0) {\n            status = 2;\n            timer = null;\n            reject('请求超时');\n            if (retryTimes == 0) {\n              timeout();\n            }\n          }\n        }, 5000);\n        fetch(url).then(function (response) {\n          if (status !== 2) {\n            clearTimeout(timer);\n            resolve(response);\n            timer = null;\n            status = 1;\n          }\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error('Network response was not ok.');\n        }).then(function (data) {\n          retryTimes = 0;\n          callback(data);\n        }).catch(function (error) {\n          if (retryTimes > 0) {\n            retryTimes -= 1;\n            setTimeout(() => {\n              request();\n            }, 5000);\n          } else {\n            timeout();\n          }\n        });\n      });\n    }\n    request();\n  },\n  layout: (cfg) => {\n    const el = cfg.el;\n    ContributorsJS.requestAPI(cfg.api, function (data) {\n      el.querySelector('.loading-wrap').remove();\n      var cellALL = \"\";\n      (data || []).forEach((item, i) => {\n        var user = '<div class=\"user-card\">';\n        user += '<a class=\"card-link\" target=\"_blank\" rel=\"external noopener noreferrer\"';\n        user += ' href=\"' + item.html_url + '\">';\n        user += '<img alt=\"' + item.login + '\" src=\"' + (item.avatar_url || cfg.avatar) + '\" onerror=\"errorImgAvatar(this)\">';\n        user += '<div class=\"name\"><span>' + item.login + '</span></div>';\n        user += '</a>';\n        user += '</div>';\n        cellALL += user;\n      });\n      el.querySelector('.group-body').innerHTML = cellALL;\n    }, function () {\n      try {\n        el.querySelector('.loading-wrap svg').remove();\n        el.querySelector('.loading-wrap p').innerText('加载失败，请稍后重试。');\n      } catch (e) { }\n    });\n  },\n  start: () => {\n    const els = document.getElementsByClassName('contributorsjs-wrap');\n    for (var i = 0; i < els.length; i++) {\n      const el = els[i];\n      const api = el.getAttribute('api');\n      if (api == null) {\n        continue;\n      }\n      var cfg = new Object();\n      cfg.el = el;\n      cfg.api = api;\n      cfg.class = el.getAttribute('class');\n      cfg.avatar = volantis.GLOBAL_CONFIG.default.avatar;\n      ContributorsJS.layout(cfg);\n    }\n  }\n}\n\n\n\nContributorsJS.start();","source":"js/plugins/tags/contributors.js","raw":"const ContributorsJS = {\n  requestAPI: (url, callback, timeout) => {\n    let retryTimes = 5;\n\n    function request() {\n      return new Promise((resolve, reject) => {\n        let status = 0; // 0 等待 1 完成 2 超时\n        let timer = setTimeout(() => {\n          if (status === 0) {\n            status = 2;\n            timer = null;\n            reject('请求超时');\n            if (retryTimes == 0) {\n              timeout();\n            }\n          }\n        }, 5000);\n        fetch(url).then(function (response) {\n          if (status !== 2) {\n            clearTimeout(timer);\n            resolve(response);\n            timer = null;\n            status = 1;\n          }\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error('Network response was not ok.');\n        }).then(function (data) {\n          retryTimes = 0;\n          callback(data);\n        }).catch(function (error) {\n          if (retryTimes > 0) {\n            retryTimes -= 1;\n            setTimeout(() => {\n              request();\n            }, 5000);\n          } else {\n            timeout();\n          }\n        });\n      });\n    }\n    request();\n  },\n  layout: (cfg) => {\n    const el = cfg.el;\n    ContributorsJS.requestAPI(cfg.api, function (data) {\n      el.querySelector('.loading-wrap').remove();\n      var cellALL = \"\";\n      (data || []).forEach((item, i) => {\n        var user = '<div class=\"user-card\">';\n        user += '<a class=\"card-link\" target=\"_blank\" rel=\"external noopener noreferrer\"';\n        user += ' href=\"' + item.html_url + '\">';\n        user += '<img alt=\"' + item.login + '\" src=\"' + (item.avatar_url || cfg.avatar) + '\" onerror=\"errorImgAvatar(this)\">';\n        user += '<div class=\"name\"><span>' + item.login + '</span></div>';\n        user += '</a>';\n        user += '</div>';\n        cellALL += user;\n      });\n      el.querySelector('.group-body').innerHTML = cellALL;\n    }, function () {\n      try {\n        el.querySelector('.loading-wrap svg').remove();\n        el.querySelector('.loading-wrap p').innerText('加载失败，请稍后重试。');\n      } catch (e) { }\n    });\n  },\n  start: () => {\n    const els = document.getElementsByClassName('contributorsjs-wrap');\n    for (var i = 0; i < els.length; i++) {\n      const el = els[i];\n      const api = el.getAttribute('api');\n      if (api == null) {\n        continue;\n      }\n      var cfg = new Object();\n      cfg.el = el;\n      cfg.api = api;\n      cfg.class = el.getAttribute('class');\n      cfg.avatar = volantis.GLOBAL_CONFIG.default.avatar;\n      ContributorsJS.layout(cfg);\n    }\n  }\n}\n\n\n\nContributorsJS.start();","date":"2022-12-27T15:15:09.552Z","updated":"2022-12-27T15:15:09.552Z","path":"js/plugins/tags/contributors.js","layout":"false","title":"","comments":1,"_id":"clc6k3sfh000b6cu9do3z4nff"},{"_content":"const FriendsJS = {\n  requestAPI: (url, callback, timeout) => {\n    let retryTimes = 5;\n\n    function request() {\n      return new Promise((resolve, reject) => {\n        let status = 0; // 0 等待 1 完成 2 超时\n        let timer = setTimeout(() => {\n          if (status === 0) {\n            status = 2;\n            timer = null;\n            reject('请求超时');\n            if (retryTimes == 0) {\n              timeout();\n            }\n          }\n        }, 5000);\n        fetch(url).then(function (response) {\n          if (status !== 2) {\n            clearTimeout(timer);\n            resolve(response);\n            timer = null;\n            status = 1;\n          }\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error('Network response was not ok.');\n        }).then(function (data) {\n          retryTimes = 0;\n          callback(data);\n        }).catch(function (error) {\n          if (retryTimes > 0) {\n            retryTimes -= 1;\n            setTimeout(() => {\n              request();\n            }, 5000);\n          } else {\n            timeout();\n          }\n        });\n      });\n    }\n    request();\n  },\n  layout: (cfg) => {\n    const el = cfg.el;\n    FriendsJS.requestAPI(cfg.api, function (data) {\n      el.querySelector('.loading-wrap').remove();\n      const arr = data.content;\n      var cellALL = \"\";\n      arr.forEach((item, i) => {\n        var user = '<div class=\"user-card\">';\n        user += '<a class=\"card-link\" target=\"_blank\" rel=\"external noopener noreferrer\"';\n        user += ' href=\"' + item.url + '\">';\n        user += '<img alt=\"' + item.title + '\" src=\"' + (item.avatar || cfg.avatar) + '\" onerror=\"errorImgAvatar(this)\">';\n        user += '<div class=\"name\"><span>' + item.title + '</span></div>';\n        user += '</a>';\n        user += '</div>';\n        cellALL += user;\n      });\n      el.querySelector('.group-body').innerHTML = cellALL;\n    }, function () {\n      try {\n        el.querySelector('.loading-wrap svg').remove();\n        el.querySelector('.loading-wrap p').innerText('加载失败，请稍后重试。');\n      } catch (e) { }\n    });\n  },\n  start: () => {\n    const els = document.getElementsByClassName('friendsjs-wrap');\n    for (var i = 0; i < els.length; i++) {\n      const el = els[i];\n      const api = el.getAttribute('api');\n      if (api == null) {\n        continue;\n      }\n      var cfg = new Object();\n      cfg.el = el;\n      cfg.api = api;\n      cfg.class = el.getAttribute('class');\n      cfg.avatar = volantis.GLOBAL_CONFIG.default.avatar;\n      FriendsJS.layout(cfg);\n    }\n  }\n}\n\n\n\nFriendsJS.start();","source":"js/plugins/tags/friends.js","raw":"const FriendsJS = {\n  requestAPI: (url, callback, timeout) => {\n    let retryTimes = 5;\n\n    function request() {\n      return new Promise((resolve, reject) => {\n        let status = 0; // 0 等待 1 完成 2 超时\n        let timer = setTimeout(() => {\n          if (status === 0) {\n            status = 2;\n            timer = null;\n            reject('请求超时');\n            if (retryTimes == 0) {\n              timeout();\n            }\n          }\n        }, 5000);\n        fetch(url).then(function (response) {\n          if (status !== 2) {\n            clearTimeout(timer);\n            resolve(response);\n            timer = null;\n            status = 1;\n          }\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error('Network response was not ok.');\n        }).then(function (data) {\n          retryTimes = 0;\n          callback(data);\n        }).catch(function (error) {\n          if (retryTimes > 0) {\n            retryTimes -= 1;\n            setTimeout(() => {\n              request();\n            }, 5000);\n          } else {\n            timeout();\n          }\n        });\n      });\n    }\n    request();\n  },\n  layout: (cfg) => {\n    const el = cfg.el;\n    FriendsJS.requestAPI(cfg.api, function (data) {\n      el.querySelector('.loading-wrap').remove();\n      const arr = data.content;\n      var cellALL = \"\";\n      arr.forEach((item, i) => {\n        var user = '<div class=\"user-card\">';\n        user += '<a class=\"card-link\" target=\"_blank\" rel=\"external noopener noreferrer\"';\n        user += ' href=\"' + item.url + '\">';\n        user += '<img alt=\"' + item.title + '\" src=\"' + (item.avatar || cfg.avatar) + '\" onerror=\"errorImgAvatar(this)\">';\n        user += '<div class=\"name\"><span>' + item.title + '</span></div>';\n        user += '</a>';\n        user += '</div>';\n        cellALL += user;\n      });\n      el.querySelector('.group-body').innerHTML = cellALL;\n    }, function () {\n      try {\n        el.querySelector('.loading-wrap svg').remove();\n        el.querySelector('.loading-wrap p').innerText('加载失败，请稍后重试。');\n      } catch (e) { }\n    });\n  },\n  start: () => {\n    const els = document.getElementsByClassName('friendsjs-wrap');\n    for (var i = 0; i < els.length; i++) {\n      const el = els[i];\n      const api = el.getAttribute('api');\n      if (api == null) {\n        continue;\n      }\n      var cfg = new Object();\n      cfg.el = el;\n      cfg.api = api;\n      cfg.class = el.getAttribute('class');\n      cfg.avatar = volantis.GLOBAL_CONFIG.default.avatar;\n      FriendsJS.layout(cfg);\n    }\n  }\n}\n\n\n\nFriendsJS.start();","date":"2022-12-27T15:15:09.553Z","updated":"2022-12-27T15:15:09.553Z","path":"js/plugins/tags/friends.js","layout":"false","title":"","comments":1,"_id":"clc6k3sfh000c6cu9ehfhemo1"},{"_content":"const SitesJS = {\n  requestAPI: (url, callback, timeout) => {\n    let retryTimes = 5;\n\n    function request() {\n      return new Promise((resolve, reject) => {\n        let status = 0; // 0 等待 1 完成 2 超时\n        let timer = setTimeout(() => {\n          if (status === 0) {\n            status = 2;\n            timer = null;\n            reject('请求超时');\n            if (retryTimes == 0) {\n              timeout();\n            }\n          }\n        }, 5000);\n        fetch(url).then(function (response) {\n          if (status !== 2) {\n            clearTimeout(timer);\n            resolve(response);\n            timer = null;\n            status = 1;\n          }\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error('Network response was not ok.');\n        }).then(function (data) {\n          retryTimes = 0;\n          callback(data);\n        }).catch(function (error) {\n          if (retryTimes > 0) {\n            retryTimes -= 1;\n            setTimeout(() => {\n              request();\n            }, 5000);\n          } else {\n            timeout();\n          }\n        });\n      });\n    }\n    request();\n  },\n  layout: (cfg) => {\n    const el = cfg.el;\n    SitesJS.requestAPI(cfg.api, function (data) {\n      el.querySelector('.loading-wrap').remove();\n      const arr = data.content;\n      var cellALL = \"\";\n      arr.forEach((item, i) => {\n        var cell = '<div class=\"site-card\">';\n        cell += '<a class=\"card-link\" target=\"_blank\" rel=\"external noopener noreferrer\" href=\"' + item.url + '\">';\n        cell += '<img alt=\"' + item.title + '\" src=\"' + (item.screenshot || ('https://image.thum.io/get/width/1024/crop/768/' + item.url)) + '\" onerror=\"errorImgCover(this)\"/>';\n        cell += '<div class=\"info\">';\n        cell += '<img alt=\"' + item.title + '\" src=\"' + (item.avatar || cfg.avatar) + '\" onerror=\"errorImgAvatar(this)\"/>';\n        cell += '<span class=\"title\">' + item.title + '</span>';\n        cell += '<span class=\"desc\">' + (item.description || item.url) + '</span>';\n        cell += '</div>';\n        cell += '</a>';\n        cell += '</div>';\n        cellALL += cell;\n      });\n      el.querySelector('.group-body').innerHTML = cellALL;\n    }, function () {\n      try {\n        el.querySelector('.loading-wrap svg').remove();\n        el.querySelector('.loading-wrap p').innerText('加载失败，请稍后重试。');\n      } catch (e) { }\n    });\n  },\n  start: (cfg) => {\n    const els = document.getElementsByClassName('sitesjs-wrap');\n    for (var i = 0; i < els.length; i++) {\n      const el = els[i];\n      const api = el.getAttribute('api');\n      if (api == null) {\n        continue;\n      }\n      var cfg = new Object();\n      cfg.class = el.getAttribute('class');\n      cfg.el = el;\n      cfg.api = api;\n      cfg.avatar = volantis.GLOBAL_CONFIG.default.link;\n      cfg.screenshot = volantis.GLOBAL_CONFIG.default.cover;\n      SitesJS.layout(cfg);\n    }\n  }\n}\n\n\nSitesJS.start();","source":"js/plugins/tags/sites.js","raw":"const SitesJS = {\n  requestAPI: (url, callback, timeout) => {\n    let retryTimes = 5;\n\n    function request() {\n      return new Promise((resolve, reject) => {\n        let status = 0; // 0 等待 1 完成 2 超时\n        let timer = setTimeout(() => {\n          if (status === 0) {\n            status = 2;\n            timer = null;\n            reject('请求超时');\n            if (retryTimes == 0) {\n              timeout();\n            }\n          }\n        }, 5000);\n        fetch(url).then(function (response) {\n          if (status !== 2) {\n            clearTimeout(timer);\n            resolve(response);\n            timer = null;\n            status = 1;\n          }\n          if (response.ok) {\n            return response.json();\n          }\n          throw new Error('Network response was not ok.');\n        }).then(function (data) {\n          retryTimes = 0;\n          callback(data);\n        }).catch(function (error) {\n          if (retryTimes > 0) {\n            retryTimes -= 1;\n            setTimeout(() => {\n              request();\n            }, 5000);\n          } else {\n            timeout();\n          }\n        });\n      });\n    }\n    request();\n  },\n  layout: (cfg) => {\n    const el = cfg.el;\n    SitesJS.requestAPI(cfg.api, function (data) {\n      el.querySelector('.loading-wrap').remove();\n      const arr = data.content;\n      var cellALL = \"\";\n      arr.forEach((item, i) => {\n        var cell = '<div class=\"site-card\">';\n        cell += '<a class=\"card-link\" target=\"_blank\" rel=\"external noopener noreferrer\" href=\"' + item.url + '\">';\n        cell += '<img alt=\"' + item.title + '\" src=\"' + (item.screenshot || ('https://image.thum.io/get/width/1024/crop/768/' + item.url)) + '\" onerror=\"errorImgCover(this)\"/>';\n        cell += '<div class=\"info\">';\n        cell += '<img alt=\"' + item.title + '\" src=\"' + (item.avatar || cfg.avatar) + '\" onerror=\"errorImgAvatar(this)\"/>';\n        cell += '<span class=\"title\">' + item.title + '</span>';\n        cell += '<span class=\"desc\">' + (item.description || item.url) + '</span>';\n        cell += '</div>';\n        cell += '</a>';\n        cell += '</div>';\n        cellALL += cell;\n      });\n      el.querySelector('.group-body').innerHTML = cellALL;\n    }, function () {\n      try {\n        el.querySelector('.loading-wrap svg').remove();\n        el.querySelector('.loading-wrap p').innerText('加载失败，请稍后重试。');\n      } catch (e) { }\n    });\n  },\n  start: (cfg) => {\n    const els = document.getElementsByClassName('sitesjs-wrap');\n    for (var i = 0; i < els.length; i++) {\n      const el = els[i];\n      const api = el.getAttribute('api');\n      if (api == null) {\n        continue;\n      }\n      var cfg = new Object();\n      cfg.class = el.getAttribute('class');\n      cfg.el = el;\n      cfg.api = api;\n      cfg.avatar = volantis.GLOBAL_CONFIG.default.link;\n      cfg.screenshot = volantis.GLOBAL_CONFIG.default.cover;\n      SitesJS.layout(cfg);\n    }\n  }\n}\n\n\nSitesJS.start();","date":"2022-12-27T15:15:09.553Z","updated":"2022-12-27T15:15:09.553Z","path":"js/plugins/tags/sites.js","layout":"false","title":"","comments":1,"_id":"clc6k3sfh000d6cu95bapcf7q"}],"Post":[{"title":"Hello World","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"date":"2022-12-27T09:35:38.548Z","updated":"2022-12-27T15:00:25.439Z","_id":"clc61des70000xcu9gm41bogj","comments":1,"layout":"post","photos":[],"link":""},{"title":"小温同学","date":"2022-12-27T09:38:40.000Z","_content":"\n\n\n加油鸭  快康康 有点小变化\n\n\n\n-\n\n+\n\n_\n\n-\n\n- \n\n+ \n\n\n\n- \n\n... \n\n","source":"_posts/test.md","raw":"---\ntitle: 小温同学\ndate: 2022-12-27 17:38:40\ntags:\n---\n\n\n\n加油鸭  快康康 有点小变化\n\n\n\n-\n\n+\n\n_\n\n-\n\n- \n\n+ \n\n\n\n- \n\n... \n\n","slug":"test","published":1,"updated":"2022-12-27T17:24:37.195Z","_id":"clc61desh0001xcu9aivw1cc3","comments":1,"layout":"post","photos":[],"link":""},{"title":"new","date":"2022-12-27T18:23:10.000Z","_content":"","source":"_posts/new.md","raw":"---\ntitle: new\ndate: 2022-12-28 02:23:10\ntags:\n---\n","slug":"new","published":1,"updated":"2022-12-27T18:23:10.584Z","comments":1,"layout":"post","photos":[],"link":"","_id":"clc6k3sfg000a6cu9er9j1zx4"}],"PostAsset":[],"PostCategory":[],"PostTag":[],"Tag":[]}}